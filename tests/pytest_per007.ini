[pytest]
# PER-007 Test Configuration
# Run with: pytest -c tests/pytest_per007.ini

testpaths = tests
python_files = test_per007_*.py
python_classes = Test*
python_functions = test_*

# Custom markers for PER-007 test phases
markers =
    red_phase: Tests that MUST fail initially (RED phase of TDD)
    green_phase: Tests that should pass after implementation
    refactor_phase: Tests run during refactoring
    performance: Performance benchmark tests
    benchmark: Performance benchmark tests
    antipattern: Tests that ensure bad patterns are blocked
    acceptance: End-to-end acceptance tests

# Test output configuration
addopts =
    -v
    --tb=short
    --strict-markers
    -m "red_phase or antipattern or acceptance"
    --color=yes

# Coverage configuration for PER-007
# Run with: pytest -c tests/pytest_per007.ini --cov=src --cov-report=html
coverage:
    source = src
    omit =
        */tests/*
        */test_*.py

# Performance benchmark configuration
benchmark_only = false
benchmark_verbose = true
benchmark_autosave = true
benchmark_save_data = true
benchmark_max_time = 1.0
benchmark_min_rounds = 5
benchmark_calibration_precision = 10

# Logging configuration for test runs
log_cli = true
log_cli_level = WARNING
log_cli_format = %(asctime)s [%(levelname)s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Fail fast on first failure (useful for RED phase)
maxfail = 1

# Show slowest tests
durations = 10

# Parallel execution (if pytest-xdist installed)
# Uncomment to run tests in parallel
# addopts = -n auto

# Custom test groups for PER-007 phases
[pytest:red_phase]
# Run RED phase tests only
# pytest -c tests/pytest_per007.ini -m red_phase
python_files = test_per007_*_red.py

[pytest:green_phase]
# Run after implementation to verify fixes
# pytest -c tests/pytest_per007.ini -m "not red_phase"
python_files = test_per007_*.py

[pytest:performance]
# Run performance tests only
# pytest -c tests/pytest_per007.ini -m "performance or benchmark"
python_files = test_per007_performance.py

[pytest:antipatterns]
# Run anti-pattern tests only
# pytest -c tests/pytest_per007.ini -m antipattern
python_files = test_per007_antipatterns.py
