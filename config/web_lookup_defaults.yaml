web_lookup:
  enabled: true

  # Juridische synoniemen voor verbeterde recall (NIEUW - Oct 2025)
  synonyms:
    enabled: true
    config_path: "config/juridische_synoniemen.yaml"
    max_synonyms_per_query: 3  # Limiteer aantal synoniemen per query

  # Juridische keywords database (NIEUW - Oct 2025)
  keywords:
    enabled: true
    config_path: "config/juridische_keywords.yaml"

  # Juridische ranking boost factoren
  juridical_boost:
    # Quality gate settings (FASE 3 FIX - Oct 2025)
    # Prevents low-quality juridical sources from outranking high-quality relevant sources
    # Rationale: "Autoriteit moet verdient worden met kwaliteit"
    quality_gate:
      enabled: true
      min_base_score: 0.65          # Only boost sources with score >= 0.65
      reduced_boost_factor: 0.5     # Apply 50% boost if below threshold
      # Example: BES wetgeving (0.6) should not beat relevant Wikipedia (0.8)

    # Source-based boosts (applied after quality gate)
    juridische_bron: 1.2       # Boost voor rechtspraak.nl, overheid.nl (GATED)
    juridical_flag: 1.15       # Boost voor is_juridical flag (GATED)

    # Content-based boosts (NOT gated - measure intrinsic relevance)
    keyword_per_match: 1.1     # Boost per juridisch keyword (max 1.3x)
    keyword_max_boost: 1.3     # Maximum keyword boost cap
    artikel_referentie: 1.15   # Boost voor artikel-referenties
    lid_referentie: 1.05       # Boost voor lid-referenties
    context_match: 1.1         # Boost voor context token matches
    context_max_boost: 1.3     # Maximum context boost cap

  cache:
    strategy: "stale-while-revalidate"
    grace_period: 300
    default_ttl: 3600
    max_entries: 1000

  sanitization:
    strip_tags: [script, style, iframe, object, embed, form]
    block_protocols: [javascript, data, vbscript]
    max_snippet_length: 500

  providers:
    # === TIER 1: HIGH QUALITY (Primary Sources) ===
    # Gebaseerd op observed performance Oct 2025

    wikipedia:
      enabled: true
      weight: 0.85  # BOOST (was 0.7): synoniemen bewezen effectief ("onherroepelijk" → "kracht van gewijsde")
      timeout: 5
      cache_ttl: 7200
      min_score: 0.3
      # Rationale: juridische synoniemen database (476 lines) zorgt voor betere recall dan verwacht

    sru_overheid:
      enabled: true
      weight: 1.0  # KEEP: hoogste autoriteit, 100% hit rate observed
      timeout: 5
      cache_ttl: 3600
      min_score: 0.4
      # Rationale: Officiële overheidsbron, bewezen betrouwbaar in alle tests

    rechtspraak_ecli:
      enabled: true
      weight: 0.95  # BOOST (was 0.9): text search + ECLI beide 100% hit rate
      timeout: 5
      cache_ttl: 3600
      min_score: 0.4
      # Rationale: Primaire bron voor jurisprudentie, REST implementatie succesvol

    # === TIER 2: PROBLEMATIC (Lower Priority / Disabled) ===

    brave_search:
      enabled: false  # DISABLED (2025-10-09): MCP tool niet werkend, geen observed resultaten
      weight: 0.70  # LOWER (was 0.85): fallback priority wanneer MCP fixed
      timeout: 10
      cache_ttl: 3600
      min_score: 0.3
      max_results: 5
      # Rationale: MCP dependency blocker, re-enable als MCP fixed OF implement direct API call

    wiktionary:
      enabled: true  # MONITOR: track hit rate gedurende 1 week
      weight: 0.65  # LOWER (was 0.9): lage visibility in logs, mogelijk lage hit rate
      timeout: 5
      cache_ttl: 3600
      min_score: 0.3
      # Rationale: Geen observed hits in recent testing, weight moet reflecteren performance
      # Action: Disable als < 5% hit rate na 1 week monitoring

    wetgeving_nl:
      enabled: false  # DISABLED (2025-10-08): 0% hit rate, 76% snelheidswinst bij disablen
      weight: 0.0  # ZERO (was 0.9): niet bruikbaar in huidige configuratie
      timeout: 5
      cache_ttl: 3600
      min_score: 0.4
      # NOTE: Schema fix (oai_dc → gzd) heeft niet geholpen
      # BWB indexeert per artikel, niet per juridisch concept
      # Overheid.nl + Rechtspraak.nl leveren voldoende juridische content

    eur_lex:
      enabled: true
      weight: 0.6
      timeout: 5
      cache_ttl: 3600
      min_score: 0.3

    wikidata:
      enabled: true
      weight: 0.3   # low priority enrichment
      timeout: 5
      cache_ttl: 3600
      min_score: 0.2

    dbpedia:
      enabled: true
      weight: 0.2   # low priority enrichment
      timeout: 5
      cache_ttl: 3600
      min_score: 0.2

  context_mappings:
    DJI: ["Pbw", "WvSr"]
    OM: ["WvSv"]
    Rechtspraak: ["Rv"]

  prompt_augmentation:
    enabled: true
    # Include all hits in the prompt initially (overridden by token budget safeguards in code)
    include_all_hits: true
    max_snippets: 3
    max_tokens_per_snippet: 100
    total_token_budget: 400
    prioritize_juridical: true
    section_header: "### Contextinformatie uit bronnen:"
    snippet_separator: "\n- "
    position: "after_context"  # one of: prepend, after_context, before_examples

  sru:
    circuit_breaker:
      enabled: true
      consecutive_empty_threshold: 4  # Stop after 4 consecutive empty results (was 2)
      # Provider-specific overrides (optional)
      providers:
        overheid: 4
        rechtspraak: 3  # Legal docs might need more attempts
        wetgeving_nl: 4
        overheid_zoek: 4
