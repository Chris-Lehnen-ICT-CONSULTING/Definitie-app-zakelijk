---
id: US-112
epic: EPIC-014
titel: Implementeer Voorbeelden Caching Strategy
status: open
prioriteit: P2
story_points: 5
aangemaakt: 2025-09-30
bijgewerkt: 2025-09-30
owner: tbd
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-30
---

# US-112: Implementeer Voorbeelden Caching Strategy

## User Story
**Als** performance optimizer  
**Wil ik** voorbeelden cachen tussen iteraties  
**Zodat** we 2-3 seconden per iteratie besparen  

## Status
**Status**: TODO  
**Priority**: MEDIUM  
**Story Points**: 3  
**Epic**: [EPIC-014: Business Logic Refactoring](../EPIC-014.md)  

## Business Context
Voorbeelden generatie kost ~2-3 seconden. Door deze alleen in iteratie 1 te genereren en te hergebruiken, besparen we significant op totale processing tijd.

## Acceptance Criteria
- [ ] Genereer voorbeelden alleen in eerste iteratie
- [ ] Store voorbeelden in `_first_iteration_voorbeelden`
- [ ] Hergebruik voorbeelden in iteraties 2 en 3
- [ ] Voorbeelden blijven consistent over alle iteraties
- [ ] Performance verbetering meetbaar (2-3 sec/iteratie)

## Technical Implementation
```python
class VoorbeeldenCache:
    def __init__(self):
        self._cache = {}
    
    def get_or_generate(self, begrip, definitie, iteration):
        cache_key = f"{begrip}_{hash(definitie[:50])}"
        
        if iteration == 1 or cache_key not in self._cache:
            # Generate and cache
            voorbeelden = self._generate_voorbeelden(begrip, definitie)
            self._cache[cache_key] = voorbeelden
            return voorbeelden
        
        # Return cached
        return self._cache[cache_key]
```

## Performance Impact
- Iteratie 1: ~5 seconden (met voorbeelden)
- Iteratie 2-3: ~2 seconden (zonder, gebruik cache)
- Totale besparing: 4-6 seconden per volledige run

## Dependencies
- Voorbeelden generator service
- Iteration controller

## Notes
- Cache key moet stabiel zijn maar definitie-specifiek
- Memory footprint minimal (max 3 definities in cache)