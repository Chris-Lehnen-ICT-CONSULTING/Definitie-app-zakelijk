---
id: US-138
epic: EPIC-005
titel: Import validatie
type: feature
status: active
prioriteit: HOOG
story_points: 5
sprint: backlog
aangemaakt: 05-09-2025
bijgewerkt: 05-09-2025
owner: developer-implementer
applies_to: definitie-app@current
canonical: false
last_verified: 06-10-2025
Afhankelijkheden:
  - US-021
toegewezen_aan: unassigned
---



# US-138: Import validatie

## Gebruikersverhaal

**As a** legal analyst
**wil ik to** import previously exported definitions with full validatie
**zodat** I can reuse definitions across cases en ensure imported content meets quality stEnards

## Acceptatiecriteria


### SMART Acceptatiecriteria

- **Specifiek:** [Exact gedrag dat moet worden gerealiseerd]
- **Meetbaar:**
  - Response tijd: < 200ms voor UI acties
  - Processing tijd: < 5 seconden voor generatie
  - Success rate: > 95% voor validaties
- **Acceptabel:** Haalbaar binnen huidige architectuur
- **Relevant:** Direct gerelateerd aan gebruikersbehoefte
- **Tijdgebonden:** Gerealiseerd binnen huidige sprint


### AC1: File Format Detection
**gegeven** a file is selected for import
**wanneer** the import process begins
**dan** the system automatically detects the format (JSON/DOCX) En applies appropriate parser

### AC2: Schema validatie
**gegeven** a JSON file is imported
**wanneer** the file is parsed
**dan** the system validaties:
- Required fields presence
- Data type correctness
- Versie compatibility
- Checksum verification if present

### AC3: Content validatie
**gegeven** definition content is extracted from import
**wanneer** validatie is triggered
**dan** the system:
- Runs all 45 validatieregels
- Compares with original validatie scores if available
- Flags any degradation in quality
- Provides detailed validatie report

### AC4: Duplicate Detection
**gegeven** an imported definition
**wanneer** checking against existing definitions
**dan** the system:
- Detects exact duplicates
- Identifies similar definitions (>80% similarity)
- Offers merge/replace/skip options
- Maintains Versie history

### AC5: Error Handling
**gegeven** an import fails validatie
**wanneer** errors are detected
**dan** the system:
- Provides clear error messages
- HOOGlights specific issues in content
- Offers correction suggestions
- AlLAAGs partial import where possible

## Statusupdate 2025-10-06
- `DefinitionImportService.validate_single` (`src/services/definition_import_service.py`) levert validatie en duplicaatdetectie voor de legacy “Enkelvoudige import (MVP)” flow; de UI-sectie is verwijderd ten gunste van de CSV-bulkimport.
- Advies: gebruik de CSV-bulkimport (≤100) voor nieuwe scenario's; de enkelvoudige import blijft alleen voor compatibiliteit.
- Formaatdetectie, volledige schema validatie, 45-regel businessvalidatie en similarity-gebaseerde duplicate workflows ontbreken nog; deze story blijft open voor uitbreidingen richting batch-import (`US-062`) en admin duplicate scans.

## Domain vereisten

### ASTRA compliance
- ValiDatum against ASTRA definition stEnards
- Check mEnatory metadata fields
- Ensure justice domain terminology compliance
- Verify context classification

### Data Integrity
- Maintain auditspoor for imported definitions
- Preserve original authorship information
- Track import source en timestamp
- Enable rollback capability

### Chain Integration
- ValiDatum Justid identifiers if present
- Check cross-references to other systems
- Maintain relationship mappings
- Preserve chain-specific metadata

## Technische Notities

### Implementatie Components
- `ImportValidationService` in `src/services/import/`
- Format-specific parsers (JSON, DOCX)
- Schema validators using `jsonschema`
- Duplicate detection using similarity algorithms

### Referenties
- [REQ-073](../../requirements/REQ-073.md)
- [REQ-074](../../requirements/REQ-074.md)

### validatie Pipeline
1. File format detection en parsing
2. Structural validatie (schema)
3. Content extraction
4. Business rule validatie (45 rules)
5. Duplicate/similarity checking
6. Import decision en execution

### Error Recovery
- Implement transactional imports
- Support partial imports with warnings
- Provide detailed error logs
- Enable retry with corrections



## Afhankelijkheden

- EPIC-005
## Test vereisten

### Unit Tests
- Parser functionality for each format
- Schema validatieregels
- Duplicate detection algorithms
- Error hEnling paths

### Integration Tests
- Import-validatie-storage pipeline
- Cross-format import scenarios
- Large file hEnling
- Concurrent import operations

### Edge Cases
- Corrupted files
- Incomplete exports
- Versie mismatches
- Encoding issues
- Circular references

## Definitie van Gereed

- [ ] Import validatie service geïmplementeerd
- [ ] Format parsers for JSON en DOCX complete
- [ ] All validatieregels applied to imports
- [ ] Duplicate detection operational
- [ ] Error hEnling comprehensive
- [ ] Unit tests >85% coverage
- [ ] Integration tests passing
- [ ] Prestaties targets met (< 5s for validatie)
- [ ] beveiliging review Voltooid
- [ ] User documentation bijgewerkt
- [ ] ASTRA compliance verified

## Links

- Related vereisten: [REQ-073](../../requirements/REQ-073.md), [REQ-074](../../requirements/REQ-074.md)
- Episch Verhaal: EPIC-005-export-import
- Depends on: US-021
- Technical Spec: `docs/technisch/import-validatie-spec.md`
