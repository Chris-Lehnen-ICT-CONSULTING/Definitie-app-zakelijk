---
id: US-448
epic: EPIC-026
titel: Document Snippet Configuratie Externaliseren
type: refactor
status: Nog te bepalen
prioriteit: HOOG
story_points: 3
sprint: backlog
owner: code-architect
applies_to: definitie-app@current
canonical: false
last_verified: 2025-10-03
vereisten:
  - REQ-091
---

# US-448: Document Snippet Configuratie Externaliseren

## Gebruikersverhaal
**Als** performance-engineer  
**wil ik** de huidige hardcoded snippetlimieten voor documentcontext naar configuratie verplaatsen  
**zodat** we de rebuild kunnen tunen voor snelheid, tokenkosten en UX.

## Acceptatiecriteria
- [ ] Config of environment-variabelen bepalen `DOCUMENT_SNIPPETS_PER_DOC`, `SNIPPET_WINDOW_CHARS` en totale snippetlimiet.  
- [ ] UI leest configuratie via service/helper en bevat geen hardcoded defaults meer.  
- [ ] Tests bewijzen dat overrides werken en defaultgedrag gelijk blijft.  
- [ ] Documentatie bevat aanbevolen waardes en impact op performance/tokengebruik.

## Technische Context
- Bron: `src/ui/tabbed_interface.py:974-990`.  
- Huidige defaults: 4 snippets per document, 280 tekens window.  
- Config moet aansluiten bij caching/tokenoptimalisatie plannen.

## Implementatiestappen
- Introduceer configuratiebestand of env loader.  
- Injecteer configuratie in document-context service (zie US-441).  
- Verwijder hardcoded waarden uit UI en voeg logging voor overrides toe.  
- Actualiseer architectuurdocument.

## Teststrategie
- Unit-test voor configuratiehelper (default/override).  
- Integratietest die snippetconstructie vergelijkt met baseline.  
- Performancetest (optioneel) om impact te meten.

## Risico's en Mitigatie
- **Risico:** verkeerde waardes → **Mitigatie:** valideren op range en fallback naar defaults.  
- **Risico:** regressies in documentcontext → **Mitigatie:** baseline testcases hergebruiken.  
- **Risico:** configuratie ontbreekt → **Mitigatie:** duidelijke foutmelding en fallback.

## Definition of Done
- [ ] Config in gebruik, UI vrij van hardcoded waarden.  
- [ ] Tests groen.  
- [ ] Documentatie geüpdatet met tuning-instructies.  
- [ ] QA bevestigt dat snippetgedrag ongewijzigd is.
