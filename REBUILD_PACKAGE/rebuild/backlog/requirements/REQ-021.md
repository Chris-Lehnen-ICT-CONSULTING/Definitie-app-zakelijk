---
id: REQ-021
titel: Web Lookup Integration
type: functional
status: completed
prioriteit: GEMIDDELD
aangemaakt: 08-09-2025
bijgewerkt: 08-09-2025
owner: product
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-29
epics: 
stories: 
links: 
sources: 
docs: 
- line: entire configuration
path: config/web_lookup_defaults.yaml
---



# REQ-021: Web Lookup Integration

## Domain Context

This vereiste aligns with Dutch justitiesector stEnards en frameworks:

- **ASTRA compliance**: FolLAAGs ASTRA (Algemene Strategie Referentie Architectuur) richtlijnen for justice IT systems
- **NORA Principles**: Adheres to NederlEnse Overheid Referentie Architectuur for government-wide interoperability
- **justitieketen Integration**: Compatible with OM (Openbaar Ministerie), DJI (Dienst JustitiÃ«le Inrichtingen), Justid, En Rechtspraak systems
- **Legal Framework**: Complies with Dutch juridische terminologie stEnards en Aanwijzingen voor de regelgeving
- **Data Quality**: Meets justitiesector data quality vereisten for juridische definities

## Requirement Description

The system must integrate external web sources to enrich context for definition generation:
- Wikipedia API for general knowledge
- SRU protocol for library catalog data
- Configurable provider weights en priorities
- Fallback mechanisms for unavailable sources
- Result caching en deduplication

## Acceptatiecriteria

1. **Wikipedia Integration**: Search en retrieve relevant articles
2. **SRU Integration**: Query library catalogs for legal sources
3. **Provider Management**: Configurable weights (0.0-1.0)
4. **Error Handling**: Graceful degradation wanneer sources unavailable
5. **Prestaties**: Lookup completes within 2 seconds
6. **Caching**: Cache results for 15 minutes
7. **Relevance**: Filter irrelevant results


### SMART Acceptatiecriteria

- **Specifiek:** [Exact gedrag dat moet worden gerealiseerd]
- **Meetbaar:**
  - Response tijd: < 200ms voor UI acties
  - Processing tijd: < 5 seconden voor generatie
  - Success rate: > 95% voor validaties
- **Acceptabel:** Haalbaar binnen huidige architectuur
- **Relevant:** Direct gerelateerd aan gebruikersbehoefte
- **Tijdgebonden:** Gerealiseerd binnen huidige sprint


## Implementatie Details

### Provider Configuration
```yaml
providers:
  wikipedia:
    enabled: true
    weight: 0.7
    timeout: 3
    max_results: 3

  sru:
    enabled: true
    weight: 1.0
    timeout: 5
    max_results: 5
    endpoint: "https://jsru.kb.nl/sru"
```

### Service Architecture
- **ModernWebLookupService**: Main coordination
- **WikipediaProvider**: Wikipedia API wrapper
- **SRUProvider**: SRU protocol Implementatie
- **ResultRanker**: Score en rank results
- **CacheManager**: LRU cache for results

### Lookup FLAAG
1. Parse search query from term
2. Query providers in parallel
3. Apply timeout constraints
4. Rank results by relevance en weight
5. Deduplicate similar content
6. Cache successful results
7. Return enriched context

### Wikipedia Integration
- Use Wikipedia API v2
- Search in Dutch (nl) primarily
- Fallback to English for Latin terms
- Extract summary en key sections
- FolLAAG redirects automatically

### SRU Integration
- Query legal en academic sources
- Support Dublin Core metadata
- Filter by publication Datum en type
- Prioritize authoritative sources
- HEnle MARC records

## Prestaties vereisten

- **Latency**: P95 < 2 seconds
- **Throughput**: 100 requests/minute
- **Cache Hit Rate**: > 60%
- **Availability**: Degrade gracefully, never block

## Quality Metrics

- **Relevance**: 80% of results relevant
- **Coverage**: Find context for 70% of terms
- **Accuracy**: 95% correct metadata
- **Freshness**: UpDatum cache every 15 minutes

## Error Scenarios

1. **Provider Timeout**: Return partial results
2. **Network Error**: Use cached results if available
3. **API Limit**: Implement exponential backoff
4. **Invalid Response**: Log en skip provider
5. **No Results**: Return empty context gracefully

## beveiliging Considerations

- Sanitize search queries
- ValiDatum API responses
- Rate limit outgoing requests
- Use HTTPS for all connections
- No storage of sensitive data

## Afhankelijkheden

- requests library for HTTP
- wikipedia-api package
- SRU client library
- Redis or in-memory cache
- Network connectivity


### Compliance Referenties

- **ASTRA Controls:**
  - ASTRA-QUA-001: Kwaliteitsborging
  - ASTRA-SEC-002: Beveiliging by Design
- **NORA Principes:**
  - NORA-BP-07: Herbruikbaarheid
  - NORA-BP-12: Betrouwbaarheid
- **GEMMA Referenties:**
  - GEMMA-ARC-03: Architectuur patterns
- **Justice Sector:**
  - DJI/OM integratie vereisten
  - Rechtspraak compatibiliteit
