---
id: US-029
epic: EPIC-006
titel: Security headers (CSP/HSTS/X-Frame-Options) + CSRF + UI rate limiting
status: Nog te bepalen
prioriteit: HOOG
story_points: 5
sprint: sprint-37
owner: security-engineer
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-12
vereisten:
  - REQ-006
links:
  - docs/backlog/DEEP_DIVE_IMPROVEMENT_PLAN.md#security--privacy-req006-owasp
afhankelijkheden:
  - EPIC-006/US-028
---

# US-029: Security headers (CSP/HSTS/X-Frame-Options) + CSRF + UI rate limiting

## Gebruikersverhaal
Als security officer wil ik standaard security headers, CSRF‑bescherming en UI‑rate limiting zodat de applicatie OWASP Top‑10 mitigaties toepast en risico’s op XSS/Clickjacking/CSRF minimaliseert.

## Acceptatiecriteria (SMART)
- Specifiek: Header‑set (CSP, HSTS, X‑Frame‑Options, X‑Content‑Type‑Options, X‑XSS‑Protection) actief; CSRF‑token voor state‑wijzigende acties; UI‑rate limiting op submit‑acties.
- Meetbaar:
  - SecurityHeaders scan score: A (of gelijkwaardig) zonder High findings.
  - 100% POST‑acties voorzien van CSRF‑token (mock‑API of middleware path voor Streamlit).
  - Rate limiting: dubbele klikken of bots worden geblokkeerd/loggen.
- Acceptabel: Streamlit heeft beperkte header‑controle; alternatief via reverse proxy of werkbare middleware.
- Relevant: REQ‑006.
- Tijdgebonden: sprint‑37.

## Implementatienotities
- Indien Streamlit headers niet zet: documenteer Nginx/Traefik configuratie in `docs/handleidingen/deployment/` en voeg runtime check toe die waarschuwt als headers ontbreken.
- CSRF: minimalistisch via per‑sessie nonce en hidden field in formulieren; verifieer op submit.
- UI rate limit: client‑side throttle + server‑side eenvoudige limiter (session‑scoped).

## Testplan
- Security header integration test (requests naar lokale server; validate headers).
- CSRF unit/integration tests met geldige/ongeldige tokens.
- Rate limiting test: snelle herhaalde submits → geblokkeerd met nette melding.

## Definition of Done
- Documentatie voor headers aanwezig; CI check (ZAP baseline) zonder High; tests groen.

