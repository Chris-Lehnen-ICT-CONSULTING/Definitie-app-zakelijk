<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US-300: titel: Automatische bepaling van UFO‚Äëcategorie (OntoUML/UFO)</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">‚Üê Terug naar Portal</a>
    <p>---</p>
<p>id: US-300</p>
<p>epic: EPIC-014</p>
<p>titel: "US-300: titel: Automatische bepaling van UFO‚Äëcategorie (OntoUML/UFO)"</p>
<p>status: open</p>
<p>prioriteit: HOOG</p>
<p>story_points: 5</p>
<p>owner: developer-implementer</p>
<p>applies_to: definitie-app@current</p>
<p>canonical: false</p>
<p>last_verified: 2025-09-23</p>
<p>links:</p>
<ul>
<li> - docs/guidelines/CANONICAL_LOCATIONS.md</li>
<li> - docs/guidelines/DOCUMENTATION_POLICY.md</li>
<p>---</p>
</ul>

<h1>US-300: Automatische bepaling van UFO‚Äëcategorie</h1>

<h2>Gebruikersverhaal</h2>
<p>Als expert‚Äëgebruiker wil ik dat de applicatie automatisch de juiste UFO‚Äëcategorie (OntoUML/UFO) voor een begrip voorstelt, zodat ik minder handmatig werk heb en de classificatie consistenter wordt.</p>

<h2>Context</h2>
<ul>
<li>UFO‚Äëcategorie (OntoUML/UFO metamodel) is nu handmatig selecteerbaar in Generator, Bewerk en Expert‚Äëreview tabs</li>
<li>De dataset bevat nog geen betrouwbare trainingslabels; start met heuristieken/detector + fallback naar handmatige keuze</li>
<li>16 UFO-categorie√´n gedefinieerd in database schema, vrijwel ongebruikt (0% van actieve definities heeft categorie)</li>
<li>80+ voorbeelddefinities beschikbaar voor initial testing</li>
</ul>

<h2>Acceptatiecriteria (SMART)</h2>
<ul>
<li>[ ] De app toont automatisch een voorstel voor `ufo_categorie` bij generatie of laden in edit/review, met confidence‚Äëindicatie</li>
<li>[ ] Gebruiker kan het voorstel overschrijven (manual > auto)</li>
<li>[ ] Minimaal **95% precisie** op interne validatieset voor duidelijke gevallen (‚â•0.8 confidence)</li>
<li>[ ] Fallback: bij lage confidence (<0.6) verplichte handmatige review</li>
<li>[ ] Logging: gekozen waarde (auto of handmatig) wordt opgeslagen (auditbaar) zonder PII</li>
<li>[ ] Performance: <500ms per detectie is acceptabel (focus op kwaliteit, niet snelheid)</li>
<li>[ ] Batch processing: Voor initi√´le 80+ definities (geen performance vereiste)</li>
</ul>

<h2>Technische Implementatie</h2>

<h3>Service Architectuur (Single-User Focus)</h3>
<ul>
<li>**UFOClassificationService**: Simpele service ge√Øntegreerd met ServiceContainer</li>
<li>**Rule Engine**: 100+ zorgvuldig gecureerde regels voor Nederlandse juridische context</li>
<li>**Kwaliteit over snelheid**: Grondige analyse met alle 16 UFO categorie√´n</li>
<li>**Performance**: ~100-200ms is prima (gebruiker merkt dit niet bij single-user)</li>
</ul>

<h3>Interface Design</h3>
<pre><code>class UFOClassificationService:
    def classify(self, term: str, definition: str, context: Optional[Dict] = None) -&gt; UFOClassification:
        """
        Grondige UFO classificatie met focus op correctheid.

        Returns:
        - primary_category: Een van de 16 UFO categorie√´n
        - secondary_tags: Alle relevante subcategorie√´n voor volledigheid
        - confidence: 0.0-1.0 score (hoe zeker de classificatie is)
        - detailed_explanation: Uitgebreide uitleg van ALLE overwegingen
        - matched_patterns: Alle gematchte patronen (niet alleen top-3)
        """</code></pre>

<h3>Beslislogica (Volledig & Zorgvuldig)</h3>
<p><strong>ALLE 9 stappen worden ALTIJD doorlopen voor maximale accuratesse:</strong></p>

<ol>
<li>Is het zelfstandig, substantieel "ding" (kan zonder drager bestaan)? ‚Üí **Kind**</li>
<li>Is het tijdsgebonden (gebeurtenis/proces)? ‚Üí **Event**</li>
<li>Is het een rol die een entiteit kan aannemen? ‚Üí **Role**</li>
<li>Is het een levensfase van een entiteit? ‚Üí **Phase**</li>
<li>Medieert het een relatie tussen entiteiten? ‚Üí **Relator**</li>
<li>Is het een intrinsieke eigenschap met drager? ‚Üí **Mode**</li>
<li>Is het een meetbare grootheid? ‚Üí **Quantity**</li>
<li>Is het een kwalitatieve eigenschap? ‚Üí **Quality**</li>
<li>Verfijn met subcategorie√´n: **Subkind**, **Category**, **Mixin**, **RoleMixin**, **PhaseMixin**, **Collective**, **VariableCollection**, **FixedCollection**</li>
</ol>

<p><strong>Disambiguatie voor complexe termen</strong> wordt altijd toegepast bij termen zoals "zaak", "huwelijk", "overeenkomst"</p>

<h2>Nederlandse Juridische Domeinkennis</h2>

<h3>Domeinspecifieke Woordenlijsten (500+ termen)</h3>
<ul>
<li>**Strafrecht** (150+ termen): verdachte, dader, slachtoffer, aanhouding, inverzekeringstelling, dagvaarding, proces-verbaal</li>
<li>**Bestuursrecht** (120+ termen): burger, bestuursorgaan, beschikking, vergunning, bezwaar, beroep, handhaving</li>
<li>**Civiel recht** (100+ termen): koper, verkoper, eigenaar, koopovereenkomst, huurovereenkomst, vorderingsrecht</li>
<li>**Algemeen juridisch** (130+ termen): rechtspersoon, natuurlijk persoon, rechtsverhouding, bevoegdheid</li>
</ul>

<h3>Signalen per categorie (NL‚Äëspecifiek)</h3>
<ul>
<li>**Kind**: zelfstandige naamwoorden die zelfstandig bestaan (mens, auto, zaak, organisatie); definities zonder drager/relatie</li>
<li>**Event**: werkwoorden/nominalisaties (arrestatie, zitting, beoordeling); tijd/duur indicaties (op, tijdens, van‚Äëtot)</li>
<li>**Role**: contextuele termen (als, in de rol van; verdachte, werknemer, rechter); vereist drager (mens/organisatie)</li>
<li>**Phase**: stadia (in onderzoek, gesloten, actief, voorlopig, concept, definitief); overgang binnen zelfde individu</li>
<li>**Relator**: contract/legale binding (overeenkomst, huwelijk, dagvaarding, vergunning, mandaat); ‚â•2 deelnemers</li>
<li>**Mode**: toestanden/attributen (gezondheid, locatie, kleur, gemoedstoestand, adres); vereist drager</li>
<li>**Quantity**: eenheden/meetbaarheid (‚Ç¨/%/km/kg; aantal, duur, percentage)</li>
<li>**Quality**: gradaties/schalen (betrouwbaarheid, zwaarte, kwaliteit, ernst, waarschijnlijkheid)</li>
<li>**Subkind/Category/Mixin**: groeperend/afgeleid; subkind behoudt essentie; abstracte types zonder instanties</li>
<li>**Relatie/Event Composition**: predicaten ("X arresteert Y"); samengestelde processen (strafproces = opsporing + vervolging + berechting)</li>
</ul>

<h3>Feature‚Äëextractie Pipeline (Grondig & Volledig)</h3>
<ul>
<li>**Lingu√Østisch** (alle features extraheren):</li>
<li> - POS‚Äëtags met spaCy nl_core_news_lg model (fallback: regex patterns)</li>
<li> - ALLE lemmata, niet alleen top matches</li>
<li> - ALLE patronen checken: "X als Y", "X van Y", temporele markers, etc.</li>
<li> - Volledige morfologische analyse</li>
<li>**Semantisch** (diepgaande analyse):</li>
<li> - Uitgebreide drager analyse met meerdere checks</li>
<li> - Complete deelnemers detectie (niet alleen ‚â•2)</li>
<li> - Volledige lifecycle analyse</li>
<li> - Context-aware disambiguatie voor ALLE ambigue termen</li>
<li>**Domeinwoordenlijsten** (alles in geheugen voor snelle toegang):</li>
<li> - 500+ juridische termen volledig geladen</li>
<li> - Geen lazy loading - alles direct beschikbaar</li>
<li> - Rijke metadata per term (domein, frequentie, ambigu√Øteit)</li>
<li>**Relationele hints** (uitgebreid):</li>
<li> - Volledige relationele analyse</li>
<li> - Participatie analyse voor alle aantallen</li>
<li> - Directionaliteit van relaties</li>
</ul>

<h2>UX Implementatie</h2>

<pre><code># In Generator/Edit/Expert tabs - met focus op transparantie:
with st.spinner("üîç Grondige UFO-analyse bezig (alle 16 categorie√´n)..."):
    suggestion = classifier.classify(term, definition)

st.info(f"ü§ñ Voorgestelde categorie: {suggestion.primary_category} ({suggestion.confidence:.0%})")

# Altijd uitgebreide uitleg tonen voor juridische verantwoording
with st.expander("üìã Volledige analyse", expanded=True):
    st.write("**Alle overwogen categorie√´n:**")
    for category, score in suggestion.all_scores.items():
        st.write(f"- {category}: {score:.2f}")

    st.write("\n**Gematchte patronen:**")
    for pattern in suggestion.matched_patterns:  # Alle patronen, niet top-3
        st.write(f"- {pattern}")

    st.write("\n**Disambiguatie overwegingen:**")
    for consideration in suggestion.disambiguation_notes:
        st.write(f"- {consideration}")

# Manual override altijd mogelijk
selected = st.selectbox("UFO Categorie (u kunt wijzigen)",
                        options=UFO_CATEGORIES,
                        index=UFO_CATEGORIES.index(suggestion.primary_category))</code></pre>

<ul>
<li>**Verplichte review**: Bij confidence <0.6 wordt manual review afgedwongen</li>
<li>**Transparantie**: ALLE overwegingen zijn zichtbaar voor juridische verantwoording</li>
<li>**Geen haast**: Gebruiker kan rustig alle details bekijken</li>
</ul>

<h2>Integratiepunten & Dependencies (Vereenvoudigd)</h2>

<ul>
<li>**ServiceContainer**: Simpele integratie via `container.ufo_classifier()`</li>
<li>**Database updates**: Synchrone updates (geen async nodig voor single-user)</li>
<li>**Approval flow**: gebruiker bevestigt/overschrijft; simpele audit trail</li>
<li>**Initi√´le classificatie**:</li>
<li> - Classificeer bestaande 80+ definities bij eerste run</li>
<li> - Markeer items met lage confidence voor review</li>
<li> - Geen performance vereisten - mag enkele seconden duren</li>
<li>**Database schema updates**:</li>
<pre><code>  ALTER TABLE definitions ADD COLUMN ufo_suggestion VARCHAR(50);
  ALTER TABLE definitions ADD COLUMN ufo_confidence REAL;
  ALTER TABLE definitions ADD COLUMN ufo_source VARCHAR(20) DEFAULT 'manual';
  CREATE TABLE definition_ufo_history (
    id INTEGER PRIMARY KEY,
    definition_id INTEGER,
    old_category VARCHAR(50),
    new_category VARCHAR(50),
    confidence REAL,
    source VARCHAR(20),
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
  );</code></pre>
</ul>

<h2>Regels & Configuratie</h2>

<pre><code># config/ufo_rules.yaml
rules:
  - id: kind_substantive
    category: Kind
    patterns:
      - "een [NOUN] is"
      - "de [NOUN] die"
    weight: 0.8

  - id: event_temporal
    category: Event
    patterns:
      - "tijdens|gedurende|na afloop"
      - "[VERB]ing van"
    weight: 0.7

  - id: role_context
    category: Role
    patterns:
      - "in de hoedanigheid van"
      - "als [NOUN]"
    weight: 0.6</code></pre>

<p>Score berekening: <code>score[cat] = Œ£(weight √ó match) - conflicts</code></p>

<h2>Test Strategie & Kwaliteitsborging</h2>

<h3>Kwaliteit Tests (Focus op Correctheid)</h3>
<pre><code># tests/services/test_ufo_classifier_service.py
def test_all_16_categories():
    """Test dat ALLE 16 UFO categorie√´n correct gedetecteerd worden."""
    test_cases = load_annotated_test_set()  # 100+ handmatig geannoteerde cases

    for term, definition, expected_category in test_cases:
        result = classify(term, definition)
        assert result.primary_category == expected_category
        # Controleer dat ALLE relevante patronen gevonden zijn
        assert len(result.matched_patterns) &gt; 0
        assert len(result.all_scores) == 16  # Alle categorie√´n overwogen

def test_disambiguation():
    """Test disambiguatie voor complexe juridische termen."""
    # Test "zaak" in verschillende contexten
    assert classify("zaak", "Een rechtszaak voor de rechter").primary_category == "Event"
    assert classify("zaak", "Een roerende zaak zoals een auto").primary_category == "Kind"
    assert classify("zaak", "De zaak van de verdachte").primary_category == "Abstract"</code></pre>

<h3>Kwaliteitsmetrics (Single-User Focus)</h3>
<p>| Metric | Target | Prioriteit |</p>
<p>|--------|--------|------------|</p>
<p>| <strong>Precisie alle categorie√´n</strong> | ‚â•95% | KRITIEK |</p>
<p>| <strong>Disambiguatie correctheid</strong> | ‚â•90% | KRITIEK |</p>
<p>| <strong>Uitleg volledigheid</strong> | 100% | HOOG |</p>
<p>| Classificatie tijd | <500ms | LAAG |</p>
<p>| Memory usage | <500MB | LAAG |</p>

<h3>Kwaliteitsmetrics</h3>
<ul>
<li>**Validatieset**: 100+ zorgvuldig geannoteerde Nederlandse juridische definities</li>
<li>**Precisie**: ‚â•95% voor alle categorie√´n (geen shortcuts)</li>
<li>**Disambiguatie**: ‚â•90% correct voor ambigue termen</li>
<li>**Uitleg kwaliteit**: Elke classificatie volledig verantwoord</li>
<li>**Gebruikerstevredenheid**: Correctheid > Snelheid</li>
</ul>

<h2>Implementatie Strategie (Single-User)</h2>

<h3>Direct Live (Week 1)</h3>
<ul>
<li>Implementeer volledige UFOClassificationService</li>
<li>Integreer direct in alle tabs (Generator/Edit/Expert)</li>
<li>Classificeer bestaande 80+ definities</li>
<li>**Focus**: Kwaliteit van classificatie, niet rollout complexity</li>
</ul>

<h3>Iteratieve Verbetering (Ongoing)</h3>
<ul>
<li>Gebruiker geeft feedback via UI</li>
<li>Regel updates via config files</li>
<li>Continue verbetering van patterns</li>
<li>**Success**: Gebruiker vertrouwt de suggesties</li>
</ul>

<h3>Impact voor Gebruiker</h3>
<ul>
<li>**Tijdsbesparing**: Minder handmatig categoriseren</li>
<li>**Consistentie**: Elke definitie krijgt dezelfde grondige analyse</li>
<li>**Leercurve**: Gebruiker leert UFO-categorie√´n via uitgebreide uitleg</li>
<li>**Kwaliteit**: Betere juridische onderbouwing door volledige analyse</li>
</ul>

<h2>Risico's & Mitigatie (Vereenvoudigd)</h2>

<h3>Technische Risico's</h3>
<ul>
<li>**Ambigue termen**: Uitgebreide disambiguatie regels + altijd manual override</li>
<li>**Missende categorie√´n**: Alle 16 UFO categorie√´n ge√Ømplementeerd</li>
<li>**Onjuiste classificatie**: Transparante uitleg + gebruiker kan altijd wijzigen</li>
</ul>

<h3>Maintenance</h3>
<ul>
<li>**Rule updates**: Simpele YAML config files</li>
<li>**Feedback verwerking**: Direct in config aanpassen</li>
<li>**Geen monitoring overhead**: Single-user heeft geen monitoring nodig</li>
</ul>

<h2>Verbetering Process (Pragmatisch)</h2>

<ol>
<li>**Gebruiker feedback**: Direct via UI wanneer classificatie niet klopt</li>
<li>**Rule updates**: Aanpassen in YAML wanneer nodig</li>
<li>**Testen**: Rerun op test set van 100+ definities</li>
<li>**Deploy**: Direct live (geen staged rollout nodig)</li>
</ol>

<h2>Definition of Done</h2>

<ul>
<li>[ ] UFOClassificationService met alle 16 categorie√´n</li>
<li>[ ] Grondige test coverage (focus op correctheid, niet performance)</li>
<li>[ ] UI integratie in alle drie tabs met uitgebreide uitleg</li>
<li>[ ] Disambiguatie voor complexe juridische termen</li>
<li>[ ] 500+ Nederlandse juridische termen ge√Ømplementeerd</li>
<li>[ ] Initi√´le classificatie van 80+ bestaande definities</li>
<li>[ ] YAML config voor rule updates</li>
<li>[ ] `last_verified` timestamp bijgewerkt</li>
</ul>
  </div>
</body>
</html>