<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US-062: titel: Implement Bulk Import Functionality</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>id: US-062</p>
<p>epic: EPIC-005</p>
<p>titel: "US-062: titel: Implement Bulk Import Functionality"</p>
<p>type: feature</p>
<p>status: archived</p>
<p>prioriteit: HIGH</p>
<p>story_points: 8</p>
<p>sprint: backlog</p>
<p>aangemaakt: 2025-09-11</p>
<p>bijgewerkt: 2025-09-11</p>
<p>owner: developer</p>
<p>applies_to: definitie-app@current</p>
<p>canonical: false</p>
<p>last_verified: 2025-10-14</p>
<p>vereisten:</p>
<ul>
<li> - REQ-083</li>
<p>note: Uitbreiding van US-023 Batch Operations</p>
<p>toegewezen_aan: development-team</p>
<p>archived_reason: "Bulkoperaties passen bij enterprise-schaal, niet bij single-user workflow"</p>
<p>---</p>
</ul>

<h1>US-062: Implement Bulk Import Functionality</h1>

<p><strong>Epic:</strong> EPIC-005 - Export & Import</p>

<h2>Gebruikersverhaal</h2>

<p><strong>Als een</strong> data administrator</p>
<p><strong>wil ik</strong> meerdere definities tegelijk kunnen importeren</p>
<p><strong>zodat</strong> ik efficiënt grote datasets kan verwerken en migreren</p>

<h2>Probleembeschrijving</h2>

<p>TODO in <code>ui/components/export_tab.py:814</code> - Bulk import functionaliteit ontbreekt.</p>
<p>Dit is essentieel voor data migratie en batch processing van definities.</p>

<h2>Acceptatiecriteria</h2>

<h3>Functionele Criteria</h3>
<ul>
<li>[ ] CSV import ondersteuning</li>
<li>[ ] JSON import ondersteuning</li>
<li>[ ] Excel (.xlsx) import ondersteuning</li>
<li>[ ] Validatie van import data</li>
<li>[ ] Preview voor import (eerste 10 records)</li>
<li>[ ] Conflict resolution opties (overwrite/skip/merge)</li>
<li>[ ] Progress indicator tijdens import</li>
<li>[ ] Import rapport na afloop</li>
</ul>

<h3>Technische Criteria</h3>
<ul>
<li>[ ] Streaming voor grote files (>10MB)</li>
<li>[ ] Transaction-based import (alles of niets)</li>
<li>[ ] Rollback capability bij fouten</li>
<li>[ ] Memory-efficient processing</li>
<li>[ ] Async processing voor UI responsiveness</li>
</ul>

<h3>Data Validatie</h3>
<ul>
<li>[ ] Schema validatie</li>
<li>[ ] Verplichte velden check</li>
<li>[ ] Data type validatie</li>
<li>[ ] Referential integrity check</li>
<li>[ ] Duplicate detection</li>
</ul>

<h2>Implementatie Details</h2>

<h3>Import Service</h3>
<pre><code>class BulkImportService:
    async def validate_file(self, file: UploadedFile) -&gt; ValidationResult
    async def preview_import(self, file: UploadedFile, limit: int = 10) -&gt; list[dict]
    async def execute_import(
        self,
        file: UploadedFile,
        conflict_strategy: ConflictStrategy,
        dry_run: bool = False
    ) -&gt; ImportResult</code></pre>

<h3>Conflict Strategies</h3>
<ul>
<li>SKIP: Skip conflicting records</li>
<li>OVERWRITE: Replace existing records</li>
<li>MERGE: Merge with existing data</li>
<li>VERSION: Create new version</li>
</ul>

<h2>Definition of Done</h2>

<ul>
<li>[ ] Import service geïmplementeerd</li>
<li>[ ] File upload UI component</li>
<li>[ ] Validation logic complete</li>
<li>[ ] Progress tracking werkend</li>
<li>[ ] Error handling en rollback</li>
<li>[ ] Unit tests voor import logic</li>
<li>[ ] Integration tests met database</li>
<li>[ ] Performance test met 10k+ records</li>
<li>[ ] Gebruikersdocumentatie</li>
</ul>

<h2>Risico's</h2>

<p>| Risico | Impact | Mitigatie |</p>
<p>|--------|--------|-----------|</p>
<p>| Memory overflow grote files | High | Streaming processing |</p>
<p>| Data corruption | High | Transaction + validation |</p>
<p>| UI freeze tijdens import | Medium | Async processing |</p>
<p>| Incomplete imports | High | Rollback mechanism |</p>

<h2>Statusupdate 2025-10-06</h2>
<ul>
<li>Management-tab bevat een “Kleine batch CSV import (≤100)” workflow (`src/ui/components/management_tab.py`, sectie “Kleine batch CSV import”) die `DefinitionImportService` hergebruikt voor sequentiële import en rapportdownload; deze flow vervangt ook de voormalige enkelvoudige import.</li>
<li>JSON/XLSX-ondersteuning, streaming, transactionele verwerking en conflictstrategieën ontbreken nog; de bulkservice en UI moeten worden uitgebreid voordat de acceptatiecriteria gehaald worden.</li>
</ul>

<h2>Notes</h2>

<ul>
<li>Begin met CSV als primary format</li>
<li>Overweeg queuing voor zeer grote imports</li>
<li>Implementeer dry-run mode eerst</li>
</ul>

  </div>
</body>
</html>