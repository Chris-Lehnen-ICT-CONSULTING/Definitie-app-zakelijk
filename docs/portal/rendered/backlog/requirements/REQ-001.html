<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>authenticatie & autorisatie</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>aangemaakt: '08-09-2025'</p>
<p>bijgewerkt: '08-09-2025'</p>
<p>id: REQ-001</p>
<p>links:</p>
<p>  docs:</p>
<ul>
<li> - ENTERPRISE_ARCHITECTURE.md</li>
<li> - SOLUTION_ARCHITECTURE.md</li>
<p>  epics:</p>
<li> - EPIC-006</li>
<p>  stories:</p>
<li> - US-6.1</li>
<li> - US-6.2</li>
<p>prioriteit: HOOG</p>
<p>sources:</p>
<li>line: Episch Verhaal 6 - beveiliging & Auth</li>
<p>  path: docs/backlog/stories/MASTER-EPICS-USER-STORIES.md</p>
<li>line: authenticatie Implementatie</li>
<p>  path: authenticatie service nog te implementeren</p>
<p>status: In Progress</p>
<p>titel: authenticatie & autorisatie</p>
<p>type: nonfunctional</p>
<p>---</p>
</ul>



<h1>Requirement REQ-001: authenticatie & autorisatie</h1>

<h2>Beschrijving</h2>

<p>Het systeem moet auDanticatie en autorisatie implementeren voor alle gebruikers, waarbij toegang tot functionaliteit wordt gecontroleerd op basis van rollen en rechten. Dit omvat zowel UI-toegang als API-beveiliging.</p>

<h2>Rationale</h2>

<p>Juridische definities kunnen gevoelige informatie bevatten. Het systeem moet waarborgen dat alleen geautoriseerde gebruikers toegang hebben tot specifieke functionaliteit en data conform de justitiesector beveiligingsstEnaarden.</p>

<h2>Acceptatiecriteria (SMART)</h2>

<ul>
<li>Het systeem moet binnen 2 seconden een gebruiker kunnen auDanticeren</li>
<li>Alle API endpoints moeten beveiligd zijn met token-based auDanticatie</li>
<li>Role-Based Access Control (RBAC) met minimaal 3 rollen: Admin, Editor, Viewer</li>
<li>Session timeout na 30 minuten inactiviteit</li>
<li>Audit logging van alle auDanticatie pogingen</li>
<li>Multi-factor auDanticatie (MFA) ondersteuning voor admin rollen</li>
</ul>


<h3>SMART Acceptatiecriteria</h3>

<ul>
<li>**Specifiek:** Implementeer role-based access control met Justice SSO integratie</li>
<li>**Meetbaar:** 100% endpoint coverage, <2s authenticatie response tijd, 0 unauthorized access</li>
<li>**Achievable:** OAuth2/SAML2 standaard implementatie met bestaande libraries</li>
<li>**Relevant:** Vereist voor DJI/OM security compliance en productie deployment</li>
<li>**Time-bound:** Compleet voor einde Sprint 3 (production gate requirement)</li>
</ul>

<h3>BDD Scenario's</h3>
<pre><code>Scenario: Gebruiker authenticatie via Justice SSO
  Gegeven een gebruiker navigeert naar de applicatie
  Wanneer de gebruiker nog niet is ingelogd
  Dan wordt de gebruiker doorgestuurd naar Justice SSO
  En na succesvolle authenticatie wordt een sessie aangemaakt
  En worden gebruikersrollen opgehaald uit het identity systeem
  En wordt een audit log entry gemaakt van de login

Scenario: Role-based toegangscontrole
  Gegeven een gebruiker met rol "Viewer"
  Wanneer de gebruiker probeert een definitie te wijzigen
  Dan wordt een 403 Forbidden response teruggegeven
  En wordt de poging gelogd in het security audit log
  En blijft de gebruiker ingelogd met read-only rechten

Scenario: Sessie timeout na inactiviteit
  Gegeven een ingelogde gebruiker
  Wanneer er 30 minuten geen activiteit is
  Dan wordt de sessie automatisch beëindigd
  En wordt de gebruiker doorgestuurd naar het login scherm
  En wordt een sessie timeout event gelogd</code></pre>

<h3>ASTRA/NORA Compliance</h3>
<ul>
<li>**ASTRA-SEC-002**: Identity & Access Management</li>
<li>**ASTRA-SEC-004**: Session Management</li>
<li>**NORA-BP-15**: Vertrouwelijkheid en toegangsbeveiliging</li>
<li>**DJI-AUTH-001**: Justice SSO Integration Standards</li>
<li>**Justid-001**: Centraal identity management</li>
</ul>

<h3>Implementatie Componenten</h3>
<pre><code>src/auth/
├── sso_integration.py       # Justice SSO SAML2/OAuth2
├── role_manager.py          # RBAC implementatie
├── session_handler.py       # Session management
└── audit_logger.py          # Beveiliging audit logging</code></pre>
<ul>
<li> - Response tijd: < 200ms voor UI acties</li>
<li> - Processing tijd: < 5 seconden voor generatie</li>
<li> - Success rate: > 95% voor validaties</li>
<li>**Acceptabel:** Haalbaar binnen huidige architectuur</li>
<li>**Relevant:** Direct gerelateerd aan gebruikersbehoefte</li>
<li>**Tijdgebonden:** Gerealiseerd binnen huidige sprint</li>
</ul>


<h2>Uitwerking / Notities</h2>

<ul>
<li>Integratie met Justice SSO systemen (toekomstig)</li>
<li>JWT tokens met 24 uur geldigheid</li>
<li>Refresh token mechanisme voor seamless re-auDanticatie</li>
<li>Password beleid: min 12 karakters, complexiteit vereisten</li>
<li>Account lockout na 5 mislukte pogingen</li>
</ul>

<h2>Conflicten (indien van toepassing)</h2>

<ul>
<li>met: REQ-004 — Session storage vs XSS beveiliging - opgelost door secure cookie flags</li>
</ul>
<h2>SMART Criteria</h2>

<ul>
<li>**Specifiek**: Implement complete auDanticatie & autorisatie beveiliging control</li>
<li>**Meetbaar**: Geen kwetsbaarheden in beveiligingsscans, 100% testdekking</li>
<li>**Haalbaar**: Using established beveiliging libraries en patterns</li>
<li>**Relevant**: KRITIEK voor justitiesector gegevensbeschermingscompliance</li>
<li>**Tijdgebonden**: Must be operational before productie deployment</li>
</ul>


<h3>Compliance Referenties</h3>

<ul>
<li>**ASTRA Controls:**</li>
<li> - ASTRA-QUA-001: Kwaliteitsborging</li>
<li> - ASTRA-SEC-002: Beveiliging by Design</li>
<li>**NORA Principes:**</li>
<li> - NORA-BP-07: Herbruikbaarheid</li>
<li> - NORA-BP-12: Betrouwbaarheid</li>
<li>**GEMMA Referenties:**</li>
<li> - GEMMA-ARC-03: Architectuur patterns</li>
<li>**Justice Sector:**</li>
<li> - DJI/OM integratie vereisten</li>
<li> - Rechtspraak compatibiliteit</li>
</ul>

  </div>
</body>
</html>