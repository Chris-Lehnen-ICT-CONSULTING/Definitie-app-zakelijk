<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brownfield Cleanup & Quality Infrastructure</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>aangemaakt: 2025-09-30</p>
<p>applies_to: definitie-app@current</p>
<p>astra_compliance: false</p>
<p>bijgewerkt: 2025-09-30</p>
<p>canonical: true</p>
<p>completion: 0%</p>
<p>id: EPIC-025</p>
<p>last_verified: 2025-09-30</p>
<p>owner: architecture</p>
<p>prioriteit: P0</p>
<p>status: active</p>
<p>stories:</p>
<ul>
<li>US-426</li>
<li>US-427</li>
<li>US-428</li>
<li>US-429</li>
<li>US-430</li>
<li>US-431</li>
<li>US-432</li>
<li>US-433</li>
<li>US-434</li>
<p>target_release: v2.1</p>
<p>titel: Brownfield Cleanup & Quality Infrastructure</p>
<p>vereisten:</p>
<li>REQ-089</li>
<li>REQ-090</li>
<p>---</p>
</ul>

<h1>EPIC-025: Brownfield Cleanup & Quality Infrastructure</h1>

<h2>Epic Overview</h2>

<p><strong>ID:</strong> EPIC-025</p>
<p><strong>Titel:</strong> Brownfield Cleanup & Quality Infrastructure</p>
<p><strong>Status:</strong> ACTIVE</p>
<p><strong>Priority:</strong> P0 (Blocker)</p>
<p><strong>Created:</strong> 2025-09-30</p>
<p><strong>Owner:</strong> Architecture Team</p>
<p><strong>Target Release:</strong> v2.1</p>

<h2>Problem Statement</h2>

<p>Het DefinitieAgent project heeft een <strong>60-80% discrepantie</strong> tussen gedocumenteerde architectuur/werkwijze en daadwerkelijke implementatie, resulterend in:</p>

<ul>
<li>Developer confusion (3 conflicterende instruction bronnen)</li>
<li>Architecture violations (14 UI files met directe DB access)</li>
<li>Process breakdown (TDD workflow niet toegepast, 5.2% review coverage)</li>
<li>Code bloat (5 bestanden 2-4.7x over limiet, 2066 LOC duplicatie)</li>
</ul>

<p>Dit blokkeert consistent feature development en accumuleert technical debt ongecontroleerd.</p>

<h2>Business Value</h2>

<h3>Direct Benefits</h3>

<ol>
<li>**Developer Productivity** (+30%)</li>
</ol>
<ul>
<li>  - Onboarding tijd: Weken → Dagen</li>
<li>  - Feature velocity verhoogd door minder technical debt friction</li>
<li>  - Clear patterns & practices documented</li>
</ul>

<ol>
<li>**Code Quality** (+90% alignment)</li>
</ol>
<ul>
<li>  - Zero architecture violations</li>
<li>  - All files < 500 LOC (maintainable)</li>
<li>  - Automated quality gates prevent regression</li>
</ul>

<ol>
<li>**Documentation Reliability** (60% → 90%)</li>
</ol>
<ul>
<li>  - Architecture docs match reality</li>
<li>  - Developers trust documentation</li>
<li>  - Onboarding material accurate</li>
</ul>

<ol>
<li>**Process Enforcement** (Automated)</li>
</ol>
<ul>
<li>  - 10+ quality checks in CI</li>
<li>  - Pre-commit hooks enforced</li>
<li>  - Workflow violations blocked</li>
</ul>

<h3>Risk Reduction</h3>

<ul>
<li>**Reduced regression risk:** Smaller, tested files</li>
<li>**Improved maintainability:** Clear ownership & patterns</li>
<li>**Sustainable foundation:** Quality gates prevent future debt</li>
<li>**Agent clarity:** No conflicting instructions</li>
</ul>

<h2>Scope</h2>

<h3>In Scope</h3>

<p><strong>Sprint 1: Foundation Fixes (Week 1-2)</strong></p>
<ul>
<li>Fix 6 US-ID duplicaties</li>
<li>Split 5 gigantic files (>500 LOC)</li>
<li>Resolve 3 agent instruction conflicts</li>
<li>Reorganize 72 misplaced scripts</li>
</ul>

<p><strong>Sprint 2: Process Enforcement (Week 3)</strong></p>
<ul>
<li>Implement CI quality gates</li>
<li>Extend pre-commit hooks (4→10+ checks)</li>
<li>Add workflow validation automation</li>
<li>Create WIP tracking tools</li>
</ul>

<p><strong>Sprint 3: Documentation Alignment (Week 4-5)</strong></p>
<ul>
<li>Update architecture documents (EA/SA/TA)</li>
<li>Consolidate code duplicatie (2066→800 LOC)</li>
<li>Create brownfield cleanup PRD</li>
<li>Generate IMPLEMENTATION_STATUS dashboard</li>
</ul>

<h3>Out of Scope</h3>

<ul>
<li>**Feature development:** EPIC-017 deferred tot na cleanup</li>
<li>**Microservices migration:** Remains aspirational/roadmap</li>
<li>**Infrastructure as Code:** K8s/Terraform blijft TO-BE</li>
<li>**Database migration:** SQLite → PostgreSQL (future)</li>
<li>**UI redesign:** Streamlit UI blijft unchanged</li>
</ul>

<h2>Goals & Success Criteria</h2>

<h3>Quantitative Targets</h3>

<p>| Metric | Baseline | Target | Validation |</p>
<p>|--------|----------|--------|------------|</p>
<p>| Doc/Code Alignment | 60% | 90% | Coherence check script |</p>
<p>| Files > 500 LOC | 5 | 0 | <code>find src -exec wc -l</code> |</p>
<p>| Architecture Violations | 14 | 0 | Grep forbidden imports |</p>
<p>| US-ID Conflicts | 6 | 0 | <code>rg "^id: US-" \| uniq -d</code> |</p>
<p>| Code Duplicatie LOC | 2066 | <900 | Count resilience modules |</p>
<p>| CI Quality Checks | 4 | 10+ | pre-commit hook count |</p>
<p>| Epic Status Values | 12 | 4 | Canonical status values |</p>

<h3>Qualitative Targets</h3>

<ul>
<li>✅ New developer can understand codebase in < 2 days</li>
<li>✅ Feature velocity increases 30% post-cleanup</li>
<li>✅ Agents know which instructions to follow</li>
<li>✅ Quality gates prevent future regression</li>
</ul>

<h2>Dependencies</h2>

<h3>Blocked By</h3>
<ul>
<li>None (kan direct starten)</li>
</ul>

<h3>Blocks</h3>
<ul>
<li>**EPIC-017:** Iteratieve Verbeteringen (paused tot cleanup compleet)</li>
<li>**Future feature epics:** Require clean foundation</li>
</ul>

<h3>Requires</h3>
<ul>
<li>Multi-agent analysis complete ✅</li>
<li>Sprint Change Proposal approved (pending)</li>
<li>Stakeholder buy-in for 4-5 week feature pause</li>
</ul>

<h2>Timeline</h2>

<p><strong>Duration:</strong> 4-5 weken (3 sprints)</p>

<p><strong>Sprint Breakdown:</strong></p>
<ul>
<li>**Week 1-2 (Sprint 1):** Foundation fixes (~35h)</li>
<li>**Week 3 (Sprint 2):** Process enforcement (~24h)</li>
<li>**Week 4-5 (Sprint 3):** Documentation alignment (~32h)</li>
</ul>

<p><strong>Total Effort:</strong> ~91 hours</p>

<p><strong>Milestone Dates:</strong></p>
<ul>
<li>Sprint 1 Review: End of Week 2</li>
<li>Sprint 2 Review: End of Week 3</li>
<li>Sprint 3 Complete: End of Week 5</li>
<li>EPIC-017 Resume: Week 6</li>
</ul>

<h2>User Stories</h2>

<h3>Sprint 1: Foundation Fixes</h3>

<ul>
<li>**US-426:** Fix Documentation Critical Issues (Doc Auditor, 13h)</li>
<li>**US-427:** Split Gigantic UI Components (Code Architect, 20h)</li>
<li>**US-428:** Resolve Agent Instruction Conflicts (Process Guardian, 2h)</li>
</ul>

<h3>Sprint 2: Process Enforcement</h3>

<ul>
<li>**US-429:** Implement CI Quality Gates (Process Guardian, 8h)</li>
<li>**US-430:** Extend Pre-commit Hooks (Code Architect, 6h)</li>
<li>**US-431:** Workflow Validation Automation (Process Guardian, 10h)</li>
</ul>

<h3>Sprint 3: Documentation Alignment</h3>

<ul>
<li>**US-432:** Update Architecture Documents (Architecture Coherence, 18h)</li>
<li>**US-433:** Consolidate Code Duplicatie (Code Architect, 10h)</li>
<li>**US-434:** Create Brownfield Cleanup PRD (Doc Auditor, 4h)</li>
</ul>

<h2>Risks & Mitigation</h2>

<h3>High Risks</h3>

<p><strong>Risk 1: Feature Pressure</strong></p>
<ul>
<li>Likelihood: HIGH</li>
<li>Impact: Cleanup abandoned for urgent features</li>
<li>Mitigation: Clear stakeholder communication upfront</li>
<li>Contingency: Hotfix branch strategy</li>
</ul>

<p><strong>Risk 2: Agent Context Loss</strong></p>
<ul>
<li>Likelihood: MEDIUM</li>
<li>Impact: Story execution blocked</li>
<li>Mitigation: Detailed handoff documents</li>
<li>Contingency: Re-run agent analysis</li>
</ul>

<p><strong>Risk 3: Breaking Changes</strong></p>
<ul>
<li>Likelihood: MEDIUM</li>
<li>Impact: Application doesn't start</li>
<li>Mitigation: Small atomic commits, smoke tests</li>
<li>Contingency: Git revert strategy</li>
</ul>

<h3>Rollback Plan</h3>

<p><strong>Trigger:</strong> < 30% progress after Sprint 1</p>
<p><strong>Action:</strong> Reassess approach, consider aborting</p>
<p><strong>Owner:</strong> BMad Master</p>

<h2>Acceptance Criteria</h2>

<h3>Definition of Done (Epic Level)</h3>

<ul>
<li>[ ] All 7 user stories completed and validated</li>
<li>[ ] All quantitative targets met (8/8)</li>
<li>[ ] 10-test validation suite passes (100%)</li>
<li>[ ] Architecture docs updated and reviewed</li>
<li>[ ] CI quality gates active and enforced</li>
<li>[ ] Documentation generated (IMPLEMENTATION_STATUS, ROADMAP)</li>
<li>[ ] Sprint retrospective complete</li>
<li>[ ] EPIC-017 unblocked and ready to resume</li>
</ul>

<h3>Validation Tests</h3>

<p><strong>Week 2 (Sprint 1):</strong></p>
<pre><code>rg "^id: US-" docs/backlog | sort | uniq -d  # No duplicates
find src -name "*.py" -exec wc -l {} \; | awk '$1 &gt; 500'  # No oversized
grep -c "conflict" CLAUDE.md  # Zero conflicts</code></pre>

<p><strong>Week 3 (Sprint 2):</strong></p>
<pre><code>gh workflow list | grep -c "preflight"  # &gt;= 1
pre-commit run --all-files 2&gt;&amp;1 | grep -c "Passed"  # &gt;= 10
ls scripts/workflow-guard.py scripts/wip_tracker.sh  # Exist</code></pre>

<p><strong>Week 5 (Sprint 3 - FINAL):</strong></p>
<pre><code>python scripts/coherence_check.py  # &gt;= 90%
find src/utils -name "*resilience*.py" | wc -l  # 1-2 (was 4-5)
ls docs/architectuur/IMPLEMENTATION_STATUS.md  # Exists</code></pre>

<h2>Notes</h2>

<h3>Related Documentation</h3>

<ul>
<li>**Sprint Change Proposal:** `docs/planning/SPRINT_CHANGE_PROPOSAL_BROWNFIELD_CLEANUP.md`</li>
<li>**Agent Analysis:** `docs/planning/AGENT_ANALYSIS_SUMMARY.md`</li>
<li>**Correct-Course Checklist:** `.bmad-core/checklists/change-checklist.md` (completed)</li>
</ul>

<h3>Quick Wins (Parallel Track)</h3>

<p>Can be executed immediately while planning sprints:</p>

<ol>
<li>Fix datum typo in TDD_TO_DEPLOYMENT_WORKFLOW.md (5 min)</li>
<li>Remove empty directories (5 min)</li>
<li>Merge technical/ → technisch/ (15 min)</li>
<li>Archive development/ directory (10 min)</li>
<li>Add minimal frontmatter to 20 files (1h)</li>
</ol>

<p><strong>Total:</strong> ~2 hours, immediate impact</p>

<h3>Communication Plan</h3>

<ul>
<li>**Stakeholder announcement:** Why feature pause (sent before Sprint 1)</li>
<li>**Team notification:** Sprint structure & expectations</li>
<li>**Daily async standups:** Agent progress reports</li>
<li>**Weekly progress reports:** Metrics dashboard updates</li>
<li>**Sprint reviews:** End of week 2, 3, 5</li>
</ul>

<p>---</p>

<p><strong>Status:</strong> Ready for approval and execution</p>
<p><strong>Next Action:</strong> User approval → Create 7 user stories → Sprint 1 kickoff</p>

  </div>
</body>
</html>