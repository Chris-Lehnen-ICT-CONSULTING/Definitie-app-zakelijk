<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Import validatie</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>Afhankelijkheden:</p>
<ul>
<li>US-021</li>
<p>aangemaakt: 05-09-2025</p>
<p>applies_to: definitie-app@current</p>
<p>bijgewerkt: 05-09-2025</p>
<p>canonical: true</p>
<p>epic: EPIC-005</p>
<p>id: US-138</p>
<p>last_verified: 06-10-2025</p>
<p>owner: developer-implementer</p>
<p>prioriteit: HOOG</p>
<p>sprint: backlog</p>
<p>status: IN_UITVOERING</p>
<p>story_points: 5</p>
<p>titel: Import validatie</p>
<p>toegewezen_aan: unassigned</p>
<p>type: feature</p>
<p>---</p>
</ul>



<h1>US-138: Import validatie</h1>

<h2>Gebruikersverhaal</h2>

<p><strong>As a</strong> legal analyst</p>
<p><strong>wil ik to</strong> import previously exported definitions with full validatie</p>
<p><strong>zodat</strong> I can reuse definitions across cases en ensure imported content meets quality stEnards</p>

<h2>Acceptatiecriteria</h2>


<h3>SMART Acceptatiecriteria</h3>

<ul>
<li>**Specifiek:** [Exact gedrag dat moet worden gerealiseerd]</li>
<li>**Meetbaar:**</li>
<li> - Response tijd: < 200ms voor UI acties</li>
<li> - Processing tijd: < 5 seconden voor generatie</li>
<li> - Success rate: > 95% voor validaties</li>
<li>**Acceptabel:** Haalbaar binnen huidige architectuur</li>
<li>**Relevant:** Direct gerelateerd aan gebruikersbehoefte</li>
<li>**Tijdgebonden:** Gerealiseerd binnen huidige sprint</li>
</ul>


<h3>AC1: File Format Detection</h3>
<p><strong>gegeven</strong> a file is selected for import</p>
<p><strong>wanneer</strong> the import process begins</p>
<p><strong>dan</strong> the system automatically detects the format (JSON/DOCX) En applies appropriate parser</p>

<h3>AC2: Schema validatie</h3>
<p><strong>gegeven</strong> a JSON file is imported</p>
<p><strong>wanneer</strong> the file is parsed</p>
<p><strong>dan</strong> the system validaties:</p>
<ul>
<li>Required fields presence</li>
<li>Data type correctness</li>
<li>Versie compatibility</li>
<li>Checksum verification if present</li>
</ul>

<h3>AC3: Content validatie</h3>
<p><strong>gegeven</strong> definition content is extracted from import</p>
<p><strong>wanneer</strong> validatie is triggered</p>
<p><strong>dan</strong> the system:</p>
<ul>
<li>Runs all 45 validatieregels</li>
<li>Compares with original validatie scores if available</li>
<li>Flags any degradation in quality</li>
<li>Provides detailed validatie report</li>
</ul>

<h3>AC4: Duplicate Detection</h3>
<p><strong>gegeven</strong> an imported definition</p>
<p><strong>wanneer</strong> checking against existing definitions</p>
<p><strong>dan</strong> the system:</p>
<ul>
<li>Detects exact duplicates</li>
<li>Identifies similar definitions (>80% similarity)</li>
<li>Offers merge/replace/skip options</li>
<li>Maintains Versie history</li>
</ul>

<h3>AC5: Error Handling</h3>
<p><strong>gegeven</strong> an import fails validatie</p>
<p><strong>wanneer</strong> errors are detected</p>
<p><strong>dan</strong> the system:</p>
<ul>
<li>Provides clear error messages</li>
<li>HOOGlights specific issues in content</li>
<li>Offers correction suggestions</li>
<li>AlLAAGs partial import where possible</li>
</ul>

<h2>Statusupdate 2025-10-06</h2>
<ul>
<li>`DefinitionImportService.validate_single` (`src/services/definition_import_service.py`) levert validatie en duplicaatdetectie voor de legacy “Enkelvoudige import (MVP)” flow (`src/ui/components/management_tab.py:352`).</li>
<li>Advies: gebruik de CSV-bulkimport (≤100) voor nieuwe scenario's; de enkelvoudige import blijft alleen voor compatibiliteit.</li>
<li>Formaatdetectie, volledige schema validatie, 45-regel businessvalidatie en similarity-gebaseerde duplicate workflows ontbreken nog; deze story blijft open voor uitbreidingen richting batch-import (`US-062`) en admin duplicate scans.</li>
</ul>

<h2>Domain vereisten</h2>

<h3>ASTRA compliance</h3>
<ul>
<li>ValiDatum against ASTRA definition stEnards</li>
<li>Check mEnatory metadata fields</li>
<li>Ensure justice domain terminology compliance</li>
<li>Verify context classification</li>
</ul>

<h3>Data Integrity</h3>
<ul>
<li>Maintain auditspoor for imported definitions</li>
<li>Preserve original authorship information</li>
<li>Track import source en timestamp</li>
<li>Enable rollback capability</li>
</ul>

<h3>Chain Integration</h3>
<ul>
<li>ValiDatum Justid identifiers if present</li>
<li>Check cross-references to other systems</li>
<li>Maintain relationship mappings</li>
<li>Preserve chain-specific metadata</li>
</ul>

<h2>Technische Notities</h2>

<h3>Implementatie Components</h3>
<ul>
<li>`ImportValidationService` in `src/services/import/`</li>
<li>Format-specific parsers (JSON, DOCX)</li>
<li>Schema validators using `jsonschema`</li>
<li>Duplicate detection using similarity algorithms</li>
</ul>

<h3>Referenties</h3>
<ul>
<li>[REQ-073](../../requirements/REQ-073.md)</li>
<li>[REQ-074](../../requirements/REQ-074.md)</li>
</ul>

<h3>validatie Pipeline</h3>
<ol>
<li>File format detection en parsing</li>
<li>Structural validatie (schema)</li>
<li>Content extraction</li>
<li>Business rule validatie (45 rules)</li>
<li>Duplicate/similarity checking</li>
<li>Import decision en execution</li>
</ol>

<h3>Error Recovery</h3>
<ul>
<li>Implement transactional imports</li>
<li>Support partial imports with warnings</li>
<li>Provide detailed error logs</li>
<li>Enable retry with corrections</li>
</ul>



<h2>Afhankelijkheden</h2>

<ul>
<li>EPIC-005</li>
</ul>
<h2>Test vereisten</h2>

<h3>Unit Tests</h3>
<ul>
<li>Parser functionality for each format</li>
<li>Schema validatieregels</li>
<li>Duplicate detection algorithms</li>
<li>Error hEnling paths</li>
</ul>

<h3>Integration Tests</h3>
<ul>
<li>Import-validatie-storage pipeline</li>
<li>Cross-format import scenarios</li>
<li>Large file hEnling</li>
<li>Concurrent import operations</li>
</ul>

<h3>Edge Cases</h3>
<ul>
<li>Corrupted files</li>
<li>Incomplete exports</li>
<li>Versie mismatches</li>
<li>Encoding issues</li>
<li>Circular references</li>
</ul>

<h2>Definitie van Gereed</h2>

<ul>
<li>[ ] Import validatie service geïmplementeerd</li>
<li>[ ] Format parsers for JSON en DOCX complete</li>
<li>[ ] All validatieregels applied to imports</li>
<li>[ ] Duplicate detection operational</li>
<li>[ ] Error hEnling comprehensive</li>
<li>[ ] Unit tests >85% coverage</li>
<li>[ ] Integration tests passing</li>
<li>[ ] Prestaties targets met (< 5s for validatie)</li>
<li>[ ] beveiliging review Voltooid</li>
<li>[ ] User documentation bijgewerkt</li>
<li>[ ] ASTRA compliance verified</li>
</ul>

<h2>Links</h2>

<ul>
<li>Related vereisten: [REQ-073](../../requirements/REQ-073.md), [REQ-074](../../requirements/REQ-074.md)</li>
<li>Episch Verhaal: EPIC-005-export-import</li>
<li>Depends on: US-021</li>
<li>Technical Spec: `docs/technisch/import-validatie-spec.md`</li>
</ul>

  </div>
</body>
</html>