<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US-207: title: Create reusable UI component library</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>id: US-207</p>
<p>titel: "US-207: title: Create reusable UI component library"</p>
<p>epic: EPIC-026</p>
<p>title: Create reusable UI component library</p>
<p>status: open</p>
<p>priority: HIGH</p>
<p>created: 2025-01-18</p>
<p>updated: 2025-01-18</p>
<p>owner: development-team</p>
<p>applies_to: definitie-app@current</p>
<p>canonical: false</p>
<p>last_verified: 2025-10-02</p>
<p>tags:</p>
<ul>
<li> - phoenix</li>
<li> - ui</li>
<li> - components</li>
<li> - streamlit</li>
<li> - refactoring</li>
<p>estimated_hours: 16</p>
<p>actual_hours: 0</p>
<p>---</p>
</ul>

<h1>US-207: Create reusable UI component library</h1>

<h2>User Story</h2>
<p>Als een <strong>ontwikkelaar</strong> wil ik een <strong>gestructureerde bibliotheek van herbruikbare UI componenten</strong> zodat ik <strong>consistente interfaces kan bouwen zonder code duplicatie</strong>.</p>

<h2>Context</h2>
<p>Het huidige Streamlit UI systeem bevat veel gedupliceerde code en ad-hoc componenten verspreid over verschillende modules. Door een centrale component library te creëren kunnen we:</p>
<ul>
<li>Code duplicatie elimineren</li>
<li>Consistente styling garanderen</li>
<li>Sneller nieuwe features ontwikkelen</li>
<li>Makkelijker UI tests schrijven</li>
</ul>

<h2>Acceptance Criteria</h2>
<ol>
<li>**Component Library Structure**</li>
</ol>
<ul>
<li>  - [ ] Directory `src/ui/components/` aangemaakt met subdirectories voor component categorieën</li>
<li>  - [ ] Base component klasse voor gemeenschappelijke functionaliteit</li>
<li>  - [ ] Type hints en docstrings voor alle componenten</li>
</ul>

<ol>
<li>**Core Components Geïmplementeerd**</li>
</ol>
<ul>
<li>  - [ ] ValidationResultCard component (vervangt inline rendering)</li>
<li>  - [ ] DefinitionDisplay component (met syntax highlighting)</li>
<li>  - [ ] MetricsDisplay component (voor stats en scores)</li>
<li>  - [ ] ConfigurationPanel component (voor settings)</li>
<li>  - [ ] ProgressIndicator component (voor lange operaties)</li>
<li>  - [ ] ErrorBoundary component (voor foutafhandeling)</li>
</ul>

<ol>
<li>**Component Registry**</li>
</ol>
<ul>
<li>  - [ ] Centraal register voor alle UI componenten</li>
<li>  - [ ] Lazy loading mechanisme voor performance</li>
<li>  - [ ] Component versioning voor backwards compatibility tijdens migratie</li>
</ul>

<ol>
<li>**Styling System**</li>
</ol>
<ul>
<li>  - [ ] Centrale CSS/styling configuratie</li>
<li>  - [ ] Theme support (light/dark mode voorbereid)</li>
<li>  - [ ] Responsive design utilities</li>
</ul>

<ol>
<li>**Migration Path**</li>
</ol>
<ul>
<li>  - [ ] Alle bestaande UI code geïdentificeerd voor migratie</li>
<li>  - [ ] Component usage map gecreëerd</li>
<li>  - [ ] Deprecation warnings voor oude patterns</li>
</ul>

<h2>Technical Design</h2>

<h3>Directory Structure</h3>
<pre><code>src/ui/components/
├── __init__.py
├── base.py                  # BaseComponent class
├── registry.py              # Component registry
├── display/
│   ├── __init__.py
│   ├── definition.py        # DefinitionDisplay
│   ├── validation.py        # ValidationResultCard
│   └── metrics.py          # MetricsDisplay
├── input/
│   ├── __init__.py
│   ├── text_input.py       # Enhanced text inputs
│   └── selectors.py        # Dropdowns, multiselects
├── layout/
│   ├── __init__.py
│   ├── containers.py       # Reusable containers
│   └── navigation.py       # Navigation components
└── feedback/
    ├── __init__.py
    ├── progress.py         # Progress indicators
    └── errors.py           # Error displays</code></pre>

<h3>Base Component Pattern</h3>
<pre><code>from abc import ABC, abstractmethod
from typing import Any, Dict, Optional
import streamlit as st

class BaseComponent(ABC):
    """Base class for all UI components."""

    def __init__(self, key: Optional[str] = None):
        self.key = key or self._generate_key()
        self._container = None

    @abstractmethod
    def render(self, **kwargs) -&gt; Any:
        """Render the component."""
        pass

    def with_container(self, container):
        """Set the Streamlit container for rendering."""
        self._container = container
        return self

    def _generate_key(self) -&gt; str:
        """Generate unique component key."""
        return f"{self.__class__.__name__}_{id(self)}"</code></pre>

<h3>Example Component Implementation</h3>
<pre><code>class ValidationResultCard(BaseComponent):
    """Reusable card for displaying validation results."""

    def render(
        self,
        result: ValidationResult,
        expanded: bool = False,
        show_details: bool = True
    ) -&gt; None:
        """Render validation result card."""
        container = self._container or st

        with container.expander(
            f"{result.icon} {result.rule_name}",
            expanded=expanded
        ):
            # Render score
            cols = container.columns([2, 1])
            with cols[0]:
                container.markdown(f"**Score:** {result.score}/10")
            with cols[1]:
                container.markdown(f"**Prioriteit:** {result.priority}")

            # Render feedback
            if show_details and result.feedback:
                container.info(result.feedback)

            # Render suggestions
            if result.suggestions:
                container.markdown("**Suggesties:**")
                for suggestion in result.suggestions:
                    container.markdown(f"- {suggestion}")</code></pre>

<h2>Implementation Notes</h2>

<ol>
<li>**Streamlit Integration**</li>
</ol>
<ul>
<li>  - Components moeten native Streamlit widgets wrappen, niet vervangen</li>
<li>  - Session state management moet transparent zijn</li>
<li>  - Component keys moeten uniek en stabiel zijn</li>
</ul>

<ol>
<li>**Performance Considerations**</li>
</ol>
<ul>
<li>  - Gebruik `@st.cache_data` waar mogelijk</li>
<li>  - Minimaliseer re-renders door slimme key management</li>
<li>  - Lazy load zware componenten</li>
</ul>

<ol>
<li>**Testing Strategy**</li>
</ol>
<ul>
<li>  - Unit tests voor component logic</li>
<li>  - Snapshot tests voor rendered output</li>
<li>  - Integration tests met Streamlit app</li>
</ul>

<ol>
<li>**Migration Strategy**</li>
</ol>
<ul>
<li>  - Start met meest gebruikte componenten</li>
<li>  - Gebruik feature flags tijdens transitie</li>
<li>  - Behoud oude code tot volledige migratie</li>
</ul>

<h2>Dependencies</h2>
<ul>
<li>Streamlit >= 1.29.0</li>
<li>Python typing extensions</li>
<li>Optional: streamlit-elements voor geavanceerde componenten</li>
</ul>

<h2>Definition of Done</h2>
<ul>
<li>[ ] Alle componenten geïmplementeerd volgens design pattern</li>
<li>[ ] Unit tests voor elk component (>80% coverage)</li>
<li>[ ] Documentatie voor component gebruik</li>
<li>[ ]Voorbeeld applicatie met alle componenten</li>
<li>[ ] Code review door senior developer</li>
<li>[ ] Performance benchmarks uitgevoerd</li>
<li>[ ] Migration guide geschreven</li>
<li>[ ] Oude UI code gemarkeerd voor deprecation</li>
</ul>

<h2>Notes</h2>
<ul>
<li>Coordinate met US-210 (business logic refactoring) voor clean interfaces</li>
<li>Component library kan later uitgebreid worden voor andere projecten</li>
<li>Overweeg publicatie als open source Streamlit component library</li>
</ul>
  </div>
</body>
</html>