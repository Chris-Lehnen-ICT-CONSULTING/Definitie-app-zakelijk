<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Business Logic Extraction Plan - Executive Summary</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>id: EPIC-026-EXTRACTION-PLAN-SUMMARY</p>
<p>epic: EPIC-026</p>
<p>phase: 1</p>
<p>created: 2025-10-02</p>
<p>owner: business-logic-specialist</p>
<p>status: complete</p>
<p>type: executive-summary</p>
<p>---</p>

<h1>Business Logic Extraction Plan - Executive Summary</h1>

<p><strong>Full Plan:</strong> See <code>BUSINESS_LOGIC_EXTRACTION_PLAN.md</code> (33 pages, comprehensive)</p>

<p><strong>Mission:</strong> Extract ALL business logic before rebuild to prevent knowledge loss</p>

<p>---</p>

<h2>Quick Facts</h2>

<p>| Metric | Value |</p>
<p>|--------|-------|</p>
<p>| <strong>Total Codebase</strong> | 83,319 LOC |</p>
<p>| <strong>Validation Rules</strong> | 46 files (dual JSON+Python) |</p>
<p>| <strong>Hidden Orchestrators</strong> | ~1,113 LOC |</p>
<p>| <strong>Hardcoded Patterns</strong> | 728 occurrences in 99 files |</p>
<p>| <strong>God Objects</strong> | 3 files (6,133 LOC total) |</p>
<p>| <strong>Test Data</strong> | 42 definitions in database |</p>
<p>| <strong>Extraction Duration</strong> | 2-3 weeks |</p>

<p>---</p>

<h2>What We're Extracting (Top 10 Critical Items)</h2>

<h3>Priority 1: MUST Extract (Week 1)</h3>
<ol>
<li>**46 Validation Rules** - Dutch legal domain expertise</li>
</ol>
<ul>
<li>  - Dual format: JSON metadata + Python validators</li>
<li>  - Categories: ARAI, CON, ESS, INT, SAM, STR, VER, DUP</li>
<li>  - Effort: 3 days</li>
</ul>

<ol>
<li>**Ontological Category Logic** - Hardcoded in 3 locations!</li>
</ol>
<ul>
<li>  - Patterns for: proces, type, resultaat, exemplaar</li>
<li>  - 6-step protocol with 3-level fallback</li>
<li>  - Effort: 1 day</li>
</ul>

<ol>
<li>**Definition Generation Orchestration** - 380 LOC god method</li>
</ol>
<ul>
<li>  - 10-step workflow</li>
<li>  - 5+ service orchestration</li>
<li>  - Effort: 1 day</li>
</ul>

<h3>Priority 2: SHOULD Extract (Week 2)</h3>
<ol>
<li>**Duplicate Detection** - 3-stage matching algorithm</li>
</ol>
<ul>
<li>  - 70% Jaccard similarity threshold (hardcoded!)</li>
<li>  - Exact → Synonym → Fuzzy matching</li>
<li>  - Effort: 2 days</li>
</ul>

<ol>
<li>**Regeneration Workflows** - State machine</li>
</ol>
<ul>
<li>  - Category change impact analysis</li>
<li>  - Context preservation rules</li>
<li>  - Effort: 2 days</li>
</ul>

<ol>
<li>**Voorbeelden Persistence** - Complex transaction</li>
</ol>
<ul>
<li>  - Type normalization mapping</li>
<li>  - Voorkeursterm single source policy</li>
<li>  - Effort: 1 day</li>
</ul>

<h3>Priority 3: CAN Extract (Week 3)</h3>
<ol>
<li>**UI Hardcoded Logic** - Thresholds and patterns</li>
<li>**Workflow Status Management** - State transitions</li>
<li>**Prompt Building** - Module orchestration</li>
<li>**Performance Optimizations** - Caching strategies</li>
</ol>

<p>---</p>

<h2>Timeline Overview</h2>

<pre><code>Week 1: CRITICAL PATH (Must-Have)
├── Day 1-2: Validation Rules (46 rules)
├── Day 3: Testing validation rules against 42 definitions
├── Day 4: Ontological Category Logic
└── Day 5: Generation Orchestration Workflow

Week 2: IMPORTANT LOGIC (Should-Have)
├── Day 6-7: Duplicate Detection Algorithm
├── Day 8-9: Regeneration State Machine
└── Day 10: Voorbeelden Transaction Logic

Week 3: POLISH &amp; VALIDATION (Can-Have)
├── Day 11-12: UI Hardcoded Logic Extraction
├── Day 13: Workflow Status Management
├── Day 14-15: Prompt Building Documentation
└── Day 16: Final Validation &amp; Completeness Report</code></pre>

<p>---</p>

<h2>Key Risks & Mitigations</h2>

<p>| Risk | Impact | Mitigation |</p>
<p>|------|--------|------------|</p>
<p>| <strong>Incomplete extraction</strong> | Rebuild fails | Grep ALL patterns, cross-reference 42 test definitions |</p>
<p>| <strong>Logic ambiguity</strong> | Wrong behavior | Test EVERY edge case against OLD system |</p>
<p>| <strong>Domain knowledge loss</strong> | Missing legal expertise | Capture ALL ASTRA references, interview experts |</p>
<p>| <strong>Time overrun</strong> | > 3 weeks | Daily tracking, prioritize MUST items only |</p>

<p>---</p>

<h2>Success Criteria</h2>

<p><strong>Minimum Acceptable Criteria (MAC):</strong></p>
<ul>
<li>✅ 100% of MUST-extract items documented</li>
<li>✅ 90%+ of SHOULD-extract items documented</li>
<li>✅ 42 baseline definitions - 100% validation match</li>
<li>✅ 42 baseline definitions - 100% category match</li>
<li>✅ All workflows documented with diagrams</li>
<li>✅ All hardcoded thresholds extracted to config</li>
</ul>

<p><strong>DONE = Rebuild team confirms: "We have enough to rebuild without knowledge loss"</strong></p>

<p>---</p>

<h2>Major Deliverables</h2>

<h3>Documentation (15+ files)</h3>
<ul>
<li>Validation Rules Catalog (46 rules documented)</li>
<li>Workflow Diagrams (5 sequence diagrams)</li>
<li>Algorithm Specifications (4 algorithms)</li>
<li>Business Rules Catalog (CSV)</li>
<li>Hardcoded Logic Inventory</li>
<li>Extraction Completeness Report</li>
</ul>

<h3>Configuration (7 new files)</h3>
<ul>
<li>`config/ontological_patterns.yaml`</li>
<li>`config/validation_thresholds.yaml`</li>
<li>`config/duplicate_detection.yaml`</li>
<li>`config/voorbeelden_type_mapping.yaml`</li>
<li>`config/workflow_transitions.yaml`</li>
<li>`config/ui_thresholds.yaml`</li>
<li>`config/hardcoded_values.yaml`</li>
</ul>

<h3>Test Suite (8 test files)</h3>
<ul>
<li>Baseline validation tests (46 rules × 42 definitions)</li>
<li>Categorization baseline</li>
<li>Duplicate detection baseline</li>
<li>Generation workflow tests</li>
<li>Regeneration tests</li>
<li>Edge case tests</li>
<li>Completeness validation</li>
</ul>

<h3>Baseline Data</h3>
<ul>
<li>42 definitions export (JSON)</li>
<li>OLD system validation results</li>
<li>OLD system categorization</li>
<li>OLD system duplicate detection</li>
<li>OLD system regeneration outputs</li>
</ul>

<p>---</p>

<h2>Critical Hardcoded Logic Hotspots</h2>

<h3>1. Ontological Patterns (DUPLICATED 3x!)</h3>
<p><strong>Location:</strong> <code>src/ui/tabbed_interface.py</code> L354-418</p>
<pre><code>patterns = {
    "proces": ["atie", "eren", "ing", "verificatie", ...],
    "type": ["bewijs", "document", "middel", ...],
    "resultaat": ["besluit", "uitslag", "rapport", ...],
    "exemplaar": ["specifiek", "individueel", ...]
}</code></pre>
<p><strong>Problem:</strong> Same patterns in 3 different methods!</p>

<h3>2. Validation Thresholds (Scattered)</h3>
<ul>
<li>Length: 50-500 chars (ARAI-01)</li>
<li>Confidence: 0.8 high, 0.5 medium, <0.5 low</li>
<li>Similarity: 70% Jaccard threshold</li>
<li>Sentence count: max 3 (SAM-01)</li>
<li>Optimal length: 100-300 chars (VER-01)</li>
</ul>

<h3>3. Rule Reasoning (DUPLICATED in UI!)</h3>
<p><strong>Location:</strong> <code>src/ui/components/definition_generator_tab.py</code> L1771-1835</p>
<p><strong>Problem:</strong> 7 validation rules logic duplicated in UI rendering!</p>

<p>---</p>

<h2>Validation Strategy</h2>

<h3>Baseline Testing with 42 Definitions</h3>

<p><strong>Export baseline:</strong></p>
<pre><code>python scripts/export_baseline_definitions.py
# Creates: docs/business-logic/baseline_42_definitions.json</code></pre>

<p><strong>Compare OLD vs NEW:</strong></p>
<pre><code># After rebuild
baseline = load_baseline()
old_results = run_old_validation(baseline)
new_results = run_new_validation(baseline)

assert old_results == new_results  # 100% match required!</code></pre>

<p><strong>Match Metrics:</strong></p>
<ul>
<li>Validation score match: 100%</li>
<li>Category assignment match: 100%</li>
<li>Duplicate detection match: 100%</li>
<li>Regeneration output match: ≥95% (allow edge case differences)</li>
</ul>

<p>---</p>

<h2>Next Steps</h2>

<h3>Immediate Actions (Day 1)</h3>
<ol>
<li>✅ Review this plan with team</li>
<li>✅ Set up extraction workspace: `docs/business-logic/`</li>
<li>✅ Export 42 baseline definitions</li>
<li>✅ Begin validation rules extraction (ARAI-01 first)</li>
</ol>

<h3>Quality Gates</h3>
<ul>
<li>**End of Week 1:** 46 rules + categorization + orchestration documented</li>
<li>**End of Week 2:** Duplicate + regeneration + voorbeelden documented</li>
<li>**End of Week 3:** All extracted, 100% baseline match, completeness report</li>
</ul>

<h3>Handoff to Rebuild</h3>
<ul>
<li>Deliver all documentation, configs, tests, baselines</li>
<li>Train rebuild team on extracted logic</li>
<li>**GO/NO-GO decision:** Ready to rebuild?</li>
</ul>

<p>---</p>

<h2>Templates & Resources</h2>

<p><strong>Full plan includes:</strong></p>
<ul>
<li>Validation Rule Documentation Template (detailed)</li>
<li>Workflow Documentation Template (with Mermaid)</li>
<li>Business Rules Catalog Template (CSV)</li>
<li>Hardcoded Logic Inventory Template</li>
<li>Extraction Completeness Checklist (50+ items)</li>
<li>Edge Cases Documentation Template</li>
</ul>

<p><strong>See:</strong> <code>BUSINESS_LOGIC_EXTRACTION_PLAN.md</code> for full details</p>

<p>---</p>

<h2>Contact</h2>

<p><strong>Questions about extraction plan?</strong></p>
<ul>
<li>Read full plan first (33 pages, comprehensive)</li>
<li>Check templates for guidance</li>
<li>Escalate ambiguous business logic to domain experts</li>
</ul>

<p><strong>Daily standup:</strong></p>
<ul>
<li>What did you extract yesterday?</li>
<li>What are you extracting today?</li>
<li>Any blockers? (ambiguous logic, missing docs, etc.)</li>
</ul>

<p>---</p>

<p><strong>Status:</strong> ✅ PLAN COMPLETE - READY TO EXECUTE</p>
<p><strong>Next Action:</strong> Begin Day 1 - Validation Rules Extraction</p>
<p><strong>Owner:</strong> Business Logic Extraction Specialist</p>
<p><strong>Date:</strong> 2025-10-02</p>

  </div>
</body>
</html>