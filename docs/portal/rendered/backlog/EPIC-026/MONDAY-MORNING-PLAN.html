<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EPIC-026: What to Actually Do Monday Morning</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>id: EPIC-026-MONDAY-MORNING-PLAN</p>
<p>epic: EPIC-026</p>
<p>created: 2025-10-03</p>
<p>owner: solo-developer</p>
<p>status: action-plan</p>
<p>type: pragmatic-next-steps</p>
<p>---</p>

<h1>EPIC-026: What to Actually Do Monday Morning</h1>

<p><strong>TL;DR:</strong> Forget the 22-week plan. Fix tests today, create smoke tests this week, keep shipping features.</p>

<p>---</p>

<h2>REALITY CHECK SUMMARY</h2>

<p><strong>Previous plans assumed:</strong> Team of 5-10, enterprise software, production environment, €100k budget</p>
<p><strong>Actual reality:</strong> Solo developer, personal tool, dev environment, self-managed</p>

<p><strong>Previous recommendation:</strong> 22 weeks (5 weeks tests + 3 weeks design + 9 weeks extraction + 2 weeks validation)</p>
<p><strong>Revised recommendation:</strong> 1 week unblock + incremental improvements</p>

<p>---</p>

<h2>THE ACTUAL PROBLEM (Right Now)</h2>

<pre><code>TESTS ARE BROKEN: ModuleNotFoundError: No module named 'fixtures'
└─ Impact: Cannot run ANY tests
└─ Risk: Flying blind on all changes
└─ Priority: P0 - FIX TODAY</code></pre>

<p><strong>Everything else is secondary until this is fixed.</strong></p>

<p>---</p>

<h2>MONDAY MORNING CHECKLIST</h2>

<h3>08:00-10:00: UNBLOCK TESTS (P0)</h3>

<pre><code>cd /Users/chrislehnen/Projecten/Definitie-app

# 1. Find what broke
git log --diff-filter=D --oneline -- tests/fixtures/
git log --oneline -- tests/conftest.py | head -5

# 2. Quick diagnosis
ls tests/fixtures/  # Does directory exist?
grep "from fixtures" tests/conftest.py  # What's imported?

# 3. Quick fix options:
#    A. Restore deleted fixtures: git checkout &lt;commit&gt; -- tests/fixtures/
#    B. Comment out fixture imports in conftest.py temporarily
#    C. Update imports to point to new location

# 4. Verify SOMETHING works
pytest tests/services/test_definitie_repository.py -v  # 22 tests, should pass
pytest tests/unit/ -k "not fixture" -v  # Skip fixture-dependent tests

# Goal: Get 50+ tests passing by 10:00</code></pre>

<h3>10:00-12:00: CREATE SAFETY NET (P0)</h3>

<pre><code># Create tests/smoke/test_critical_paths.py
mkdir -p tests/smoke</code></pre>

<pre><code># tests/smoke/test_critical_paths.py
"""
Smoke tests: Do critical paths work?
Run time: &lt;30 seconds
Coverage: 80% of user-facing bugs
No mocks, no fixtures, just: does it crash?
"""

import pytest

def test_imports_work():
    """Can we import main modules without crashing?"""
    import src.main
    import src.services.container
    import src.ui.tabbed_interface
    import src.database.definitie_repository
    assert True  # If we got here, imports work

def test_service_container_initializes():
    """Can we create the service container?"""
    from src.services.container import ServiceContainer
    container = ServiceContainer()
    assert container is not None

def test_database_connection():
    """Can we connect to the database?"""
    from src.database.definitie_repository import DefinitieRepository
    repo = DefinitieRepository()
    # Try a simple read
    result = repo.get_all_definities()
    assert result is not None

# TODO: Add 7 more tests:
# - Generate definition (happy path)
# - Validate definition (passes rules)
# - Save definition
# - Load definition
# - Export to YAML
# - Upload document
# - Category determination

# Run: pytest tests/smoke/ -v
# Goal: All pass in &lt;30 seconds</code></pre>

<h3>13:00-15:00: NAVIGATION AIDS (P1)</h3>

<pre><code># Edit src/ui/tabbed_interface.py
# Add section markers for navigation:

# ============================================================
# REGION: TAB ORCHESTRATION (Top of file)
# ============================================================
# Purpose: Manages tab switching, state initialization
# Key methods: __init__, render

# ============================================================
# REGION: GENERATION ORCHESTRATION (Lines ~200-600)
# ============================================================
# Purpose: Core definition generation flow
# Key method: _handle_definition_generation (380 LOC)
# Flow: Context → Category → Document → Generate → Store

# ============================================================
# REGION: REGENERATION ORCHESTRATION (Lines ~600-1100)
# ============================================================
# Purpose: Handles category changes → regeneration
# Key methods: _handle_regeneration, _compare_definitions
# Note: 500 LOC hidden orchestrator (candidate for extraction)

# ============================================================
# REGION: STATE MANAGEMENT (Lines ~1100-1400)
# ============================================================
# Purpose: Session state wrappers
# Note: Heavy SessionStateManager coupling (50+ calls)

# ============================================================
# REGION: UTILITIES (Bottom of file)
# ============================================================
# Purpose: Helper methods
# Note: Some may be extractable to utils/</code></pre>

<h3>15:00-17:00: DOCUMENT & REFLECT (P1)</h3>

<pre><code># Create docs/backlog/EPIC-026/CURRENT-STATE.md

## Current Architecture (As-Is)

**Main entry:** src/main.py
**UI orchestration:** src/ui/tabbed_interface.py (1793 LOC)
**Database:** src/database/definitie_repository.py (1815 LOC - well-structured)
**Services:** src/services/* (89 files)

## Pain Points

1. ✅ Tests broken → FIXED (pytest runs)
2. ✅ No smoke tests → CREATED (10 critical paths)
3. ⚠️ God objects hard to navigate → ADDED REGIONS
4. ⚠️ No confidence in changes → SMOKE TESTS HELP

## What's Actually Painful (Solo Dev)

- **Finding code in 1793 LOC file:** 5-10 minutes → Need better navigation
- **Fear of breaking things:** Every change = manual testing → Smoke tests help
- **Regeneration logic buried:** 500 LOC in UI → Extract if touched again
- **Category patterns hardcoded:** 3 places → Extract to config if changed 2x

## What's NOT Actually Painful

- **File is large:** Annoying but not blocking (solo = no merge conflicts)
- **No DI pattern:** Would be nice but not urgent (tests work without it)
- **Some hardcoded values:** If rarely changed, fine for now
- **Manual testing:** For rarely-used features, acceptable

## Next Week Plan

**If working on regeneration:** Extract to src/ui/handlers/regeneration.py
**If changing categories:** Move patterns to config/category_patterns.yaml
**If debugging document upload:** Extract to src/ui/handlers/documents.py
**Otherwise:** Keep shipping features, revisit next month

## Metrics That Matter (Solo)

- ✅ Time to find code: &lt;1 minute (regions help)
- ✅ Confidence: 80%+ (smoke tests help)
- ✅ Tests run: YES (fixed!)
- ⚠️ Manual testing: Still 10+ min (reduce incrementally)</code></pre>

<p>---</p>

<h2>TUESDAY-FRIDAY: BACK TO FEATURES</h2>

<p><strong>Rule #1:</strong> Run smoke tests before every commit</p>
<pre><code>pytest tests/smoke/ -v  # Should take &lt;30 seconds</code></pre>

<p><strong>Rule #2:</strong> If touching god object, extract ONE thing</p>
<pre><code># Example: Working on regeneration logic
# Before: 500 LOC in tabbed_interface.py (hard to find)

# After: Create src/ui/handlers/regeneration.py
def handle_regeneration(begrip, old_category, new_category):
    """Handle category change → regeneration flow."""
    # Extract 500 LOC here
    pass

# Add smoke test
def test_regeneration_happy_path():
    result = handle_regeneration("test", "CAT1", "CAT2")
    assert result is not None

# Time: 2-3 hours
# Benefit: Never lose this code again</code></pre>

<p><strong>Rule #3:</strong> If debugging >2 hours, document for next week</p>
<pre><code># Add to CURRENT-STATE.md:
## Pain Point: Document upload failing on PDF
- Spent 3 hours debugging
- Problem in tabbed_interface.py lines 800-950
- Candidate for extraction next week</code></pre>

<p>---</p>

<h2>NEXT 4-8 WEEKS: INCREMENTAL IMPROVEMENT</h2>

<h3>What to Extract (When Encountered)</h3>

<p><strong>Extract if:</strong></p>
<ul>
<li>✅ Can't find code in <1 minute</li>
<li>✅ Debugging same area >2 hours</li>
<li>✅ Changing hardcoded value 2nd time</li>
<li>✅ Code >100 LOC in single function</li>
</ul>

<p><strong>Don't extract if:</strong></p>
<ul>
<li>❌ Code is clear and working</li>
<li>❌ Rarely touched</li>
<li>❌ Would take >4 hours to extract</li>
<li>❌ No tests to validate</li>
</ul>

<h3>Extraction Pattern (Simple)</h3>

<pre><code># 1. Create new file (not service, just handler)
touch src/ui/handlers/&lt;feature&gt;.py

# 2. Move code (copy-paste is fine)
# 3. Add smoke test
# 4. Verify smoke test passes
# 5. Remove old code
# 6. Verify smoke tests still pass

# Time: 2-3 hours per extraction
# Do: 1-2 per week (as encountered)</code></pre>

<p>---</p>

<h2>WHAT NOT TO DO (Avoid Enterprise Theater)</h2>

<h3>❌ DON'T: 5-Week Test Recovery Plan</h3>

<p><strong>They said:</strong> Write 435 tests (85% coverage) before ANY refactoring</p>
<p><strong>Reality:</strong> 10 smoke tests give 80% confidence in 1 day</p>
<p><strong>Solo dev:</strong> Diminishing returns after 20-30 tests</p>

<h3>❌ DON'T: 9-Week Orchestrator Extraction</h3>

<p><strong>They said:</strong> Extract hidden orchestrators with DI, service layers</p>
<p><strong>Reality:</strong> Move to separate file, add smoke test, done in 3 hours</p>
<p><strong>Solo dev:</strong> YAGNI (You Ain't Gonna Need orchestrators)</p>

<h3>❌ DON'T: Stop Features for Architecture</h3>

<p><strong>They said:</strong> 22 weeks to fix god objects properly</p>
<p><strong>Reality:</strong> Extract pain points incrementally (ongoing)</p>
<p><strong>Solo dev:</strong> Velocity matters more than perfect architecture</p>

<h3>❌ DON'T: Aim for 85% Test Coverage</h3>

<p><strong>They said:</strong> Need comprehensive tests before refactoring</p>
<p><strong>Reality:</strong> Smoke tests + targeted tests for extracted code</p>
<p><strong>Solo dev:</strong> 20-30 well-chosen tests > 435 comprehensive tests</p>

<p>---</p>

<h2>WHAT TO DO (Pragmatic Solo Dev)</h2>

<h3>✅ DO: Fix Tests Today</h3>

<p><strong>Why:</strong> Unblocks everything</p>
<p><strong>How:</strong> 2-4 hours diagnosis + fix</p>
<p><strong>ROI:</strong> ∞ (can validate changes again)</p>

<h3>✅ DO: Create Smoke Tests This Week</h3>

<p><strong>Why:</strong> Safety net for changes</p>
<p><strong>How:</strong> 10 tests, <30 sec run time</p>
<p><strong>ROI:</strong> 10x (catches 80% of bugs)</p>

<h3>✅ DO: Add Navigation Aids</h3>

<p><strong>Why:</strong> Find code faster</p>
<p><strong>How:</strong> Code regions, section comments</p>
<p><strong>ROI:</strong> 5x (daily time savings)</p>

<h3>✅ DO: Extract Pain Points Incrementally</h3>

<p><strong>Why:</strong> Reduce frustration over time</p>
<p><strong>How:</strong> 1 extraction per week (when encountered)</p>
<p><strong>ROI:</strong> 3x (less debugging, easier to find)</p>

<h3>✅ DO: Keep Shipping Features</h3>

<p><strong>Why:</strong> Velocity matters for solo dev</p>
<p><strong>How:</strong> Don't block features for architecture</p>
<p><strong>ROI:</strong> Massive (build useful tool, not perfect code)</p>

<p>---</p>

<h2>SUCCESS METRICS (Solo Dev Reality)</h2>

<h3>Forget These (Team Metrics)</h3>

<ul>
<li>❌ 85% test coverage (overkill solo)</li>
<li>❌ Zero god objects (no parallel dev problems)</li>
<li>❌ Perfect DI patterns (YAGNI)</li>
<li>❌ Zero hardcoded values (fix when changed 2x)</li>
</ul>

<h3>Track These (Solo Productivity)</h3>

<ul>
<li>✅ **Tests run:** YES/NO (must be YES)</li>
<li>✅ **Smoke tests pass:** YES/NO (must be YES)</li>
<li>✅ **Time to find code:** <1 minute (navigation aids)</li>
<li>✅ **Confidence in changes:** 80%+ (smoke tests)</li>
<li>✅ **Features shipped:** Ongoing (don't block)</li>
</ul>

<p>---</p>

<h2>DECISION TREE (This Week)</h2>

<pre><code>START HERE
│
├─ Are tests broken?
│  ├─ YES → FIX TODAY (P0, 2-4 hours)
│  └─ NO → Continue
│
├─ Do you have smoke tests?
│  ├─ NO → CREATE THIS WEEK (P0, 1 day)
│  └─ YES → Continue
│
├─ Can you find code in &lt;1 minute?
│  ├─ NO → ADD NAVIGATION AIDS (P1, 2 hours)
│  └─ YES → Continue
│
├─ Working on regeneration/categories/documents?
│  ├─ YES → EXTRACT WHILE YOU'RE THERE (P1, 2-3 hours)
│  └─ NO → Continue
│
└─ SHIP FEATURES (Ongoing, don't block for architecture)</code></pre>

<p>---</p>

<h2>WEEKLY CHECKLIST (Next 8 Weeks)</h2>

<h3>Week 1: UNBLOCK</h3>
<ul>
<li>[x] Fix tests (pytest runs)</li>
<li>[x] Create 10 smoke tests</li>
<li>[x] Add navigation aids</li>
<li>[x] Document current state</li>
</ul>

<h3>Week 2-4: EXTRACT OPPORTUNISTICALLY</h3>
<ul>
<li>[ ] Extract 1 pain point (if encountered)</li>
<li>[ ] Add smoke test for extracted code</li>
<li>[ ] Expand smoke tests to 15</li>
<li>[ ] Ship features (ongoing)</li>
</ul>

<h3>Week 5-8: STRATEGIC CLEANUP</h3>
<ul>
<li>[ ] Review: Are god objects still painful?</li>
<li>[ ] Extract 2-3 more pain points</li>
<li>[ ] Move hardcoded patterns to config (if changed)</li>
<li>[ ] Expand smoke tests to 20</li>
</ul>

<p>---</p>

<h2>THE BOTTOM LINE</h2>

<p><strong>Forget:</strong> 22-week program, €100k effort, 435 tests, orchestrators, DI patterns</p>
<p><strong>Remember:</strong> Fix tests today, smoke tests this week, extract incrementally, keep shipping</p>

<p><strong>Time investment:</strong> 1 week unblock + ongoing incremental</p>
<p><strong>Feature blocking:</strong> None (work continues)</p>
<p><strong>ROI:</strong> Massive (velocity maintained, debt managed)</p>

<p>---</p>

<h2>IMMEDIATE NEXT STEPS</h2>

<ol>
<li>**TODAY:** Fix tests (2-4 hours) → pytest runs</li>
<li>**THIS WEEK:** Smoke tests (1 day) → 80% confidence</li>
<li>**NEXT 2 WEEKS:** Extract 1 pain point (when encountered) → less frustration</li>
<li>**ONGOING:** Keep shipping features → velocity matters</li>
</ol>

<p><strong>Status:</strong> Ready to execute</p>
<p><strong>Urgency:</strong> HIGH (tests blocking)</p>
<p><strong>Effort:</strong> Low (doesn't block features)</p>
<p><strong>ROI:</strong> Massive (unblock + safety net + better code)</p>

<p>---</p>

<p><strong>Prepared by:</strong> BMad Orchestrator (Reality Check Mode)</p>
<p><strong>Date:</strong> 2025-10-03</p>
<p><strong>Context:</strong> Solo developer, pragmatic approach, feature velocity matters</p>
<p><strong>Key Message:</strong> Fix tests, add smoke tests, keep shipping. Everything else is incremental.</p>

  </div>
</body>
</html>