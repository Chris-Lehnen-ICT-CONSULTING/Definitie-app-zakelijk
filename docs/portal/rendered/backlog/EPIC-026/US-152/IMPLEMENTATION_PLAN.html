<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Implementation Plan: FeedbackBuilder Refactoring</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">‚Üê Terug naar Portal</a>
    <h1>Implementation Plan: FeedbackBuilder Refactoring</h1>
<h2>US-062: Refactor FeedbackBuilder naar moderne service</h2>

<p>---</p>

<h2>üìã Executive Summary</h2>
<p>Refactor de FeedbackBuilder logica uit <code>src/orchestration/definitie_agent.py</code> naar een moderne, testbare <code>FeedbackServiceV2</code> die technische validation output vertaalt naar menselijke feedback.</p>

<p><strong>‚ö†Ô∏è KRITIEKE DEPENDENCY:</strong> US-064 (Edit Interface) moet EERST ge√Ømplementeerd worden voor volledige waarde</p>

<p><strong>Geschatte effort:</strong> 8 story points  </p>
<p><strong>Geschatte duur:</strong> 2-3 dagen  </p>
<p><strong>Risk level:</strong> HIGH (beperkte waarde zonder edit functionaliteit)  </p>
<p><strong>Value:</strong> MEDIUM nu, HIGH na US-064 implementatie</p>

<h3>üéØ Het Kernprobleem</h3>
<p><strong>Huidige situatie:</strong> </p>
<ol>
<li>Gebruikers krijgen onbegrijpelijke technische validatie output</li>
<li>**EN kunnen er NIETS mee doen** (geen edit mogelijkheid)</li>
</ol>

<pre><code>‚ùå VER-03: specifieke data of tijdstippen gevonden: 
- Ontologische categorie: soort, Gegevens die kenmerken...</code></pre>

<p><strong>Gewenste situatie (vereist US-064):</strong> </p>
<ol>
<li>Gebruikers krijgen concrete instructies</li>
<li>**EN kunnen deze direct toepassen** via edit interface</li>
</ol>

<pre><code>‚ùå "Vervang '1 januari 2024' door 'datum van inwerkingtreding'"
[Edit Knop] ‚Üí User past aan ‚Üí Nieuwe validatie ‚Üí Betere feedback</code></pre>

<h3>üí° Gefaseerde Aanpak (NIEUW)</h3>
<p><strong>Fase 1:</strong> Implementeer US-064 (Edit Interface) - <strong>8 story points</strong></p>
<p><strong>Fase 2:</strong> Implementeer US-062 (FeedbackBuilder) - <strong>8 story points</strong></p>
<p><strong>Totaal:</strong> 16 story points voor complete oplossing</p>

<h3>‚ö†Ô∏è Waarschuwing conform CLAUDE.md</h3>
<p>Volgens "Doe wat gevraagd is; niets meer, niets minder" principe:</p>
<ul>
<li>FeedbackBuilder heeft BEPERKTE waarde zonder edit mogelijkheid</li>
<li>Overweeg om eerst US-064 te prioriteren</li>
<li>Of implementeer alleen minimale feedback mappings (2 story points)</li>
</ul>

<p>---</p>

<h2>üéØ Doelstellingen</h2>

<ol>
<li>**Extract** FeedbackBuilder logica uit legacy code</li>
<li>**Moderniseer** naar V2 service patterns</li>
<li>**Behoud** alle business intelligence en algoritmes</li>
<li>**Verbeter** testbaarheid en onderhoudbaarheid</li>
<li>**Integreer** als aanvulling op bestaande validation services</li>
<li>**Vertaal** technische violations naar menselijke feedback</li>
<li>**Voorbereid** voor toekomstige edit/import features</li>
</ol>

<p>---</p>

<h2>üöÄ Use Cases & Werkelijke Waarde Analyse</h2>

<h3>Use Case 1: Feedback tijdens Generatie (BEPERKTE WAARDE ‚ö†Ô∏è)</h3>
<p><strong>Scenario:</strong> Gebruiker genereert definitie ‚Üí Validatie faalt ‚Üí Krijgt betere errors  </p>
<p><strong>Realiteit:</strong> Gebruiker kan alleen opnieuw genereren, niet echt verbeteren</p>
<p><strong>Werkelijke waarde:</strong> LAAG - Alleen informatief, niet actionable</p>
<p><strong>Vereist:</strong> Geen dependencies</p>

<h3>Use Case 2: Iteratieve Definitie Verbetering (HOOFDWAARDE ‚úÖ)</h3>
<p><strong>Scenario:</strong> Genereer ‚Üí Edit ‚Üí Valideer ‚Üí Feedback ‚Üí Verbeter ‚Üí Repeat</p>
<p><strong>Realiteit:</strong> WERKT NIET zonder US-064 (Edit Interface)</p>
<p><strong>Werkelijke waarde:</strong> HOOG - Dit is waar FeedbackBuilder voor bedoeld is</p>
<p><strong>Vereist:</strong> US-064 MOET eerst ge√Ømplementeerd zijn</p>

<h3>Use Case 3: Externe Definitie Validatie (TOEKOMSTIG)</h3>
<p><strong>Scenario:</strong> Import definitie uit Word/Excel ‚Üí Valideer ‚Üí Feedback</p>
<p><strong>Realiteit:</strong> Import functionaliteit bestaat nog niet (US-027)</p>
<p><strong>Werkelijke waarde:</strong> MEDIUM - Nuttig voor migraties</p>
<p><strong>Vereist:</strong> US-027 (Import) + US-064 (Edit)</p>

<h3>Use Case 4: Bulk Import Kwaliteitsrapport (TOEKOMSTIG)</h3>
<p><strong>Scenario:</strong> Import 100+ definities ‚Üí Batch validatie ‚Üí Feedback rapport</p>
<p><strong>Realiteit:</strong> Bulk import bestaat nog niet (US-062 in EPIC-005)</p>
<p><strong>Werkelijke waarde:</strong> LAAG - Nice to have</p>
<p><strong>Vereist:</strong> US-062 (Bulk Import) + US-027 (Import)</p>

<h3>üìä Realistische Waarde Assessment</h3>
<p>| Use Case | Zonder US-064 | Met US-064 | Prioriteit |</p>
<p>|----------|---------------|------------|------------|</p>
<p>| Generatie Feedback | 20% waarde | 30% waarde | LOW |</p>
<p>| Iteratieve Verbetering | 0% waarde | 90% waarde | CRITICAL |</p>
<p>| Import Validatie | 0% waarde | 70% waarde | MEDIUM |</p>
<p>| Bulk Import | 0% waarde | 40% waarde | LOW |</p>

<p>---</p>

<h2>üîÑ Integratie Architectuur</h2>

<h3>Geen Duplicatie - Pure Aanvulling</h3>
<pre><code>User Input
    ‚Üì
ValidationService (BESTAAND - blijft intact)
    ‚îú‚îÄ Detecteert violations
    ‚îú‚îÄ Berekent scores
    ‚îî‚îÄ Match patterns
         ‚Üì
    [Technische Output]
         ‚Üì
FeedbackServiceV2 (NIEUW - vertaallaag)
    ‚îú‚îÄ Vertaalt violations ‚Üí menselijke taal
    ‚îú‚îÄ Prioriteert feedback items
    ‚îî‚îÄ Genereert contextual suggesties
         ‚Üì
    [Menselijke Feedback]
         ‚Üì
UI Display (beide outputs beschikbaar)</code></pre>

<h3>Integratie Opties</h3>

<h4>Optie A: Decorator Pattern (algemeen)</h4>
<pre><code>class ValidationOrchestratorV2:
    def validate_definition(self, definition: str) -&gt; ValidationResult:
        # Bestaande validatie logic blijft intact
        result = self.validation_service.validate(definition)
        
        # NIEUW: Optionele feedback toevoeging
        if self.feedback_service and self.include_feedback:
            result.human_feedback = self.feedback_service.generate_feedback(
                violations=result.violations,
                context=FeedbackContext(
                    iteration=self.current_iteration,
                    previous_score=self.previous_score,
                    current_score=result.overall_score
                )
            )
        
        return result</code></pre>

<p><strong>Voordelen:</strong></p>
<ul>
<li>Backwards compatible</li>
<li>Feedback is opt-in</li>
<li>Single result object</li>
<li>Clean separation of concerns</li>
</ul>

<h4>Optie A.1: Decorator in DefinitionOrchestratorV2 (AANBEVOLEN ‚≠ê)</h4>
<pre><code># Schematisch, async V2 voorbeeld (post-validatie)
class DefinitionOrchestratorV2:
    async def create_definition(self, request, context=None):
        # ... PHASE 5: Cleaning
        # ... PHASE 6: Validation
        validation_result = await self.validation_service.validate_text(
            begrip=request.begrip,
            text=cleaned_text,
            ontologische_categorie=request.ontologische_categorie,
            context=validation_context,
        )

        # NIEUW: feedbackverrijking na validatie (opt-in via bestaande FeatureFlagManager)
        from services.feature_flags import FeatureFlag
        if self.feature_flags.is_enabled(FeatureFlag.AI_SUGGESTIONS) and self.feedback_engine:
            suggestions = await self.feedback_engine.process_validation_feedback(
                definition_id=generation_id,
                validation_result=validation_result,
                original_request=request,
            )
            validation_result["improvement_suggestions"] = suggestions

        # ... PHASE 8..11 blijven ongewijzigd
        return definition_response</code></pre>

<p><strong>Voordelen extra:</strong></p>
<ul>
<li>Validator blijft dun (geen businesslogica)</li>
<li>Sluit aan op bestaand `improvement_suggestions` veld</li>
<li>Eenvoudige feature‚Äëflagged rollout</li>
</ul>

<h4>Optie B: Pipeline Pattern</h4>
<pre><code># In UI layer
validation_result = orchestrator.validate(definition)
feedback = feedback_service.process(validation_result)
display_results(validation_result, feedback)</code></pre>

<p><strong>Voordelen:</strong></p>
<ul>
<li>Volledig ontkoppeld</li>
<li>UI beslist over gebruik</li>
<li>Flexibele compositie</li>
</ul>

<h4>Optie C: Observer Pattern</h4>
<pre><code>class FeedbackObserver:
    def on_validation_complete(self, result: ValidationResult):
        feedback = self.generate_feedback(result)
        self.publish_feedback(feedback)</code></pre>

<p><strong>Voordelen:</strong></p>
<ul>
<li>Event-driven</li>
<li>Loose coupling</li>
<li>Async mogelijk</li>
</ul>

<p>---</p>

<h2>üìê Architectuur Design</h2>

<h3>Service Structuur</h3>
<pre><code>src/services/feedback/
‚îú‚îÄ‚îÄ feedback_service_v2.py         # Hoofdservice
‚îú‚îÄ‚îÄ feedback_builder.py            # Builder logica
‚îú‚îÄ‚îÄ feedback_prioritizer.py        # Prioritering algoritmes
‚îú‚îÄ‚îÄ feedback_history.py            # History management
‚îî‚îÄ‚îÄ __init__.py</code></pre>

<h3>Service Contract</h3>
<pre><code>@dataclass
class FeedbackItem:
    type: Literal["critical", "suggestion", "improvement"]
    message: str
    violation_code: str | None
    priority: int
    iteration_aware: bool = False

@dataclass
class FeedbackContext:
    iteration: int
    previous_score: float
    current_score: float
    violations: list[RuleViolation]
    history: list[FeedbackItem]

class FeedbackServiceV2:
    def generate_feedback(
        self,
        context: FeedbackContext,
        max_items: int = 5
    ) -&gt; list[FeedbackItem]:
        """Genereer intelligente, geprioriteerde feedback"""
        
    def detect_stagnation(
        self,
        scores: list[float],
        threshold: float = 0.05
    ) -&gt; bool:
        """Detecteer of verbetering stagneert"""
        
    def suggest_alternative_approach(
        self,
        iteration: int,
        violation_pattern: str
    ) -&gt; str:
        """Genereer alternatieve suggesties per iteratie"""</code></pre>

<p>Output mapping naar V2 contract (ValidationResult):</p>
<pre><code># Improvement suggestions conform V2 schema (TypedDict in services/validation/interfaces.py)
@dataclass
class ImprovementSuggestion:
    type: Literal["rewrite", "addition", "removal", "restructure"]
    description: str
    example: str | None = None
    impact: Literal["low", "medium", "high"] | None = None

# FeedbackServiceV2 levert List[ImprovementSuggestion] die wordt geplaatst in
# validation_result["improvement_suggestions"]</code></pre>

<p>---</p>

<h2>üîß Implementatie Opties</h2>

<h3>Optie A: Volledige Implementatie (NIET AANBEVOLEN ‚ùå)</h3>
<p><strong>Wanneer:</strong> Alleen als US-064 al in development is</p>
<p><strong>Effort:</strong> 8 story points</p>
<p><strong>Stappen:</strong> Alle phases zoals hieronder beschreven</p>

<h3>Optie B: Minimale Implementatie (OVERWEGEN ‚ö†Ô∏è)</h3>
<p><strong>Wanneer:</strong> Als quick win gewenst zonder US-064</p>
<p><strong>Effort:</strong> 2 story points</p>
<p><strong>Stappen:</strong> </p>
<ul>
<li>Alleen violation-to-feedback mappings (45 regels)</li>
<li>Simpele vertaalservice zonder iteratie logica</li>
<li>Geen history, geen stagnatie detectie</li>
</ul>

<h3>Optie C: Prioriteit Verschuiving (AANBEVOLEN ‚úÖ)</h3>
<p><strong>Wanneer:</strong> Voor maximale waarde</p>
<p><strong>Effort:</strong> 16 story points totaal</p>
<p><strong>Stappen:</strong></p>
<ol>
<li>**EERST:** Implementeer US-064 (Edit Interface) - 8 points</li>
<li>**DAN:** Implementeer US-062 (FeedbackBuilder) - 8 points</li>
</ol>

<p>---</p>

<h2>üìÖ Gefaseerde Implementatie Plan</h2>

<h3>FASE 1: US-064 Implementation (Week 1-2)</h3>
<p><strong>Doel:</strong> Edit mogelijkheid cre√´ren</p>
<ul>
<li>[ ] Plain text editor implementeren</li>
<li>[ ] Definitie opslaan/laden functionaliteit</li>
<li>[ ] Handmatige validatie-knop met cooldown (‚â•2s)</li>
<li>[ ] Version history basis</li>
<li>[ ] UI navigatie naar edit mode</li>
</ul>

<h3>FASE 2: US-062 Basis (Week 3 - Dag 1)</h3>
<p><strong>Doel:</strong> Feedback mappings zonder complexiteit</p>
<ul>
<li>[ ] Cre√´er FeedbackServiceV2 skeleton</li>
<li>[ ] Implementeer 45 violation-to-feedback mappings</li>
<li>[ ] Simpele prioritering (Critical ‚Üí High ‚Üí Medium ‚Üí Low)</li>
<li>[ ] Integreer met DefinitionOrchestratorV2 (post‚Äëvalidatie hook)</li>
</ul>

<h3>FASE 3: US-062 Advanced (Week 3 - Dag 2-3)</h3>
<p><strong>Doel:</strong> Intelligente features toevoegen</p>
<ul>
<li>[ ] Iteratie-aware feedback (1/2/3 verschillende strategie√´n)</li>
<li>[ ] Stagnatie detectie implementeren</li>
<li>[ ] History management (FIFO, max 10)</li>
<li>[ ] Contextual suggestions voor edit mode</li>
</ul>

<h3>FASE 4: Integratie & Testing (Week 4)</h3>
<p><strong>Doel:</strong> Alles samenvoegen en valideren</p>
<ul>
<li>[ ] Edit + Feedback loop testen</li>
<li>[ ] Performance optimalisatie</li>
<li>[ ] A/B testing tegen legacy</li>
<li>[ ] Gebruikersacceptatie tests</li>
</ul>

<blockquote>Future (buiten scope van US‚Äë062/US‚Äë064, voor juiste stories/epics):</blockquote>
<blockquote>- Single Import flow ‚Üí US‚Äë027 (Import)</blockquote>
<blockquote>- Bulk Import rapportage ‚Üí EPIC‚Äë005/US‚Äë062 (Bulk Import)</blockquote>

<p>---</p>

<h2>üß™ Test Strategie</h2>

<h3>Unit Tests</h3>
<pre><code>tests/services/feedback/
‚îú‚îÄ‚îÄ test_feedback_service_v2.py
‚îú‚îÄ‚îÄ test_feedback_builder.py
‚îú‚îÄ‚îÄ test_feedback_prioritizer.py
‚îî‚îÄ‚îÄ test_feedback_history.py</code></pre>

<h3>Test Coverage Targets</h3>
<ul>
<li>FeedbackServiceV2: 80%+ (MVP), opschalen naar 90‚Äì95% in Advanced fase</li>
<li>Business logic: 100%</li>
<li>Edge cases: Stagnatie, regressie, max iteraties</li>
</ul>

<h3>Kritieke Test Scenarios</h3>
<ol>
<li>**Prioritering:** Kritiek > Suggesties > Overig</li>
<li>**Max Items:** Nooit meer dan 5 feedback items</li>
<li>**Stagnatie:** Detectie bij <0.05 verbetering</li>
<li>**Iteratie Aware:** Verschillende feedback per iteratie</li>
<li>**Legacy parity:** Nieuwe output matcht legacy via adapter op vaste fixtures</li>
<li>**Bulk export:** CSV/Excel inhoud en aggregaties kloppen en zijn deterministisch</li>
<li>**History:** FIFO met max 10 items</li>
</ol>

<p>---</p>

<h2>üìä Business Rules Mapping</h2>

<h3>Gedocumenteerde Violation-to-Feedback Mappings (11 uit legacy code)</h3>
<p>| Violation | Technische Output | FeedbackBuilder Output | Priority |</p>
<p>|-----------|------------------|------------------------|----------|</p>
<p>| CON-01 | "Context niet expliciet" | "Maak de juridische context expliciet, bijvoorbeeld: 'in het kader van...'" | HIGH |</p>
<p>| CON-02 | "Geen bronnen gevonden" | "Voeg juridische bronnen toe zoals wetsartikelen (bijv. 'conform artikel 7:1 BW')" | HIGH |</p>
<p>| ESS-01 | "Pattern 'wordt gebruikt voor'" | "Beschrijf WAT het begrip is, niet waarvoor het gebruikt wordt" | CRITICAL |</p>
<p>| ESS-02 | "Type niet gespecificeerd" | "Specificeer of dit een proces, resultaat of entiteit betreft" | CRITICAL |</p>
<p>| ESS-03 | "Geen unieke kenmerken" | "Voeg onderscheidende kenmerken toe die dit begrip uniek maken" | HIGH |</p>
<p>| ESS-04 | "Geen meetbare criteria" | "Gebruik objectief meetbare criteria zoals termijnen, bedragen of aantallen" | MEDIUM |</p>
<p>| ESS-05 | "Geen onderscheid" | "Benadruk wat dit begrip onderscheidt van vergelijkbare begrippen" | MEDIUM |</p>
<p>| INT-01 | "Meerdere zinnen" | "Formuleer als √©√©n samenhangende zin zonder opsommingen" | HIGH |</p>
<p>| INT-03 | "Vage verwijzing 'deze'" | "Vervang 'deze' door het specifieke begrip waar je naar verwijst" | MEDIUM |</p>
<p>| STR-01 | "Begint niet met naamwoord" | "Begin je definitie met het kernbegrip, bijvoorbeeld: 'Een [begrip] is...'" | HIGH |</p>
<p>| STR-02 | "Vage terminologie" | "Gebruik concrete, juridisch specifieke terminologie" | HIGH |</p>

<h3>Contextual Feedback Examples</h3>
<p>| Situatie | Standaard Feedback | Contextual Enhancement |</p>
<p>|----------|-------------------|------------------------|</p>
<p>| Iteratie 1 | "Vermijd vage termen" | "Vervang 'mogelijk' door 'kan' of 'mag'" |</p>
<p>| Iteratie 2 | "Nog steeds vage termen" | "Probeer: 'is bevoegd tot' i.p.v. 'mogelijk'" |</p>
<p>| Iteratie 3 | "Vage termen persistent" | "Overweeg complete herformulering zonder modaliteiten" |</p>
<p>| Stagnatie | "Score verbetert niet" | "Focus op √©√©n aspect tegelijk, begin met structuur" |</p>

<h3>Iteratie Strategie√´n</h3>
<p>| Iteratie | Feedback Stijl | Voorbeeld |</p>
<p>|----------|---------------|----------|</p>
<p>| 1 | Direct | "Vermijd deze patronen..." |</p>
<p>| 2 | Alternatief | "Nog steeds aanwezig, probeer..." |</p>
<p>| 3 | Fundamenteel | "Overweeg complete herformulering..." |</p>

<p>---</p>

<h2>‚ö†Ô∏è Risico's & Mitigaties</h2>

<p>| Risico | Impact | Mitigatie |</p>
<p>|--------|--------|-----------|</p>
<p>| Verlies business logica | HIGH | Uitgebreide tests, side-by-side validatie |</p>
<p>| Performance degradatie | MEDIUM | Benchmarks, caching strategie√´n |</p>
<p>| Integration issues | MEDIUM | Gefaseerde rollout, feature flags |</p>
<p>| Regression in feedback kwaliteit | HIGH | A/B testing met legacy |</p>

<p>---</p>

<h2>üîÑ Migration Path</h2>

<h3>Stap 1: Parallel Running</h3>
<pre><code># In DefinitionOrchestratorV2 (post-validatie)
from services.feature_flags import FEEDBACK_SERVICE_V2

validation_result = await self.validation_service.validate_text(...)
if getattr(self.config, "enable_feedback_loop", True) and FEEDBACK_SERVICE_V2 and self.feedback_engine:
    suggestions = await self.feedback_engine.process_validation_feedback(
        definition_id=generation_id,
        validation_result=validation_result,
        original_request=request,
    )
    validation_result["improvement_suggestions"] = suggestions</code></pre>

<h3>Stap 2: Gradual Rollout</h3>
<ul>
<li>Week 1: 10% traffic naar nieuwe service</li>
<li>Week 2: 50% traffic (monitor metrics)</li>
<li>Week 3: 100% traffic</li>
<li>Week 4: Remove legacy code</li>
</ul>

<h3>Stap 3: Legacy Cleanup</h3>
<ul>
<li>Archive `definitie_agent.py` FeedbackBuilder code</li>
<li>Update alle references</li>
<li>Remove feature flags</li>
</ul>

<p>---</p>

<h2>üìà Success Metrics</h2>

<h3>Functioneel</h3>
<ul>
<li>‚úÖ Alle 11 violation mappings werkend</li>
<li>‚úÖ Feedback prioritering identiek aan legacy</li>
<li>‚úÖ Stagnatie detectie accuraat</li>
<li>‚úÖ Iteratie-aware feedback actief</li>
</ul>

<h3>Technisch</h3>
<ul>
<li>‚úÖ Test coverage >95%</li>
<li>‚úÖ Response time <100ms</li>
<li>‚úÖ Memory footprint <50MB</li>
<li>‚úÖ Zero regression in feedback kwaliteit</li>
</ul>

<h3>Business</h3>
<ul>
<li>‚úÖ Definitie acceptatie rate gelijk of beter</li>
<li>‚úÖ Gemiddeld aantal iteraties gelijk of lager</li>
<li>‚úÖ User satisfaction behouden</li>
</ul>

<p>---</p>

<h2>üîó Dependencies</h2>

<h3>Code Dependencies</h3>
<ul>
<li>`src/services/validation/modular_validation_service.py` - Voor violations input</li>
<li>`src/services/orchestrators/validation_orchestrator_v2.py` - Voor validatie orchestratie</li>
<li>`src/services/validation/interfaces.py` - Voor data types (RuleViolation, ValidationResult)</li>
<li>`src/services/container.py` - Voor service registration</li>
</ul>

<h3>Knowledge Dependencies</h3>
<ul>
<li>[BUSINESS_KNOWLEDGE_EXTRACTION.md](../US-061/BUSINESS_KNOWLEDGE_EXTRACTION.md)</li>
<li>Legacy code analyse</li>
<li>V2 architectuur patterns</li>
</ul>

<h3>Feature Dependencies (Toekomstig)</h3>
<p>| Feature | User Story | Status | Impact op FeedbackBuilder |</p>
<p>|---------|------------|--------|---------------------------|</p>
<p>| Definition Edit | US-064 | Open (HIGH) | Enables iterative feedback during editing |</p>
<p>| Import Validation | US-027 | Nog te bepalen | Feedback voor imported definitions |</p>
<p>| Bulk Import | US-062 | Open (HIGH) | Batch feedback + CSV/Excel export + aggregatie |</p>
<p>| Batch Operations | US-028 | Nog te bepalen | Performance optimalisaties nodig |</p>

<h3>Critical Dependency</h3>
<p>‚ö†Ô∏è <strong>US-064 (Definition Edit Interface)</strong> is kritiek voor volledige waarde van FeedbackBuilder:</p>
<ul>
<li>Zonder edit: Feedback alleen informatief</li>
<li>Met edit: Feedback wordt actionable</li>
<li>**Mitigatie:** Design FeedbackService met edit-ready API vanaf begin</li>
</ul>

<p>---</p>

<h2>üìù Documentatie Updates</h2>

<p>Na implementatie updaten:</p>
<ul>
<li>[ ] EPIC-012.md met completion status</li>
<li>[ ] ServiceContainer documentatie</li>
<li>[ ] API documentatie voor FeedbackServiceV2</li>
<li>[ ] Migration guide voor developers</li>
</ul>

<p>---</p>

<h2>üë• Team & Resources</h2>

<p><strong>Lead Developer:</strong> Backend Team  </p>
<p><strong>Code Reviewer:</strong> Senior Architect  </p>
<p><strong>Business Validator:</strong> Product Owner  </p>

<p><strong>Geschatte Timeline:</strong></p>
<ul>
<li>Start: Direct na goedkeuring plan</li>
<li>Design Review: Dag 1, 14:00</li>
<li>Code Complete: Dag 2, 17:00</li>
<li>Testing Complete: Dag 3, 12:00</li>
<li>Production Ready: Dag 3, 17:00</li>
</ul>

<p>---</p>

<h2>‚úÖ Definition of Done</h2>

<ul>
<li>[ ] Alle unit tests groen (>95% coverage)</li>
<li>[ ] Integratie tests passed</li>
<li>[ ] Performance benchmarks acceptable</li>
<li>[ ] Code review approved</li>
<li>[ ] Business rules validated</li>
<li>[ ] Documentation updated</li>
<li>[ ] No regression in functionality</li>
<li>[ ] Legacy code archived (niet verwijderd)</li>
</ul>

<p>---</p>

<h2>üì¶ Bulk Rapportage (Specificatie)</h2>

<h3>Exportformaat</h3>
<ul>
<li>CSV/Excel met kolommen:</li>
<li> - `id`, `bron`, `begrip`, `score`, `is_acceptable`, `violations_count`, `duration_ms`, `top1_feedback`, `top2_feedback`, `top3_feedback`</li>
</ul>

<h3>Aggregaties</h3>
<ul>
<li>Acceptatie‚Äëratio (aantal acceptabel / totaal)</li>
<li>Top 5 meest voorkomende violations (rule_id + count)</li>
<li>Tijdsverdeling: p50/p95 `duration_ms`</li>
</ul>

<h3>Criteria</h3>
<ul>
<li>Deterministisch bij gelijke input</li>
<li>Geen duplicaten in top‚Äë3 per item</li>
<li>Uitvoer < 100ms per item (excl. validatie)</li>
</ul>

<p>---</p>

<h2>üèÅ Conclusie & Beslispunten</h2>

<h3>Realistische Assessment</h3>
<ol>
<li>**Beperkte directe waarde** - Zonder edit (US-064) is feedback alleen informatief</li>
<li>**Hoge dependency** - Hoofdwaarde komt pas met US-064</li>
<li>**Over-engineered risk** - 8 points voor feature die nu beperkt nuttig is</li>
<li>**CLAUDE.md conflict** - "Doe wat gevraagd is" vs bouwen voor toekomst</li>
</ol>

<h3>Aanbevolen Beslissing</h3>

<h4>üéØ **BESTE OPTIE: Prioriteit Verschuiving (Optie C)**</h4>
<p><strong>Waarom:</strong></p>
<ul>
<li>US-064 (Edit) geeft directe waarde aan gebruikers</li>
<li>FeedbackBuilder wordt dan logische follow-up</li>
<li>Totaal 16 points maar met gegarandeerde waarde</li>
<li>Conform CLAUDE.md: geen over-engineering</li>
</ul>

<p><strong>Implementatie volgorde:</strong></p>
<ol>
<li>**Sprint 1-2:** US-064 (Edit Interface) - 8 points</li>
<li>**Sprint 3:** US-062 (FeedbackBuilder) - 8 points</li>
</ol>

<h4>‚ö†Ô∏è **ALTERNATIEF: Minimale Quick Win (Optie B)**</h4>
<p><strong>Wanneer overwegen:</strong></p>
<ul>
<li>Als US-064 lang duurt</li>
<li>Voor immediate kleine verbetering</li>
<li>Slechts 2 story points investment</li>
</ul>

<p><strong>Wat krijg je:</strong></p>
<ul>
<li>45 violation ‚Üí feedback mappings</li>
<li>Betere error messages</li>
<li>Geen complexe features</li>
</ul>

<h3>Go/No-Go Decision Matrix</h3>

<p>| Criterium | Optie A (Full) | Optie B (Minimal) | Optie C (Phased) |</p>
<p>|-----------|----------------|-------------------|------------------|</p>
<p>| Directe waarde | ‚ùå Laag | ‚ö†Ô∏è Matig | ‚úÖ Hoog |</p>
<p>| Effort | ‚ùå 8 points | ‚úÖ 2 points | ‚ö†Ô∏è 16 points |</p>
<p>| Risk | ‚ùå Hoog | ‚úÖ Laag | ‚úÖ Laag |</p>
<p>| CLAUDE.md conform | ‚ùå Nee | ‚úÖ Ja | ‚úÖ Ja |</p>
<p>| <strong>Aanbeveling</strong> | ‚ùå | ‚ö†Ô∏è | ‚úÖ‚úÖ‚úÖ |</p>

<h3>Verwachte Impact PER OPTIE</h3>

<p><strong>Optie A (Full zonder US-064):</strong></p>
<ul>
<li>Gebruikerstevredenheid: +10% (alleen betere messages)</li>
<li>Definitie kwaliteit: Geen verbetering</li>
<li>ROI: Negatief</li>
</ul>

<p><strong>Optie B (Minimal):</strong></p>
<ul>
<li>Gebruikerstevredenheid: +20% (begrijpelijke errors)</li>
<li>Definitie kwaliteit: +5% (betere prompts)</li>
<li>ROI: Positief</li>
</ul>

<p><strong>Optie C (Phased met US-064):</strong></p>
<ul>
<li>Gebruikerstevredenheid: +60% (edit + feedback)</li>
<li>Definitie kwaliteit: +40% (iteratieve verbetering)</li>
<li>ROI: Zeer positief</li>
</ul>

  </div>
</body>
</html>