<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vibe Coding Quick Reference for DefinitieAgent</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">← Terug naar Portal</a>
    <p>---</p>
<p>title: Vibe Coding Quick Reference for DefinitieAgent</p>
<p>description: Fast-access guide to Vibe Coding workflows and prompts for brownfield refactoring</p>
<p>author: Claude Code</p>
<p>date: 2025-01-17</p>
<p>status: active</p>
<p>related: [VIBE_CODING_METHODOLOGY_DEEP_ANALYSIS.md]</p>
<p>---</p>

<h1>Vibe Coding Quick Reference for DefinitieAgent</h1>

<blockquote>**Full Analysis**: See `docs/analyses/VIBE_CODING_METHODOLOGY_DEEP_ANALYSIS.md` for comprehensive methodology analysis.</blockquote>

<p>---</p>

<h2>Core Philosophy</h2>

<p><strong>Vibe Coding = Intuitive AI collaboration + Rigorous structure</strong></p>

<p>Three Pillars:</p>
<ol>
<li>**Spec-Driven**: AI builds only after clear problem/solution definition</li>
<li>**PM Framework**: Think problem-first, solution-second</li>
<li>**MCP Discipline**: Every feature lives in a ticket, no orphan work</li>
</ol>

<p>---</p>

<h2>Workflows by Context</h2>

<h3>For Refactoring (Brownfield) → Use Planning Systeem</h3>

<p><strong>When</strong>: Refactoring existing code, technical debt cleanup</p>

<p><strong>Steps</strong>:</p>
<pre><code>1. Brownfield Context Priming
   → Load CLAUDE.md constraints + existing architecture

2. Architect Assessment
   → Analyze current code, identify anti-patterns, define refactoring scope

3. Tech Spec (Refactoring-Focused)
   → Refactoring objectives, new architecture, migration strategy, testing

4. Action Plan
   → Granular tasks (max 15 files), tests per task, validation checkpoints</code></pre>

<p><strong>Use For</strong>:</p>
<ul>
<li>✅ ServiceContainer refactoring</li>
<li>✅ ValidationOrchestratorV2 improvements</li>
<li>✅ Session state management cleanup</li>
<li>✅ Anti-pattern removal (god objects, circular dependencies)</li>
</ul>

<p>---</p>

<h3>For New Features → Use Hybrid 4-Step</h3>

<p><strong>When</strong>: Adding new functionality to existing codebase</p>

<p><strong>Steps</strong>:</p>
<pre><code>1. PM Problem Validation
   → Problem analysis, feature story, acceptance criteria

2. Architecture Integration
   → How does this fit existing architecture? What to reuse vs. create?

3. Implementation Spec
   → Data models, service changes, UI changes, testing approach

4. Action Plan
   → Tasks, file changes, tests, validation checkpoints</code></pre>

<p><strong>Use For</strong>:</p>
<ul>
<li>✅ New validation rules (EPIC-002)</li>
<li>✅ New UI tabs/features (EPIC-004)</li>
<li>✅ New external integrations (EPIC-003)</li>
</ul>

<p>---</p>

<h3>For Bug Fixes → Use Debug Detective Pattern</h3>

<p><strong>When</strong>: Fixing bugs, investigating issues</p>

<p><strong>Steps</strong>:</p>
<pre><code>1. Debug Detective Analysis
   → Possible errors, root cause hypotheses, fix proposals (NO code yet)

2. Refactor-First (if code smells detected)
   → Clean up code around bug, improve readability (behavior-preserving)

3. Implement Fix
   → Minimal fix to root cause, add regression test

4. Validate
   → All tests pass, no CLAUDE.md violations, coverage maintained</code></pre>

<p><strong>Use For</strong>:</p>
<ul>
<li>✅ Bug investigations</li>
<li>✅ Performance issues</li>
<li>✅ Edge case handling</li>
</ul>

<p>---</p>

<h2>Essential Vibe Coding Tips for DefinitieAgent</h2>

<h3>Mandatory (Use Always)</h3>

<p><strong>Tip 7: Confirm Understanding</strong></p>
<pre><code>Vat samen wat je gaat bouwen en waarom. Wacht op mijn GO.</code></pre>
<p>→ <strong>Use</strong>: Before ANY code generation (prevents misaligned implementations)</p>

<p><strong>Tip 13: Refactor-First, Implement-Second</strong></p>
<pre><code>Refactor deze code:
- Verwijder duplicatie
- Docstrings
- Leesbaarheid/modulariteit
Gedrag ongewijzigd.</code></pre>
<p>→ <strong>Use</strong>: Separate refactoring from feature work (aligns with "no backwards compatibility" philosophy)</p>

<p><strong>Tip 15: Add Test Harness</strong></p>
<pre><code>Schrijf unit tests (pytest-stijl):
- Positief
- Negatief
- Edge cases</code></pre>
<p>→ <strong>Use</strong>: Every task includes test generation (maintain 60%+ coverage)</p>

<h3>High-Value (Use Frequently)</h3>

<p><strong>Tip 8: Architect First, Code Second</strong></p>
<pre><code>Architect-modus:
1) Mappenstructuur
2) Modules/functies
3) Dataflow
4) Risico's
Geen code. Vraag om GO.</code></pre>
<p>→ <strong>Use</strong>: Before any refactoring (prevents spaghetti code)</p>

<p><strong>Tip 11: AI as Risk Engineer</strong></p>
<pre><code>Noem 3 risico's/edge cases en geef mitigaties. Pas daarna implementatie.</code></pre>
<p>→ <strong>Use</strong>: For validation rules, AI service integration, web lookup (critical paths)</p>

<p><strong>Tip 18: Auto-Polish Loop</strong></p>
<pre><code>Voer polish-pass uit:
- Leesbaarheid
- Naming-conventies
- Foutafhandeling
- Docstrings
Toon alleen verbeterde versie.</code></pre>
<p>→ <strong>Use</strong>: Before committing (align with Ruff + Black standards)</p>

<h3>Advanced (Use Strategically)</h3>

<p><strong>Tip 16-17: Parallel Prompts + Synthesis</strong></p>
<pre><code>Geef 3 verschillende oplossingen:
A) Minimalistisch
B) Robuust/Redundant
C) Creatief/Out-of-the-box

[Review A/B/C]

Combineer de beste elementen van A/B/C tot één finale versie.</code></pre>
<p>→ <strong>Use</strong>: For architectural decisions, complex refactorings (explore solution space)</p>

<p>---</p>

<h2>Brownfield Context Template</h2>

<p><strong>Use this at the start of EVERY AI interaction for DefinitieAgent</strong>:</p>

<pre><code>&lt;context&gt;
Project: DefinitieAgent (Dutch legal definition generator)
Type: BROWNFIELD refactoring
Guidelines: /Users/chrislehnen/Projecten/Definitie-app/CLAUDE.md

## Existing Architecture (DO NOT REINVENT)

Core Pattern: Service-Oriented with Dependency Injection (ServiceContainer)

Key Services:
- ValidationOrchestratorV2: Main validation orchestration
- ModularValidationService: 45 validation rules in 7 categories
- UnifiedDefinitionGenerator: Core definition generation
- AIServiceV2: OpenAI GPT-4 integration with rate limiting
- PromptServiceV2: Modular prompt building
- ModernWebLookupService: Wikipedia/SRU integration
- SessionStateManager: SOLE source of truth for st.session_state

Established Patterns (MUST FOLLOW):
1. Dependency injection via ServiceContainer
2. Session state ONLY via SessionStateManager (NO direct st.session_state access)
3. Separation: core/ui/logging (NO mixing)
4. Type hints required (Python 3.11+)
5. Ruff + Black formatting (88 char lines)
6. pytest for testing (60%+ coverage target)

## CRITICAL ANTI-PATTERNS (FORBIDDEN)

❌ dry_helpers.py or catch-all utility modules
   → Split by specific purpose: type_helpers, dict_helpers, validation_helpers

❌ Direct st.session_state access outside SessionStateManager
   → Use SessionStateManager.get_value() / set_value()

❌ Mixing core/ui/logging (god objects)
   → Enforce Modularity Pact (Tip 12)

❌ Backwards compatibility code
   → REFACTOR cleanly, preserve business logic, no legacy support code

## Refactoring Constraints

- PRESERVE: Business logic, validation rules, API contracts
- MAINTAIN: Test coverage (60%+), performance (&lt; 1s validation)
- EXTRACT: Business knowledge during refactoring
- DOCUMENT: Design decisions, architectural changes

## Current Task
[PLACEHOLDER - Insert specific refactoring or feature task here]
&lt;/context&gt;</code></pre>

<p>---</p>

<h2>Planning Systeem Workflow (Detailed)</h2>

<h3>Step 1: Architect Assessment</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
You're a Senior Software Engineer analyzing EXISTING code for refactoring.
This is BROWNFIELD, not greenfield.
&lt;/goal&gt;

&lt;brownfield-context&gt;
[Use Brownfield Context Template above]
&lt;/brownfield-context&gt;

&lt;task&gt;
Assess current architecture of [MODULE NAME]:

Current Location: [file path]
Current Tests: [test file path, current coverage]
Current Documentation: [docs path]

ANALYSIS REQUIRED:
1. Current Architecture
   - Component structure (Mermaid diagram)
   - Dependencies and coupling
   - Data flow

2. Identified Issues
   - Anti-patterns (god objects, tight coupling, etc.)
   - CLAUDE.md violations
   - Testability problems
   - Maintainability issues

3. Proposed Architecture
   - Refactoring pattern (e.g., CategoryOrchestrator, Strategy, etc.)
   - New module structure
   - Before/after architecture diagrams

4. Refactoring Scope
   - What to preserve (business logic, APIs)
   - What to change (internal structure)
   - Migration strategy (if schema changes)

5. Risk Assessment
   - What could break?
   - Mitigation strategies
   - Performance impact
&lt;/task&gt;

&lt;format&gt;
Return as Markdown with:
- Clear section headings
- Mermaid diagrams for architecture
- Risk/mitigation table
- Questions for clarification (if any)
&lt;/format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/architecture-assessment.md</code></p>

<p>---</p>

<h3>Step 2: Tech Spec (Refactoring-Focused)</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
Create technical specification for refactoring [MODULE NAME] based on architect assessment.
&lt;/goal&gt;

&lt;input&gt;
[Paste architect assessment output from Step 1]
&lt;/input&gt;

&lt;spec-structure&gt;
## 1. Refactoring Objectives

PRESERVE:
- Business logic: [list specific rules/logic]
- API contracts: [list public APIs that callers depend on]
- Test coverage: [current coverage %, target coverage %]
- Performance: [current benchmarks, target benchmarks]

CHANGE:
- Internal structure: [what architectural changes]
- Test organization: [new test structure]
- Module organization: [new directory structure]

## 2. New Module Structure

[Show new directory tree]

src/services/[domain]/
├── __init__.py
├── [new modules]
└── [refactored modules]

## 3. Data Flow Changes

BEFORE:
[ASCII or Mermaid diagram]

AFTER:
[ASCII or Mermaid diagram]

## 4. Testing Approach

- Test organization: [new test files and structure]
- Coverage target: [e.g., maintain 98%]
- Test strategy:
  - Unit tests: [what to test in isolation]
  - Integration tests: [what to test end-to-end]
  - Regression tests: [new tests to prevent breaking existing behavior]

## 5. Migration Strategy

- Database changes: [if applicable, schema migrations]
- Configuration changes: [if applicable, config file updates]
- Deployment considerations: [rollout strategy, rollback plan]

## 6. Performance Targets

- Validation time: [target, e.g., ≤ current baseline]
- Memory usage: [target, e.g., ≤ current baseline]
- Benchmarking approach: [how to measure performance]

## 7. Risk Mitigation

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| [risk] | [H/M/L] | [H/M/L] | [mitigation strategy] |

## 8. CLAUDE.md Compliance

- [ ] No god objects or catch-all helpers
- [ ] SessionStateManager used for all session state
- [ ] Core/UI/logging separation maintained
- [ ] No backwards compatibility code
- [ ] Business logic preserved and documented

&lt;/spec-structure&gt;

&lt;format&gt;
Return complete tech spec in Markdown, ready for implementation planning.
&lt;/format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/tech-spec.md</code></p>

<p>---</p>

<h3>Step 3: Action Plan</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
Create granular, step-by-step action plan for implementing refactoring based on tech spec.
&lt;/goal&gt;

&lt;input&gt;
[Paste tech spec from Step 2]
&lt;/input&gt;

&lt;action-plan-structure&gt;
## Task [N]: [Brief Title]

**Task**: [Detailed explanation of what needs to be implemented]

**Files** (max 15):
- `path/to/file1.py`: [Description of changes]
- `path/to/file2.py`: [Description of changes]
- `tests/path/to/test_file.py`: [New tests or test updates]

**Implementation Steps**:
1. [Step 1]
2. [Step 2]
3. [Step 3]

**Tests**:
- Positive: [happy path test cases]
- Negative: [error handling test cases]
- Edge cases: [boundary condition test cases]

**Validation**:
- [ ] All tests pass (pytest)
- [ ] Coverage ≥ [target %] (pytest --cov)
- [ ] No CLAUDE.md violations
- [ ] Performance ≥ baseline (if applicable)

**Step Dependencies**: [List task IDs this depends on, or "None"]

**User Instructions**:
1. [Instruction for developer review/action]
2. [Instruction for validation]

---

[Repeat for each task]
&lt;/action-plan-structure&gt;

&lt;guidelines&gt;
- Each task must modify ≤ 15 files
- Each task must include tests
- Tasks should be independently validatable (run tests after each)
- Mark dependencies clearly
- Order tasks by: setup → implementation → integration → validation
&lt;/guidelines&gt;

&lt;format&gt;
Return complete action plan in Markdown, ready for task-by-task execution.
&lt;/format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/action-plan.md</code></p>

<p>---</p>

<h2>Hybrid 4-Step Workflow (Detailed)</h2>

<h3>Step 1: PM Problem Validation</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
You are an expert Product Manager analyzing a new feature request for DefinitieAgent.
Apply problem-first thinking before jumping to solutions.
&lt;/goal&gt;

&lt;pm-framework&gt;
1. Problem Analysis
   - What specific problem does this solve?
   - Who experiences this problem most acutely?
   - What are the consequences of NOT solving this?

2. Solution Validation
   - Why is this the right solution?
   - What alternatives exist? Why not those?
   - What is the minimum viable version?

3. Impact Assessment
   - How will we measure success?
   - What changes for users?
   - What are unintended consequences?
&lt;/pm-framework&gt;

&lt;feature-request&gt;
[Paste user's feature request here]
&lt;/feature-request&gt;

&lt;output-format&gt;
## Problem Analysis
[Answer questions from PM framework #1]

## Solution Validation
[Answer questions from PM framework #2]

## Feature Story

**Feature**: [Feature name]

**User Story**: As a [persona], I want to [action], so that I can [benefit]

**Acceptance Criteria**:
- Given [context], when [action], then [outcome]
- Given [edge case context], when [action], then [edge case outcome]

**Priority**: P0/P1/P2 ([Justification based on impact analysis])

**Dependencies**: [List any blockers or prerequisites]

**Technical Constraints**: [Any known limitations from existing architecture]

**UX Considerations**: [Key interaction points, user flow]

## Success Metrics
[How we'll measure if this solved the problem]

## Critical Questions
- [ ] [Question 1 for clarification]
- [ ] [Question 2 for clarification]
&lt;/output-format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/problem-analysis.md</code></p>

<p>---</p>

<h3>Step 2: Architecture Integration</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
Determine how this new feature integrates with existing DefinitieAgent architecture.
REUSE before CREATE.
&lt;/goal&gt;

&lt;brownfield-context&gt;
[Use Brownfield Context Template from above]
&lt;/brownfield-context&gt;

&lt;feature-story&gt;
[Paste feature story from Step 1]
&lt;/feature-story&gt;

&lt;integration-analysis&gt;
## 1. Existing Architecture Fit

Which existing services/patterns can we reuse?
- [ ] ServiceContainer (dependency injection)
- [ ] ValidationOrchestratorV2 (validation flow)
- [ ] ModularValidationService (validation rules)
- [ ] AIServiceV2 (AI integration)
- [ ] PromptServiceV2 (prompt building)
- [ ] ModernWebLookupService (external data)
- [ ] SessionStateManager (UI state)
- [ ] Other: [specify]

## 2. New Components Needed

What must be created (cannot reuse existing)?
- [ ] New service: [name and purpose]
- [ ] New validation rule: [category and purpose]
- [ ] New UI component: [location and purpose]
- [ ] New configuration: [type and purpose]
- [ ] Other: [specify]

## 3. Integration Points

How does this connect to existing architecture?
- Entry point: [where does this feature hook into the app?]
- Data flow: [input → processing → output]
- Dependencies: [what existing services does this depend on?]
- Dependents: [what will depend on this feature?]

## 4. Impact Assessment

What existing components are affected?
- Modified services: [list with justification]
- Modified UI: [list with justification]
- Modified configuration: [list with justification]
- Modified tests: [list with justification]

## 5. Architecture Diagram

[Mermaid diagram showing how new feature integrates with existing architecture]
&lt;/integration-analysis&gt;

&lt;format&gt;
Return integration analysis in Markdown, ready for implementation spec.
&lt;/format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/architecture-integration.md</code></p>

<p>---</p>

<h3>Step 3: Implementation Spec</h3>

<p><strong>Prompt Template</strong>:</p>
<pre><code>&lt;goal&gt;
Create implementation specification for new feature based on architecture integration.
&lt;/goal&gt;

&lt;input&gt;
Feature Story: [from Step 1]
Architecture Integration: [from Step 2]
&lt;/input&gt;

&lt;spec-structure&gt;
## 1. Data Model Changes

[If applicable, new entities or modifications to existing entities]

### New Entity: [Name]</code></pre>
<h1>Prisma/SQLAlchemy model or Python dataclass</h1>
<pre><code>
### Modified Entity: [Name]</code></pre>
<h1>Show changes to existing model</h1>
<pre><code>
## 2. Service Changes

### New Service: [Name]
**Purpose**: [What this service does]
**Location**: `src/services/[domain]/[service_name].py`
**Dependencies**: [List services this depends on]
**Interface**:</code></pre>
<p>class [ServiceName]:</p>
<p>    def __init__(self, ...):</p>
<p>        ...</p>

<p>    def <a href="self, ..." target="_blank">method_name</a> -> ...:</p>
<p>        """[Docstring with purpose, params, returns]"""</p>
<p>        ...</p>
<pre><code>
### Modified Service: [Name]
**Changes**: [What's being added/modified]
**Location**: `src/services/[domain]/[service_name].py`
**New Methods**:</code></pre>
<p>def <a href="self, ..." target="_blank">method_name</a> -> ...:</p>
<p>    """[Docstring]"""</p>
<p>    ...</p>
<pre><code>
## 3. Configuration Changes

[If applicable, new config files or modifications]

### New Config: [Name]
**Location**: `config/[domain]/[config_name].json` or `.yaml`
**Structure**:</code></pre>
<p>{</p>
<p>  "key": "value"</p>
<p>}</p>
<pre><code>
## 4. UI Changes

[If applicable, new tabs/components or modifications]

### New UI Component: [Name]
**Location**: `src/ui/tabs/[tab_name].py` or `src/ui/components/[component_name].py`
**Purpose**: [What this UI does]
**State Requirements**: [Session state variables needed]
**Integration**: [How this hooks into existing UI]

### Modified UI Component: [Name]
**Changes**: [What's being added/modified]

## 5. Testing Approach

### Unit Tests
- Test files: [list new test files]
- Coverage target: [e.g., 80%+ for new code]
- Key test cases:
  - Positive: [happy path scenarios]
  - Negative: [error handling scenarios]
  - Edge cases: [boundary conditions]

### Integration Tests
- Test files: [list integration test files]
- Test scenarios: [end-to-end scenarios to validate]

### Manual Testing
- [ ] [Manual test step 1]
- [ ] [Manual test step 2]

## 6. Migration Strategy

[If applicable, how to migrate existing data/config]

## 7. Rollback Plan

[How to safely rollback if this feature causes issues]

&lt;/spec-structure&gt;

&lt;format&gt;
Return implementation spec in Markdown, ready for action plan generation.
&lt;/format&gt;</code></pre>

<p><strong>Output Location</strong>: <code>docs/backlog/EPIC-XXX/US-XXX/implementation-spec.md</code></p>

<p>---</p>

<h3>Step 4: Action Plan</h3>

<p><strong>Same as Planning Systeem Step 3</strong> (see above)</p>

<p>---</p>

<h2>Quick Decision Tree</h2>

<pre><code>┌─────────────────────────────────────┐
│  What type of work is this?         │
└─────────────┬───────────────────────┘
              │
         ┌────┴────┐
         │         │
    Refactoring   New Feature
         │         │
         v         v
   Planning    Hybrid 4-Step
   Systeem
         │         │
         v         v
   ┌─────────────────────────┐
   │ Brownfield Context      │
   │ Priming (ALWAYS)        │
   └─────────────────────────┘
         │
         v
   ┌─────────────────────────┐
   │ Execute Workflow        │
   │ Task-by-Task            │
   └─────────────────────────┘
         │
         v
   ┌─────────────────────────┐
   │ Validate (Tip 15)       │
   │ - Tests pass            │
   │ - CLAUDE.md compliance  │
   │ - Coverage ≥ 60%        │
   └─────────────────────────┘</code></pre>

<p>---</p>

<h2>Common Patterns</h2>

<h3>Pattern 1: Adding New Validation Rule</h3>

<p><strong>Workflow</strong>: Hybrid 4-Step (abbreviated)</p>

<p><strong>Quick Steps</strong>:</p>
<ol>
<li>**Problem**: What clarity/quality issue does this rule address?</li>
<li>**Integration**: Which category (ARAI/CON/ESS/INT/SAM/STR/VER)?</li>
<li>**Implementation**:</li>
</ol>
<ul>
<li>  - Create `config/toetsregels/regels/[CAT]/[CAT]-00X-[name].json`</li>
<li>  - Create `src/toetsregels/regels/[CAT]/[name]_rule.py`</li>
<li>  - Register in `config/toetsregels.json`</li>
</ul>
<ol>
<li>**Tests**:</li>
</ol>
<ul>
<li>  - Create `tests/toetsregels/regels/[CAT]/test_[name]_rule.py`</li>
<li>  - Test positive/negative/edge cases</li>
</ul>
<ol>
<li>**Validate**: Run `pytest tests/toetsregels/` and verify coverage</li>
</ol>

<p>---</p>

<h3>Pattern 2: Refactoring Service</h3>

<p><strong>Workflow</strong>: Planning Systeem (full)</p>

<p><strong>Quick Steps</strong>:</p>
<ol>
<li>**Context Priming**: Load brownfield context + current service architecture</li>
<li>**Architect Assessment**: Analyze current structure, identify issues, propose refactoring</li>
<li>**Tech Spec**: Define refactoring objectives, new structure, migration, testing</li>
<li>**Action Plan**: Break into tasks (max 15 files each), include tests</li>
<li>**Execute**: Task-by-task with validation after each</li>
</ol>

<p>---</p>

<h3>Pattern 3: Fixing Bug</h3>

<p><strong>Workflow</strong>: Debug Detective Pattern</p>

<p><strong>Quick Steps</strong>:</p>
<ol>
<li>**Debug Analysis**: Hypothesize root causes (NO code yet)</li>
<li>**Refactor-First**: Clean up code around bug (if smelly)</li>
<li>**Fix**: Minimal change to address root cause</li>
<li>**Regression Test**: Add test that would have caught this bug</li>
<li>**Validate**: All tests pass, coverage maintained</li>
</ol>

<p>---</p>

<h2>Tooling Scripts (Recommended)</h2>

<p>Create these in <code>scripts/vibe-coding/</code>:</p>

<h3>`init-refactor.sh`</h3>
<pre><code>#!/bin/bash
# Usage: scripts/vibe-coding/init-refactor.sh &lt;module-name&gt;

MODULE=$1
EPIC=$2
US=$3

# Create documentation structure
mkdir -p "docs/backlog/${EPIC}/${US}"

# Generate brownfield context template
cat &gt; "docs/backlog/${EPIC}/${US}/brownfield-context.md" &lt;&lt;EOF
[Brownfield Context Template - auto-populated]
EOF

# Launch architect assessment prompt
echo "Brownfield context created. Next: Run architect assessment."</code></pre>

<h3>`next-task.sh`</h3>
<pre><code>#!/bin/bash
# Usage: scripts/vibe-coding/next-task.sh &lt;US-XXX&gt;

US=$1
ACTION_PLAN="docs/backlog/${EPIC}/${US}/action-plan.md"

# Parse action plan, find next pending task
# Mark as in-progress
# Display task details</code></pre>

<h3>`validate-task.sh`</h3>
<pre><code>#!/bin/bash
# Usage: scripts/vibe-coding/validate-task.sh

# Run tests
pytest -v

# Check coverage
pytest --cov=src --cov-report=term-missing

# Check CLAUDE.md compliance (custom script)
python scripts/check-claude-compliance.py

# If all pass, mark task complete</code></pre>

<p>---</p>

<h2>Resources</h2>

<p><strong>Full Analysis</strong>: <code>docs/analyses/VIBE_CODING_METHODOLOGY_DEEP_ANALYSIS.md</code></p>

<p><strong>Templates</strong>:</p>
<ul>
<li>Brownfield Context: See above</li>
<li>Planning Systeem: Steps 1-3 above</li>
<li>Hybrid 4-Step: Steps 1-4 above</li>
</ul>

<p><strong>Examples</strong> (to be created):</p>
<ul>
<li>ValidationOrchestratorV2 refactoring case study</li>
<li>New validation rule implementation walkthrough</li>
<li>Bug fix using Debug Detective pattern</li>
</ul>

<p>---</p>

<p><strong>Last Updated</strong>: 2025-01-17</p>
<p><strong>Status</strong>: Active</p>
<p><strong>Maintained By</strong>: Development Team</p>

  </div>
</body>
</html>