<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>History Tab Removal - Verification Plan & Checklist</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">‚Üê Terug naar Portal</a>
    <h1>History Tab Removal - Verification Plan & Checklist</h1>

<h2>Overview</h2>
<p>This document provides a comprehensive test and verification plan for validating the application after removing the History tab functionality.</p>

<h2>Pre-Removal Baseline</h2>

<h3>1. Capture Current State (BEFORE removal)</h3>
<pre><code># Run baseline capture
python scripts/testing/verify_history_removal.py --baseline

# Or using Make
make -f scripts/testing/Makefile.history_removal baseline-history</code></pre>

<p>This captures:</p>
<ul>
<li>Current import times</li>
<li>Memory usage</li>
<li>Database statistics</li>
<li>File counts</li>
<li>History reference counts</li>
</ul>

<h2>Post-Removal Verification</h2>

<h3>2. Automated Verification Suite</h3>

<h4>A. Quick Verification</h4>
<pre><code># Run complete verification
bash scripts/testing/verify_history_removal.sh</code></pre>

<h4>B. Detailed Python Verification</h4>
<pre><code># Run comprehensive Python verification
python scripts/testing/verify_history_removal.py --verify</code></pre>

<h4>C. Using Make Targets</h4>
<pre><code># Run all verification targets
make -f scripts/testing/Makefile.history_removal verify-history-removal</code></pre>

<h3>3. Test Categories</h3>

<h4>üîç A. Code Remnant Checks</h4>
<ul>
<li>[ ] No `HistoryTab` imports remain</li>
<li>[ ] No `history_tab` instantiations</li>
<li>[ ] No `"history"` in tab configuration</li>
<li>[ ] File `history_tab.py` removed or unused</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code>grep -r "HistoryTab\|history_tab" src/ --include="*.py"</code></pre>

<h4>üêç B. Python Import Tests</h4>
<ul>
<li>[ ] `TabbedInterface` imports successfully</li>
<li>[ ] `main.py` imports without errors</li>
<li>[ ] All UI component tabs import</li>
<li>[ ] No import circular dependencies</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code>python -c "from src.ui.tabbed_interface import TabbedInterface"
python -c "from src.main import main"</code></pre>

<h4>üíæ C. Database Integrity</h4>
<ul>
<li>[ ] `definitie_geschiedenis` table still exists</li>
<li>[ ] History triggers still function</li>
<li>[ ] Can query history data</li>
<li>[ ] No orphaned history records</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code>-- Check history table
SELECT COUNT(*) FROM definitie_geschiedenis;

-- Test trigger
INSERT INTO definities (begrip, definitie) VALUES ('TEST', 'test');
SELECT COUNT(*) FROM definitie_geschiedenis WHERE definitie_id = last_insert_rowid();</code></pre>

<h4>üß™ D. Integration Tests</h4>
<ul>
<li>[ ] All smoke tests pass</li>
<li>[ ] Definition generation works</li>
<li>[ ] Export functionality works</li>
<li>[ ] Management operations work</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code>pytest tests/smoke/ -v
pytest tests/test_history_removal.py -v</code></pre>

<h4>üìä E. Performance Tests</h4>
<ul>
<li>[ ] Import time improved (or not degraded)</li>
<li>[ ] Memory usage reduced (or not increased)</li>
<li>[ ] Application startup faster</li>
<li>[ ] Tab switching smooth</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code># Compare with baseline
python scripts/testing/verify_history_removal.py --verify</code></pre>

<h4>üé® F. UI Functionality (Manual)</h4>
<ul>
<li>[ ] Application starts without errors</li>
<li>[ ] Generator tab accessible and functional</li>
<li>[ ] Edit tab accessible and functional</li>
<li>[ ] Expert Review tab accessible and functional</li>
<li>[ ] Export tab accessible and functional</li>
<li>[ ] Management tab accessible and functional</li>
<li>[ ] Quality Control tab accessible and functional</li>
<li>[ ] Monitoring tab accessible and functional</li>
<li>[ ] Web Lookup tab accessible and functional</li>
<li>[ ] External Sources tab accessible and functional</li>
<li>[ ] **NO History tab visible**</li>
<li>[ ] Navigation between tabs smooth</li>
<li>[ ] No console errors in browser</li>
<li>[ ] No broken links or references</li>
</ul>

<p><strong>Manual Testing:</strong></p>
<pre><code>streamlit run src/main.py</code></pre>

<h4>üîÑ G. Session State</h4>
<ul>
<li>[ ] No history-related keys in session state</li>
<li>[ ] Session state initialization clean</li>
<li>[ ] No deprecated state variables</li>
</ul>

<p><strong>Verification:</strong></p>
<pre><code>from ui.session_state import SessionStateManager
SessionStateManager.initialize_session_state()
defaults = SessionStateManager._get_default_values()
history_keys = [k for k in defaults if 'history' in k.lower()]
print(f"History keys: {history_keys}")</code></pre>

<h2>Success Criteria</h2>

<h3>Critical (Must Pass)</h3>
<ol>
<li>‚úÖ Application starts without errors</li>
<li>‚úÖ All remaining tabs functional</li>
<li>‚úÖ No `HistoryTab` imports or references</li>
<li>‚úÖ Database integrity maintained</li>
</ol>

<h3>Important (Should Pass)</h3>
<ol>
<li>‚úÖ All automated tests pass</li>
<li>‚úÖ Performance not degraded</li>
<li>‚úÖ No history keys in session state</li>
</ol>

<h3>Nice to Have</h3>
<ol>
<li>‚úÖ Performance improved</li>
<li>‚úÖ Memory usage reduced</li>
<li>‚úÖ Cleaner codebase</li>
</ol>

<h2>Verification Report</h2>

<p>After running verification, check:</p>
<ul>
<li>`history_removal_report_*.json` - Detailed JSON report</li>
<li>`history_removal_verification_*.log` - Full log output</li>
<li>`.history_removal_verified` - Success marker file</li>
</ul>

<h2>Troubleshooting</h2>

<h3>Common Issues and Fixes</h3>

<h4>1. Import Errors</h4>
<pre><code># If "No module named 'history_tab'"
# Check: src/ui/tabbed_interface.py
# Remove: from ui.components.history_tab import HistoryTab</code></pre>

<h4>2. Tab Not Found</h4>
<pre><code># If "AttributeError: 'TabbedInterface' object has no attribute 'history_tab'"
# Check: Tab initialization and remove self.history_tab = HistoryTab(...)</code></pre>

<h4>3. Tab Config Issues</h4>
<pre><code># If history still in navigation
# Check: self.tab_config dictionary
# Remove: "history": {...} entry</code></pre>

<h4>4. Render Issues</h4>
<pre><code># If "KeyError: 'history'" in rendering
# Check: _render_tab_content() method
# Remove: elif tab_key == "history": self.history_tab.render()</code></pre>

<h2>Rollback Plan</h2>

<p>If issues are found:</p>

<ol>
<li>**Check Git status:**</li>
<pre><code>   git status
   git diff src/ui/tabbed_interface.py</code></pre>
</ol>

<ol>
<li>**Create fix branch:**</li>
<pre><code>   git checkout -b fix/history-removal-issues</code></pre>
</ol>

<ol>
<li>**Apply fixes based on verification results**</li>
</ol>

<ol>
<li>**Re-run verification:**</li>
<pre><code>   python scripts/testing/verify_history_removal.py --verify</code></pre>
</ol>

<h2>Monitoring Plan</h2>

<p>Post-deployment (24-48 hours):</p>

<ol>
<li>**Monitor logs:**</li>
<pre><code>   tail -f logs/app.log | grep -i "error\|history"</code></pre>
</ol>

<ol>
<li>**Check error rates:**</li>
</ol>
<ul>
<li>  - Application errors</li>
<li>  - 500 errors</li>
<li>  - UI console errors</li>
</ul>

<ol>
<li>**Performance metrics:**</li>
</ol>
<ul>
<li>  - Page load times</li>
<li>  - Tab switch times</li>
<li>  - Memory usage trends</li>
</ul>

<h2>Sign-off</h2>

<ul>
<li>[ ] Developer verification complete</li>
<li>[ ] Automated tests passing</li>
<li>[ ] Manual UI testing complete</li>
<li>[ ] Performance acceptable</li>
<li>[ ] Documentation updated</li>
</ul>

<p><strong>Verified by:</strong> ________________</p>
<p><strong>Date:</strong> ________________</p>
<p><strong>Version:</strong> ________________</p>
  </div>
</body>
</html>