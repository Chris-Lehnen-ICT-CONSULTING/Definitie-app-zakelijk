<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Linear Issues Dependency Graph - DefinitieAgent</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">â† Terug naar Portal</a>
    <h1>Linear Issues Dependency Graph - DefinitieAgent</h1>
<p><strong>Date:</strong> 2025-10-30</p>
<p><strong>Visual representation of issue dependencies and critical paths</strong></p>

<p>---</p>

<h2>ğŸ¯ CRITICAL PATH VISUALIZATION</h2>

<pre><code>BLOCKING ISSUES (MUST FIX FIRST)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  P0: DATA LOSS PREVENTION (DAYS 1-2)                       â”‚
â”‚  ğŸ”´ BLOCKS ALL OTHER WORK                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â–º DEF-74: Pydantic validation enforcement (2h)
         â”‚         â”‚
         â”‚         â””â”€â”€â–º Blocks DEF-69 â”€â”€â”
         â”‚                               â”‚
         â”œâ”€â”€â–º DEF-69: Voorbeelden save errors (3-4h)
         â”‚         â”‚                     â”‚
         â”‚         â””â”€â”€â–º Blocks CSV import
         â”‚                               â”‚
         â””â”€â”€â–º DEF-68: Context validation errors (2-3h)
                   â”‚                     â”‚
                   â””â”€â”€â–º Blocks all imports
                                         â”‚
                                         â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  SAFE IMPORT OPERATIONS          â”‚
                        â”‚  âœ… Data integrity guaranteed    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<p>---</p>

<h2>ğŸ”— DEPENDENCY CHAINS</h2>

<h3>Chain 1: Data Integrity (CRITICAL)</h3>
<pre><code>START
  â”‚
  â”œâ”€â–º [DEF-74] Pydantic validation
  â”‚        â”‚
  â”‚        â”œâ”€â–º prevents: TypeError crashes
  â”‚        â”œâ”€â–º enables:  Safe voorbeelden input
  â”‚        â”‚
  â”‚        â””â”€â”€â–º BLOCKS â”€â”€â–º [DEF-69] Voorbeelden save errors
  â”‚                              â”‚
  â”‚                              â”œâ”€â–º prevents: Silent data loss
  â”‚                              â”œâ”€â–º enables:  Reliable CSV import
  â”‚                              â”‚
  â”‚                              â””â”€â”€â–º BLOCKS â”€â”€â–º [DEF-68] Context validation
  â”‚                                                    â”‚
  â”‚                                                    â”œâ”€â–º prevents: Silent corruption
  â”‚                                                    â”œâ”€â–º enables:  Safe validation flow
  â”‚                                                    â”‚
  â”‚                                                    â””â”€â”€â–º ENABLES â”€â”€â–º âœ… SAFE OPERATIONS
  â”‚
END: Data integrity guaranteed
     - No silent exceptions
     - All errors logged
     - User feedback on failures</code></pre>

<p><strong>CRITICAL:</strong> Sequential execution required - each step blocks the next!</p>

<p>---</p>

<h3>Chain 2: SessionState Compliance</h3>
<pre><code>START
  â”‚
  â”œâ”€â–º [DEF-73] Fix 10 st.session_state violations (3-4h)
  â”‚        â”‚
  â”‚        â”œâ”€â–º Replaces: Direct st.session_state[...] access
  â”‚        â”œâ”€â–º With: SessionStateManager.get_value()
  â”‚        â”‚
  â”‚        â””â”€â”€â–º ENABLES â”€â”€â–º Streamlit anti-pattern prevention
  â”‚                              â”‚
  â”‚                              â”œâ”€â–º Pre-commit hook enforcement
  â”‚                              â”œâ”€â–º UI stability improvements
  â”‚                              â”‚
  â”‚                              â””â”€â”€â–º âœ… COMPLIANT UI
  â”‚
END: SessionStateManager is single source of truth
     - No direct st.session_state access
     - Pre-commit hook prevents violations
     - Easier debugging</code></pre>

<p><strong>Impact:</strong> 10 files need updates, but LOW risk (find-replace pattern)</p>

<p>---</p>

<h3>Chain 3: Performance Optimization</h3>
<pre><code>START
  â”‚
  â”œâ”€â–º [DEF-60] Lazy tab loading (4h)
  â”‚        â”‚
  â”‚        â”œâ”€â–º Reduces: 509ms â†’ 180ms (65% faster)
  â”‚        â”œâ”€â–º Method: Defer tab component initialization
  â”‚        â”‚
  â”‚        â””â”€â”€â–º ENABLES â”€â”€â–º [DEF-61] Async prompt loading (8h)
  â”‚                              â”‚
  â”‚                              â”œâ”€â–º Reduces: 180ms â†’ 90ms (50% faster)
  â”‚                              â”œâ”€â–º Method: Parallel module loading
  â”‚                              â”‚
  â”‚                              â””â”€â”€â–º ENABLES â”€â”€â–º [DEF-66] Cache tuning (2h)
  â”‚                                                    â”‚
  â”‚                                                    â”œâ”€â–º Final: &lt; 100ms startup
  â”‚                                                    â”‚
  â”‚                                                    â””â”€â”€â–º âœ… PERFORMANCE TARGET MET
  â”‚
END: Total improvement 82% (509ms â†’ 90ms)
     - Lazy tab initialization
     - Async prompt loading
     - Optimized caching</code></pre>

<p><strong>Recommended:</strong> Phase approach (Week 1: DEF-60, Week 2: DEF-61, Week 3: DEF-66)</p>

<p>---</p>

<h3>Chain 4: God Object Simplification (LONG-TERM)</h3>
<pre><code>START
  â”‚
  â”œâ”€â–º [DEF-70] ServiceContainer simplification (4-6h)
  â”‚        â”‚
  â”‚        â”œâ”€â–º Reduces: 818 LOC â†’ 100-150 LOC (82-88%)
  â”‚        â”œâ”€â–º Method: Replace with module singletons
  â”‚        â”‚
  â”‚        â””â”€â”€â–º ENABLES â”€â”€â–º [DEF-60] Lazy loading (easier implementation)
  â”‚                              â”‚
  â”‚                              â””â”€â”€â–º Performance boost
  â”‚
  â”œâ”€â–º [DEF-71] DefinitieRepository simplification (8-12h)
  â”‚        â”‚
  â”‚        â”œâ”€â–º Reduces: 2,101 LOC â†’ 300-400 LOC (81-86%)
  â”‚        â”œâ”€â–º Method: Remove dual repository, direct SQL
  â”‚        â”‚
  â”‚        â””â”€â”€â–º ENABLES â”€â”€â–º Simpler tests, faster development
  â”‚
  â””â”€â”€â–º ENABLES â”€â”€â–º [DEF-72] Directory consolidation (8-10h)
                        â”‚
                        â”œâ”€â–º Reduces: 34 dirs â†’ 8 dirs
                        â”‚
                        â””â”€â”€â–º âœ… MAINTAINABLE CODEBASE
  â”‚
END: 70-80% LOC reduction across 5 major components
     - Simpler architecture
     - Easier onboarding
     - Faster testing</code></pre>

<p><strong>Risk:</strong> MEDIUM (database layer changes require careful testing)</p>
<p><strong>Recommended:</strong> Phase 1 (ServiceContainer) first, then Phase 2 (Repository)</p>

<p>---</p>

<h2>ğŸš§ BLOCKING RELATIONSHIPS</h2>

<h3>What Blocks What?</h3>

<pre><code>DEF-74 (Pydantic validation)
   â†“ BLOCKS
DEF-69 (Voorbeelden save errors)
   â†“ BLOCKS
All CSV import operations
All voorbeelden reliability
   â†“ BLOCKS
DEF-45 (Voorbeelden consistency)


DEF-68 + DEF-69 + DEF-74 (Data integrity)
   â†“ BLOCKS
DEF-35 (Classifier MVP)
   â†“ BLOCKS
DEF-38 (Ontological prompt fixes)
   â†“ BLOCKS
DEF-40 (Category-specific prompts)


DEF-70 (ServiceContainer simplification)
   â†“ ENABLES (easier implementation)
DEF-60 (Lazy tab loading)
   â†“ ENABLES
DEF-61 (Async prompt loading)


DEF-70 + DEF-71 (God object splits)
   â†“ ENABLES
DEF-72 (Directory consolidation)
   â†“ ENABLES
DEF-63, DEF-64, DEF-65 (Module consolidation)</code></pre>

<p>---</p>

<h2>ğŸ“Š RISK vs EFFORT MATRIX</h2>

<pre><code>    HIGH RISK
        â”‚
    ğŸ”´  â”‚  DEF-68 â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  DEF-69 â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  DEF-74 â—â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚ (P0 CRITICAL)
        â”‚                â”‚     â”‚   â”‚
        â”‚                â”‚     â”‚   â”‚
    ğŸŸ¡  â”‚           DEF-71 â—   â”‚   â”‚ (God objects)
        â”‚                â”‚ DEF-70 â—â”‚
        â”‚                â”‚     â”‚   â”‚
        â”‚                â”‚     â”‚   â”‚
    ğŸŸ   â”‚          DEF-35 â—â”€â”€â”€â”€â”€â”  â”‚ (Classifier MVP)
        â”‚                â”‚      â”‚  â”‚
        â”‚  DEF-60 â—      â”‚      â”‚  â”‚ (Performance)
        â”‚  DEF-61 â—â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
        â”‚                       â”‚  â”‚
    ğŸŸ¢  â”‚  DEF-73 â—             â”‚  â”‚ (SessionState)
        â”‚  DEF-66 â—             â”‚  â”‚
        â”‚                       â”‚  â”‚
        â”‚  DEF-38, DEF-40 â—â”€â”€â”€â”€â”€â”˜  â”‚ (Features)
        â”‚  DEF-42, DEF-45 â—â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    LOW â”‚  DEF-72, DEF-63-65 â—       (Cleanup)
    RISKâ”‚  DEF-75-77, DEF-78-79 â—
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         1h   5h   10h  15h  20h  EFFORT
        LOW           HIGH</code></pre>

<p><strong>Legend:</strong></p>
<ul>
<li>ğŸ”´ Critical (P0) - Data loss risk</li>
<li>ğŸŸ¡ High (P1) - Blocking features</li>
<li>ğŸŸ  Medium (P2) - Performance/architecture</li>
<li>ğŸŸ¢ Low (P3/P4) - Quality/cleanup</li>
</ul>

<p><strong>Prioritization:</strong> Risk first, then effort</p>

<p>---</p>

<h2>â±ï¸ SEQUENTIAL vs PARALLEL WORK</h2>

<h3>Can Run in PARALLEL (Same week)</h3>
<pre><code>Week 1:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-73          â”‚   â”‚  After P0 done:  â”‚
â”‚  SessionState    â”‚ âˆ¥ â”‚  Documentation   â”‚
â”‚  violations      â”‚   â”‚  updates         â”‚
â”‚  (3-4h)          â”‚   â”‚  (2h)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 2:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-60          â”‚   â”‚  DEF-38, DEF-40  â”‚
â”‚  Lazy loading    â”‚ âˆ¥ â”‚  Prompt work     â”‚
â”‚  (4h)            â”‚   â”‚  (if DEF-35 done)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<h3>MUST Run SEQUENTIALLY (Days)</h3>
<pre><code>Day 1-2: P0 Data Loss Prevention
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-74       â”‚  (2h)
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ BLOCKS
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-69       â”‚  (3-4h)
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ BLOCKS
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-68       â”‚  (2-3h)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Day 3: SessionState
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-73       â”‚  (3-4h)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Day 4: Performance
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-60       â”‚  (4h)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 2: Classifier MVP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEF-35       â”‚  (16-20h)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<p><strong>Critical:</strong> P0 chain MUST be sequential - no parallelization possible!</p>

<p>---</p>

<h2>ğŸ¯ RECOMMENDED EXECUTION ORDER</h2>

<h3>PHASE 0: Data Loss Prevention (DAYS 1-2) ğŸ”´ CRITICAL</h3>
<pre><code>Priority: HIGHEST
Risk: Data loss in production
Impact: Blocks all other work

1. DEF-74: Enforce Pydantic validation     [2h]   â—â”â”â”â”â”â”
2. DEF-69: Add voorbeelden error handling  [3-4h] â—â”â”â”â”â”â”¤ Sequential
3. DEF-68: Add context error handling      [2-3h] â—â”â”â”â”â”â”˜

Total: 7-9 hours
Success: No silent exceptions, all errors logged</code></pre>

<h3>PHASE 1: Quick Wins (DAYS 3-4) ğŸŸ¡ HIGH</h3>
<pre><code>Priority: High value, low risk
Risk: UI stability issues
Impact: Enables safe development

1. DEF-73: Fix SessionState violations     [3-4h] â—â”â”â”â”â”â”
2. DEF-60: Lazy tab loading               [4h]   â—â”â”â”â”â”â”¤ Parallel
   Documentation updates                   [2h]   â—â”â”â”â”â”â”˜

Total: 9-10 hours
Success: SessionState compliant, 65% faster startup</code></pre>

<h3>PHASE 2: Critical Feature (WEEK 2) ğŸŸ  MEDIUM</h3>
<pre><code>Priority: Blocking other features
Risk: Integration complexity
Impact: Enables ontological work

1. DEF-35: Classifier MVP                  [16-20h] â—â”â”â”â”â”â”â”â”

Total: 16-20 hours
Success: 80%+ accuracy, AI fallback working</code></pre>

<h3>PHASE 3: God Objects (WEEKS 3-4) ğŸŸ¢ LOW (OPTIONAL)</h3>
<pre><code>Priority: Long-term maintainability
Risk: Database changes
Impact: 70-80% code reduction

Week 3:
1. DEF-70: ServiceContainer â†’ Singletons   [4-6h]  â—â”â”â”â”â”â”
2. Update all service access patterns      [2h]    â—â”â”â”â”â”â”˜

Week 4:
1. DEF-71: Repository simplification       [8-12h] â—â”â”â”â”â”â”â”â”
2. Database migration testing              [2h]    â—â”â”â”â”â”

Total: 16-20 hours
Success: 70-80% LOC reduction, faster tests</code></pre>

<p>---</p>

<h2>ğŸ“ˆ PROGRESS TRACKING</h2>

<h3>Week 1 Milestones</h3>
<ul>
<li>[ ] Day 1: DEF-74 complete (Pydantic enforced)</li>
<li>[ ] Day 2: DEF-69 complete (Voorbeelden errors handled)</li>
<li>[ ] Day 2: DEF-68 complete (Context errors handled)</li>
<li>[ ] Day 3: DEF-73 complete (SessionState compliant)</li>
<li>[ ] Day 4: DEF-60 complete (Lazy loading working)</li>
</ul>

<h3>Week 2 Milestones</h3>
<ul>
<li>[ ] Day 5-7: DEF-35 complete (Classifier MVP done)</li>
<li>[ ] Ontological prompts validated</li>
<li>[ ] Integration tests passing</li>
</ul>

<h3>Week 3-4 Milestones (OPTIONAL)</h3>
<ul>
<li>[ ] Week 3: DEF-70 complete (Singleton pattern)</li>
<li>[ ] Week 4: DEF-71 complete (Repository simplified)</li>
<li>[ ] All tests passing</li>
<li>[ ] 70%+ code reduction achieved</li>
</ul>

<p>---</p>

<h2>ğŸš¨ EMERGENCY PROTOCOLS</h2>

<h3>If Data Loss Detected</h3>
<pre><code>IMMEDIATE ACTIONS:
1. STOP all development work
2. Rollback last changes (git)
3. Restore database from backup
4. Root cause analysis (which issue?)
5. Fix + test + deploy
6. Resume normal work</code></pre>

<h3>If Silent Failure Found</h3>
<pre><code>IMMEDIATE ACTIONS:
1. Add logging IMMEDIATELY (don't wait for fix)
2. Create emergency Linear issue (P0)
3. Add to critical path (blocks other work)
4. Fix within 24 hours</code></pre>

<h3>If Performance Regression > 20%</h3>
<pre><code>IMMEDIATE ACTIONS:
1. Measure baseline (before/after)
2. Rollback optimization if critical
3. Profile bottleneck
4. Fix or revert permanently</code></pre>

<p>---</p>

<h2>ğŸ“š REFERENCES</h2>

<h3>Analysis Documents</h3>
<ul>
<li>**Main Analysis:** `LINEAR_ISSUES_DEPENDENCY_RISK_ANALYSIS.md`</li>
<li>**Performance:** `STARTUP_PERFORMANCE_ANALYSIS.md`</li>
<li>**Over-Engineering:** `OVER_ENGINEERING_ANALYSIS.md`</li>
<li>**Streamlit Patterns:** `STREAMLIT_PATTERNS.md`</li>
</ul>

<h3>Code Locations</h3>
<ul>
<li>**SessionStateManager:** `src/ui/session_state.py` (311 LOC)</li>
<li>**ServiceContainer:** `src/services/container.py` (817 LOC)</li>
<li>**DefinitieRepository:** `src/database/definitie_repository.py` (2,100 LOC)</li>
<li>**VoorbeeldenValidation:** `src/models/voorbeelden_validation.py` (184 LOC)</li>
</ul>

<p>---</p>

<p><strong>END OF DEPENDENCY GRAPH</strong></p>

  </div>
</body>
</html>