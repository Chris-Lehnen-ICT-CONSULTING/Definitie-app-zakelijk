<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Configuration Environment - Dependency Graph</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">â† Terug naar Portal</a>
    <h1>Configuration Environment - Dependency Graph</h1>

<p><strong>Date</strong>: 2025-10-07</p>
<p><strong>Purpose</strong>: Visual representation of fix dependencies and critical path</p>

<p>---</p>

<h2>Issue Dependency Graph</h2>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONFIGURATION ISSUES                      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                       â”‚                    â”‚
     â–¼                       â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ SECURITY â”‚      â”‚ ğŸŸ¡ ENVIRONMENTâ”‚    â”‚ ğŸŸ¢ DEAD CODE  â”‚
â”‚  API Key    â”‚      â”‚   Handling    â”‚    â”‚  Parameters   â”‚
â”‚  Exposed    â”‚      â”‚   Broken      â”‚    â”‚   Unused      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚                     â”‚
     â”‚ Independent          â”‚ Depends on          â”‚ Independent
     â”‚                      â”‚ Enum Fix            â”‚
     â–¼                      â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1:   â”‚      â”‚  Phase 2:    â”‚    â”‚  Phase 3:     â”‚
â”‚  Security   â”‚      â”‚  Fix Config  â”‚    â”‚  Remove Code  â”‚
â”‚  Fix        â”‚      â”‚  Manager     â”‚    â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚                     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Phase 4:    â”‚
                    â”‚  Docs        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<p>---</p>

<h2>Detailed Dependency Chain</h2>

<h3>Path A: Security Fix (Critical Path)</h3>

<pre><code>ğŸ”´ API Key Exposed (32 days)
  â†“
  â”œâ”€&gt; 1. Rotate key at OpenAI dashboard
  â”œâ”€&gt; 2. Remove hardcoded key from config
  â”œâ”€&gt; 3. Add pre-commit hook
  â””â”€&gt; 4. Commit changes
       â†“
       âœ… Security issue resolved</code></pre>

<p><strong>Dependencies</strong>: None</p>
<p><strong>Blocks</strong>: Nothing (can be done independently)</p>
<p><strong>Time</strong>: 30 minutes</p>
<p><strong>Risk</strong>: LOW (env variable override already works)</p>

<p>---</p>

<h3>Path B: Environment Handling Fix (Main Path)</h3>

<pre><code>ğŸŸ¡ Environment Enum Incomplete
  â†“
  â”œâ”€&gt; Task 2.1: Add PRODUCTION and TESTING to enum
  â”‚    â†“
  â”‚    â””â”€&gt; Environment(Enum) now has 3 values
  â”‚         â†“
  â”‚         â”œâ”€&gt; Task 2.2: Fix ConfigManager.__init__()
  â”‚         â”‚    â†“
  â”‚         â”‚    â””â”€&gt; Respect APP_ENV environment variable
  â”‚         â”‚         â†“
  â”‚         â”‚         â”œâ”€&gt; Task 2.3: Fix get_config_manager()
  â”‚         â”‚         â”‚    â†“
  â”‚         â”‚         â”‚    â””â”€&gt; Remove hardcoded DEVELOPMENT
  â”‚         â”‚         â”‚         â†“
  â”‚         â”‚         â”‚         â””â”€&gt; Task 2.4: Integration tests
  â”‚         â”‚         â”‚                  â†“
  â”‚         â”‚         â”‚                  âœ… Environment handling fixed
  â”‚         â”‚         â”‚
  â”‚         â”‚         â””â”€&gt; ENABLES: is_production() helper
  â”‚         â”‚                      is_testing() helper
  â”‚         â”‚                      is_development() helper
  â”‚         â”‚
  â”‚         â””â”€&gt; ENABLES: Production config usage
  â”‚                      Testing config usage
  â”‚                      Environment switching</code></pre>

<p><strong>Dependencies</strong>:</p>
<ul>
<li>Task 2.2 depends on Task 2.1 (enum must exist first)</li>
<li>Task 2.3 depends on Task 2.2 (init must work first)</li>
<li>Task 2.4 depends on Task 2.3 (all changes must be in place)</li>
</ul>

<p><strong>Blocks</strong>:</p>
<ul>
<li>Helper functions (is_production, is_testing)</li>
<li>Production config usage</li>
<li>Testing config usage</li>
</ul>

<p><strong>Time</strong>: 4 hours</p>
<p><strong>Risk</strong>: MEDIUM (behavior changes, needs testing)</p>

<p>---</p>

<h3>Path C: Dead Code Removal (Cleanup Path)</h3>

<pre><code>ğŸŸ¢ Unused Config Parameters
  â†“
  â”œâ”€&gt; Task 3.1: Remove from ContainerConfigs
  â”‚    â†“
  â”‚    â””â”€&gt; enable_auto_save (5 occurrences)
  â”‚         enable_all_rules (1 occurrence)
  â”‚         min_quality_score (2 occurrences)
  â”‚         enable_validation (testing only)
  â”‚         enable_enrichment (testing only)
  â”‚         â†“
  â”‚         âœ… Config simplified
  â”‚
  â””â”€&gt; Task 3.2: Fix or remove helper functions
       â†“
       â”œâ”€&gt; Option A: Remove unused helpers
       â”‚    â””â”€&gt; is_production()
       â”‚        is_testing()
       â”‚
       â””â”€&gt; Option B: Keep helpers (RECOMMENDED)
            â””â”€&gt; They now work after Phase 2
                 â†“
                 âœ… Dead code removed</code></pre>

<p><strong>Dependencies</strong>:</p>
<ul>
<li>Task 3.2 Option B depends on Phase 2 (enum fix)</li>
<li>Task 3.1 is independent</li>
</ul>

<p><strong>Blocks</strong>: Nothing</p>

<p><strong>Time</strong>: 2 hours</p>
<p><strong>Risk</strong>: LOW (verified unused)</p>

<p>---</p>

<h3>Path D: Documentation (Support Path)</h3>

<pre><code>ğŸ“š Documentation Gaps
  â†“
  â”œâ”€&gt; Task 4.1: Create config/README.md
  â”‚    â””â”€&gt; Environment selection guide
  â”‚        File structure explanation
  â”‚        Key differences table
  â”‚        Troubleshooting tips
  â”‚
  â”œâ”€&gt; Task 4.2: Update CLAUDE.md
  â”‚    â””â”€&gt; Environment variables section
  â”‚        Environment modes explanation
  â”‚        Default behavior documentation
  â”‚
  â””â”€&gt; Task 4.3: Create troubleshooting guide
       â””â”€&gt; Common symptoms and solutions
           Verification commands
           Debug procedures
            â†“
            âœ… Documentation complete</code></pre>

<p><strong>Dependencies</strong>:</p>
<ul>
<li>Should be done after Phase 2 (so docs are accurate)</li>
<li>Can be done in parallel with Phase 3</li>
</ul>

<p><strong>Blocks</strong>: Nothing</p>

<p><strong>Time</strong>: 2 hours</p>
<p><strong>Risk</strong>: NONE (documentation only)</p>

<p>---</p>

<h2>Critical Path Timeline</h2>

<pre><code>Day 1 (Today)
  â”œâ”€&gt; Phase 1: Security Fix (30 min)
  â”‚    â””â”€&gt; BLOCKER: Must be done first
  â”‚
  â””â”€&gt; Phase 2 Start: Fix Enum (1 hour)
       â””â”€&gt; Can begin immediately after security fix

Day 2-3 (This Week)
  â””â”€&gt; Phase 2 Continue: Fix ConfigManager + Tests (3 hours)
       â”œâ”€&gt; Task 2.2: Fix __init__ (1.5 hours)
       â”œâ”€&gt; Task 2.3: Fix singleton (1 hour)
       â””â”€&gt; Task 2.4: Integration tests (30 min)

Next Sprint (Week 2)
  â”œâ”€&gt; Phase 3: Dead Code Removal (2 hours)
  â”‚    â”œâ”€&gt; Task 3.1: Remove parameters (1 hour)
  â”‚    â””â”€&gt; Task 3.2: Fix helpers (1 hour)
  â”‚
  â””â”€&gt; Phase 4: Documentation (2 hours)
       â”œâ”€&gt; Task 4.1: config/README.md (1 hour)
       â”œâ”€&gt; Task 4.2: CLAUDE.md (30 min)
       â””â”€&gt; Task 4.3: Troubleshooting (30 min)</code></pre>

<p><strong>Total Time</strong>: 8.5 hours across 2 weeks</p>
<p><strong>Critical Path</strong>: Phase 1 â†’ Phase 2 (must be sequential)</p>
<p><strong>Parallel Work</strong>: Phase 3 and Phase 4 can overlap</p>

<p>---</p>

<h2>Blocking Relationships</h2>

<h3>What Blocks What</h3>

<p>| Blocker | Blocks | Reason |</p>
<p>|---------|--------|--------|</p>
<p>| Phase 1 (Security) | Nothing | Independent fix |</p>
<p>| Phase 2.1 (Enum) | Phase 2.2 (ConfigManager) | Enum values must exist |</p>
<p>| Phase 2.2 (ConfigManager) | Phase 2.3 (Singleton) | Init must work first |</p>
<p>| Phase 2 (All) | Phase 3.2 Option B | Helpers need enum fix |</p>
<p>| Phase 2 (All) | Phase 4 | Docs should reflect reality |</p>
<p>| Phase 3 | Nothing | Can be done anytime |</p>

<h3>What Can Run In Parallel</h3>

<p>| Phase | Can Parallel With | Notes |</p>
<p>|-------|------------------|-------|</p>
<p>| Phase 1 | Nothing | Should be done first |</p>
<p>| Phase 2 | Nothing | Sequential tasks |</p>
<p>| Phase 3 | Phase 4 | Both are cleanup |</p>
<p>| Phase 4 | Phase 3 | Both are low-priority |</p>

<p>---</p>

<h2>Rollback Dependencies</h2>

<pre><code>Phase 4 Rollback (Docs)
  â””â”€&gt; No code impact, just revert docs

Phase 3 Rollback (Dead Code)
  â””â”€&gt; Revert container.py changes
       â””â”€&gt; No downstream impact

Phase 2 Rollback (Environment)
  â”œâ”€&gt; Revert config_manager.py changes
  â”‚    â””â”€&gt; Reverts to hardcoded DEVELOPMENT
  â”‚         â””â”€&gt; App still works (current behavior)
  â”‚
  â””â”€&gt; If Phase 3 Option B done:
       â””â”€&gt; Helper functions break again
            â””â”€&gt; Must rollback Phase 3.2 too

Phase 1 Rollback (Security)
  â””â”€&gt; Set OPENAI_API_KEY env variable
       â””â”€&gt; App still works (env override exists)</code></pre>

<p><strong>Rollback Risk</strong>: LOW</p>
<ul>
<li>All phases can be rolled back independently</li>
<li>Worst case: Revert to current (working) state</li>
</ul>

<p>---</p>

<h2>Testing Dependencies</h2>

<pre><code>Phase 1 Tests
  â””â”€&gt; Manual only (no code changes)
       â”œâ”€&gt; App runs with env variable
       â””â”€&gt; Pre-commit hook catches keys

Phase 2 Tests
  â””â”€&gt; Unit tests (10 tests)
       â”œâ”€&gt; Enum values
       â”œâ”€&gt; ConfigManager init
       â”œâ”€&gt; Helper functions
       â””â”€&gt; Singleton behavior
  â””â”€&gt; Integration tests (5 tests)
       â”œâ”€&gt; Config consistency
       â”œâ”€&gt; Environment switching
       â””â”€&gt; Default behavior
  â””â”€&gt; Manual tests
       â”œâ”€&gt; Development mode
       â”œâ”€&gt; Production mode
       â””â”€&gt; Testing mode

Phase 3 Tests
  â””â”€&gt; Verification tests
       â”œâ”€&gt; Grep for removed params (0 matches)
       â””â”€&gt; Update existing tests
  â””â”€&gt; Smoke tests
       â””â”€&gt; Full test suite passes

Phase 4 Tests
  â””â”€&gt; Documentation review
       â”œâ”€&gt; Accuracy check
       â”œâ”€&gt; Link verification
       â””â”€&gt; Completeness check</code></pre>

<p>---</p>

<h2>Success Criteria Dependencies</h2>

<pre><code>âœ… Phase 1 Complete When:
  â”œâ”€&gt; API key rotated at OpenAI
  â”œâ”€&gt; Hardcoded key removed from config
  â”œâ”€&gt; Pre-commit hook added
  â”œâ”€&gt; App runs with env variable
  â””â”€&gt; Changes committed to git

âœ… Phase 2 Complete When:
  â”œâ”€&gt; Enum has 3 values (DEVELOPMENT, PRODUCTION, TESTING)
  â”œâ”€&gt; ConfigManager respects APP_ENV
  â”œâ”€&gt; Default is PRODUCTION
  â”œâ”€&gt; Helper functions work without crash
  â”œâ”€&gt; 15 tests pass (10 unit + 5 integration)
  â””â”€&gt; App runs in all 3 modes

âœ… Phase 3 Complete When:
  â”œâ”€&gt; 5 unused parameters removed
  â”œâ”€&gt; Grep shows 0 matches for removed params
  â”œâ”€&gt; Helper functions work (or removed)
  â”œâ”€&gt; All tests pass
  â””â”€&gt; No regression in functionality

âœ… Phase 4 Complete When:
  â”œâ”€&gt; config/README.md exists and accurate
  â”œâ”€&gt; CLAUDE.md updated with environment section
  â”œâ”€&gt; Troubleshooting guide exists
  â”œâ”€&gt; All links work
  â””â”€&gt; Documentation reviewed for accuracy</code></pre>

<p>---</p>

<h2>Risk Propagation</h2>

<pre><code>Phase 1 Failure
  â””â”€&gt; Impact: API key remains exposed
       â””â”€&gt; Risk: Security compromise
            â””â”€&gt; Mitigation: Can be attempted multiple times
                 â””â”€&gt; Blocker: None (can proceed with other phases)

Phase 2 Failure
  â””â”€&gt; Impact: Environment handling remains broken
       â””â”€&gt; Risk: App uses wrong settings in production
            â””â”€&gt; Mitigation: Rollback to current state
                 â””â”€&gt; Blocker: Phase 3.2 Option B, Phase 4

Phase 3 Failure
  â””â”€&gt; Impact: Dead code remains in codebase
       â””â”€&gt; Risk: Confusion for future developers
            â””â”€&gt; Mitigation: Keep dead code (low impact)
                 â””â”€&gt; Blocker: None

Phase 4 Failure
  â””â”€&gt; Impact: Documentation incomplete
       â””â”€&gt; Risk: User confusion
            â””â”€&gt; Mitigation: Use existing docs
                 â””â”€&gt; Blocker: None</code></pre>

<p>---</p>

<h2>Conclusion</h2>

<p><strong>Critical Path</strong>: Phase 1 â†’ Phase 2.1 â†’ Phase 2.2 â†’ Phase 2.3 â†’ Phase 2.4</p>

<p><strong>Parallelizable</strong>: Phase 3 || Phase 4 (after Phase 2)</p>

<p><strong>Minimum Viable Fix</strong>: Phase 1 + Phase 2</p>
<ul>
<li>Resolves security issue</li>
<li>Fixes environment handling</li>
<li>Makes app production-ready</li>
</ul>

<p><strong>Complete Solution</strong>: All 4 Phases</p>
<ul>
<li>Security fixed</li>
<li>Environment handling works</li>
<li>Dead code removed</li>
<li>Documentation complete</li>
</ul>

<p><strong>Recommended Approach</strong>: Execute in order, with Phase 3+4 in parallel</p>

<p>---</p>

<p><strong>Generated</strong>: 2025-10-07</p>
<p><strong>Purpose</strong>: Guide implementation sequencing and dependency management</p>

  </div>
</body>
</html>