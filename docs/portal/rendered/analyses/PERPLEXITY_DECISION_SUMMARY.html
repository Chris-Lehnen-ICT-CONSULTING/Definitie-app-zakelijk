<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Perplexity API Decision Summary</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">â† Terug naar Portal</a>
    <h1>Perplexity API Decision Summary</h1>

<p><strong>Date</strong>: 2025-10-09</p>
<p><strong>Decision</strong>: âŒ <strong>NO-GO</strong></p>
<p><strong>Alternative</strong>: âœ… Fix Brave Search + Optimize Current Providers</p>

<p>---</p>

<h2>TL;DR</h2>

<p><strong>Question</strong>: Should we integrate Perplexity API for Nederlandse juridische definitie lookup?</p>

<p><strong>Answer</strong>: <strong>NO</strong> - Perplexity offers NO significant advantage over current providers (Wikipedia, Overheid.nl, Rechtspraak.nl) and introduces costs ($5-180/month) + vendor lock-in without proven ROI.</p>

<p><strong>Better Alternative</strong>: Fix Brave Search direct API (FREE 2k queries/month) + expand Wikipedia synoniemen database.</p>

<p>---</p>

<h2>Decision Matrix</h2>

<p>| Criterion | Weight | Perplexity | Current Providers | Winner |</p>
<p>|-----------|--------|-----------|-------------------|---------|</p>
<p>| Cost | 0.25 | 2/10 ($) | 10/10 (FREE) | <strong>Current</strong> |</p>
<p>| NL Juridisch | 0.30 | 5/10 (?) | 9/10 (proven) | <strong>Current</strong> |</p>
<p>| Integration | 0.15 | 6/10 | 10/10 (done) | <strong>Current</strong> |</p>
<p>| Latency | 0.10 | 4/10 (2-4s) | 9/10 (0.5-2s) | <strong>Current</strong> |</p>
<p>| Reliability | 0.20 | 5/10 (AI risk) | 9/10 (authoritative) | <strong>Current</strong> |</p>
<p>| <strong>TOTAL</strong> | 1.00 | <strong>4.3/10</strong> | <strong>9.1/10</strong> | <strong>Current Providers</strong> |</p>

<p><strong>Threshold</strong>: 6.0/10 required for GO â†’ <strong>4.3 < 6.0</strong> = NO-GO</p>

<p>---</p>

<h2>Key Findings</h2>

<h3>What Perplexity CAN'T do better:</h3>

<p>âŒ <strong>Nederlandse juridische indexering</strong> - No proof of better coverage than Wikipedia/Overheid.nl</p>
<p>âŒ <strong>Authoritative sources</strong> - Overheid.nl (1.0 weight) > Perplexity (0.75 max)</p>
<p>âŒ <strong>Cost</strong> - $5/1k queries vs FREE current providers</p>
<p>âŒ <strong>Latency</strong> - 2-4s (LLM) vs 0.5-2s (current)</p>
<p>âŒ <strong>ECLI integration</strong> - Rechtspraak.nl REST is faster + native</p>
<p>âŒ <strong>Free tier</strong> - None (requires credit card)</p>

<h3>What Current Providers DO better:</h3>

<p>âœ… <strong>Wikipedia + 476 weighted synoniemen</strong> - "onherroepelijk" â†’ "kracht van gewijsde" (proven Oct 2025)</p>
<p>âœ… <strong>Overheid.nl 100% hit rate</strong> - Official government source</p>
<p>âœ… <strong>Rechtspraak.nl 100% hit rate</strong> - Primary jurisprudence source</p>
<p>âœ… <strong>No cost, no vendor lock-in</strong></p>
<p>âœ… <strong>73-80% faster</strong> after Oct 2025 optimizations (7.6s â†’ 1.5-2s)</p>

<p>---</p>

<h2>Cost Comparison</h2>

<h3>Perplexity API</h3>

<p><strong>Search API</strong>: $5 per 1,000 requests</p>
<p><strong>Sonar Pro (LLM)</strong>: $6 per 1,000 requests + token costs</p>

<p><strong>Projected Costs</strong>:</p>
<ul>
<li>Development: 10 queries/day â†’ **$1.50/month** ($18/year)</li>
<li>Production (100 users): 1k queries/day â†’ **$150/month** ($1,800/year)</li>
</ul>

<h3>Current Providers</h3>

<p><strong>Total Cost</strong>: <strong>$0.00</strong></p>

<ul>
<li>Wikipedia API: FREE, unlimited</li>
<li>Overheid.nl SRU: FREE, unlimited</li>
<li>Rechtspraak.nl REST: FREE, unlimited</li>
</ul>

<p><strong>ROI</strong>: <strong>NEGATIVE</strong> (costs without proven benefit)</p>

<p>---</p>

<h2>Recommended Action Plan</h2>

<h3>INSTEAD of Perplexity â†’ DO THIS:</h3>

<h4>1. Fix Brave Search (2-3 hours) - PRIORITY 1</h4>

<p><strong>Problem</strong>: MCP tool not working</p>
<p><strong>Solution</strong>: Direct Brave API call (no MCP dependency)</p>

<pre><code># Direct API implementation (no MCP wrapper)
async def brave_direct_search(query: str):
    response = await httpx.get(
        "https://api.search.brave.com/res/v1/web/search",
        headers={"X-Subscription-Token": BRAVE_API_KEY},
        params={"q": query, "count": 5}
    )
    return response.json()</code></pre>

<p><strong>Benefits</strong>:</p>
<ul>
<li>âœ… FREE TIER: 2,000 queries/month</li>
<li>âœ… Same cost at scale: $5/1k (identical to Perplexity)</li>
<li>âœ… No vendor lock-in (already implemented, just fix wrapper)</li>
<li>âœ… Lower latency vs Perplexity (~1-2s vs 2-4s)</li>
</ul>

<p><strong>Effort</strong>: 2-3 uur vs 4-6 uur Perplexity</p>
<p><strong>Cost</strong>: $0 vs $18-2,160/year Perplexity</p>

<p>---</p>

<h4>2. Expand Wikipedia Synoniemen (ongoing)</h4>

<p><strong>Current</strong>: 476 weighted synoniemen (v2.0)</p>
<p><strong>Target</strong>: +100 synoniemen/month via GPT-4 suggest + approve workflow</p>

<p><strong>Already Implemented</strong>:</p>
<pre><code>python scripts/batch_suggest_synonyms.py data/test_terms.csv</code></pre>

<p><strong>Benefits</strong>:</p>
<ul>
<li>âœ… Proven effective (Oct 2025): "onherroepelijk" â†’ "kracht van gewijsde"</li>
<li>âœ… No ongoing cost (one-time GPT-4, human approval)</li>
<li>âœ… Better ROI than paid API</li>
</ul>

<p><strong>Effort</strong>: 1-2 uur/batch (already in workflow)</p>

<p>---</p>

<h4>3. Implement Tiered Cascade (3-4 hours)</h4>

<p><strong>Current</strong>: All providers parallel (some timeout wasted)</p>
<p><strong>Proposed</strong>: Early exit if sufficient results</p>

<pre><code># Tier 1 (Authoritative): 2s timeout
results = await parallel_lookup([overheid, rechtspraak])
if len(results) &gt;= 3:
    return results  # â† 60-70% queries exit here

# Tier 2 (Encyclopedia): 3s timeout
results += await parallel_lookup([wikipedia, brave])
return results</code></pre>

<p><strong>Expected Impact</strong>: 30-40% faster avg response time</p>

<p>---</p>

<h2>Risk Assessment</h2>

<h3>Perplexity Risks</h3>

<p>| Risk | Severity | Likelihood |</p>
<p>|------|----------|------------|</p>
<p>| Vendor lock-in | ğŸ”´ HIGH | ğŸŸ¡ MEDIUM |</p>
<p>| No ROI | ğŸ”´ HIGH | ğŸ”´ HIGH |</p>
<p>| Hallucination (Sonar) | ğŸ”´ CRITICAL | ğŸŸ¡ MEDIUM |</p>
<p>| Cost overrun | ğŸŸ¡ MEDIUM | ğŸŸ¡ MEDIUM |</p>

<p><strong>Overall</strong>: ğŸ”´ <strong>HIGH RISK</strong> (vendor lock-in + unproven ROI)</p>

<h3>Alternative Risks</h3>

<p>| Risk | Severity | Likelihood |</p>
<p>|------|----------|------------|</p>
<p>| Brave API change | ğŸŸ¡ MEDIUM | ğŸŸ¢ LOW |</p>
<p>| Synoniemen maintenance | ğŸŸ¢ LOW | ğŸŸ¡ MEDIUM |</p>
<p>| Tiered cascade complexity | ğŸŸ¢ LOW | ğŸŸ¢ LOW |</p>

<p><strong>Overall</strong>: ğŸŸ¢ <strong>LOW RISK</strong> (manageable, no vendor lock-in)</p>

<p>---</p>

<h2>Test Case: "onherroepelijk" in Strafrecht Context</h2>

<h3>Perplexity (Hypothetical)</h3>

<pre><code>{
  "provider": "Perplexity Sonar Pro",
  "answer": "Een onherroepelijk vonnis is...",
  "sources": [
    "https://nl.wikipedia.org/wiki/...",  // â† SAME as current
    "https://www.rechtspraak.nl/..."     // â† SAME as current
  ],
  "cost": "$0.005",
  "latency": "2-4s",
  "hallucination_risk": "MEDIUM"
}</code></pre>

<h3>Current Providers (After Oct 2025 Optimizations)</h3>

<pre><code>{
  "results": [
    {
      "provider": "Wikipedia",
      "term": "Kracht van gewijsde",  // â† Synoniemen match
      "confidence": 0.88,
      "source": "https://nl.wikipedia.org/wiki/..."
    },
    {
      "provider": "Overheid.nl",
      "confidence": 0.85,
      "metadata": {"dc:identifier": "..."}
    },
    {
      "provider": "Rechtspraak.nl",
      "confidence": 0.82,
      "metadata": {"ecli": "ECLI:NL:HR:2023:456"}
    }
  ],
  "cost": "$0.00",
  "latency": "1.5-2.0s",
  "hit_rate": "100%"
}</code></pre>

<p><strong>Conclusion</strong>: Current providers deliver <strong>SAME or BETTER results</strong> at <strong>ZERO cost</strong> and <strong>faster latency</strong>.</p>

<p>---</p>

<h2>Final Recommendation</h2>

<h3>Decision: âŒ NO-GO (Perplexity API)</h3>

<p><strong>Rationale</strong>:</p>
<ol>
<li>ğŸ’° Costs $18-2,160/year vs $0 current providers</li>
<li>ğŸ‡³ğŸ‡± No proven advantage for NL juridische content</li>
<li>ğŸ”’ Vendor lock-in without exit strategy</li>
<li>ğŸŒ Slower than current providers (2-4s vs 1.5-2s)</li>
<li>ğŸ­ Hallucination risk unacceptable for juridische context</li>
</ol>

<h3>Alternative: âœ… Fix Brave + Optimize Current</h3>

<p><strong>Priority Actions</strong>:</p>
<ol>
<li>Fix Brave Search direct API (2-3 uur, FREE 2k/month)</li>
<li>Expand synoniemen database (ongoing, proven ROI)</li>
<li>Implement tiered cascade (3-4 uur, 30-40% faster)</li>
</ol>

<p><strong>Expected Results</strong>:</p>
<ul>
<li>Response time: -40% (cascade + caching)</li>
<li>Recall: +15% (synoniemen + Brave fix)</li>
<li>Quality: +20% (better ranking + filters)</li>
<li>Cost: **$0**</li>
</ul>

<p>---</p>

<h2>References</h2>

<ul>
<li>**Full Analysis**: `docs/analyses/PERPLEXITY_API_FEASIBILITY_ANALYSIS.md`</li>
<li>**Provider Strategy**: `docs/analyses/PROVIDER_PRIORITY_STRATEGY.md`</li>
<li>**Current Config**: `config/web_lookup_defaults.yaml`</li>
<li>**Synoniemen Database**: `config/juridische_synoniemen.yaml` (476 lines)</li>
</ul>

<p>---</p>

<p><strong>Status</strong>: âœ… DECISION DOCUMENTED</p>
<p><strong>Next Review</strong>: 2025-Q2 (if market conditions change)</p>
<p><strong>Confidence</strong>: ğŸŸ¢ HIGH (based on cost/benefit analysis + current performance)</p>

  </div>
</body>
</html>