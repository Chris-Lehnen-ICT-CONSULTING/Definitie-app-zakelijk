<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ontological Classifier - Standalone Architecture</title>
  <link rel="stylesheet" href="../portal.css" />
  <style>
    .doc { max-width: 900px; margin: 16px auto 48px auto; padding: 0 16px; }
    .doc h1,.doc h2,.doc h3,.doc h4{ color:#223 }
    .doc p{ line-height:1.6; color:#222 }
    .doc a{ color:#1d4ed8; text-decoration: underline; }
    .doc pre{ background:#0b1020; color:#e6edf3; padding:12px; overflow:auto; border-radius:8px }
    .doc code{ background:#f0f2f5; padding:2px 6px; border-radius:4px }
    .back{ display:inline-block; margin:12px 0; padding:6px 10px; border:1px solid #ccd; border-radius:6px; text-decoration:none; color:#223; background:#f8f9fb }
  </style>
</head>
<body>
  <div class="doc">
    <a class="back" href="../../index.html">â† Terug naar Portal</a>
    <h1>Ontological Classifier - Standalone Architecture</h1>

<p><strong>Datum</strong>: 2025-10-07</p>
<p><strong>Status</strong>: Design Proposal</p>
<p><strong>Auteur</strong>: Claude Code</p>

<h2>Executive Summary</h2>

<p>De <strong>OntologicalClassifier</strong> is een <strong>standalone, first-class service</strong> die juridische begrippen classificeert in ontologische niveaus (U/F/O) <strong>VOOR</strong> definitie generatie. Het niveau bepaalt welke prompt template wordt gebruikt, daarom moet classificatie ALTIJD voor generatie gebeuren.</p>

<h3>Key Decisions</h3>

<ol>
<li>**Standalone Service** - Niet genest in orchestrator, maar top-level service in DI container</li>
<li>**Pre-Generation** - Altijd classificeren VOOR `create_definition()` call</li>
<li>**Herbruikbaar** - Beschikbaar via DI voor UI, CLI, batch processing, validatie</li>
<li>**Optional Facade** - ServiceAdapter combineert classificatie + generatie voor convenience (niet verplicht)</li>
</ol>

<p>---</p>

<h2>1. Architectuur Overzicht</h2>

<h3>Component Stack</h3>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI LAYER                                 â”‚
â”‚  - tabbed_interface.py                                      â”‚
â”‚  - definition_generator_tab.py                              â”‚
â”‚                                                             â”‚
â”‚  Flow:                                                      â”‚
â”‚  1. Haal classifier uit container                          â”‚
â”‚  2. classifier.classify(begrip, contexts)                  â”‚
â”‚  3. Toon result aan gebruiker (optioneel)                  â”‚
â”‚  4. Zet result.to_string_level() in GenerationRequest      â”‚
â”‚  5. orchestrator.create_definition(request)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DEPENDENCY INJECTION LAYER                     â”‚
â”‚                                                             â”‚
â”‚  ServiceContainer (src/services/container.py)               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ontological_     â”‚  â”‚ orchestrator()   â”‚               â”‚
â”‚  â”‚ classifier()     â”‚  â”‚                  â”‚               â”‚
â”‚  â”‚                  â”‚  â”‚ Returns:         â”‚               â”‚
â”‚  â”‚ Returns:         â”‚  â”‚ Definition       â”‚               â”‚
â”‚  â”‚ Ontological      â”‚  â”‚ OrchestratorV2   â”‚               â”‚
â”‚  â”‚ Classifier       â”‚  â”‚                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚           â†“                      â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ service_adapter() [OPTIONAL]         â”‚                  â”‚
â”‚  â”‚                                      â”‚                  â”‚
â”‚  â”‚ Facade combining:                   â”‚                  â”‚
â”‚  â”‚ - ontological_classifier()          â”‚                  â”‚
â”‚  â”‚ - orchestrator()                    â”‚                  â”‚
â”‚  â”‚                                      â”‚                  â”‚
â”‚  â”‚ Methods:                             â”‚                  â”‚
â”‚  â”‚ - generate_with_auto_classification()â”‚                  â”‚
â”‚  â”‚ - generate_with_classification()    â”‚                  â”‚
â”‚  â”‚ - classify_only()                   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SERVICE LAYER                              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ OntologicalClassifier                                 â”‚ â”‚
â”‚  â”‚ (src/services/classification/ontological_classifier.py)â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ Methods:                                              â”‚ â”‚
â”‚  â”‚ - classify(begrip, contexts) â†’ ClassificationResult  â”‚ â”‚
â”‚  â”‚ - classify_batch(begrippen) â†’ dict[str, Result]      â”‚ â”‚
â”‚  â”‚ - validate_existing_definition(...)                  â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ Dependencies:                                         â”‚ â”‚
â”‚  â”‚ - AIServiceV2 (for prompts)                          â”‚ â”‚
â”‚  â”‚ - LevelClassifier (business logic)                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ DefinitionOrchestratorV2                              â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ create_definition(request: GenerationRequest)        â”‚ â”‚
â”‚  â”‚   - request.ontologische_categorie â†’ prompt template â”‚ â”‚
â”‚  â”‚   - Gebruikt categorie voor prompt selection         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DOMAIN LAYER                               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ LevelClassifier                                       â”‚ â”‚
â”‚  â”‚ (src/toetsregels/level_classifier.py)                â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ Business logic voor U/F/O classificatie               â”‚ â”‚
â”‚  â”‚ - Score generation via AI prompts                    â”‚ â”‚
â”‚  â”‚ - Rationale generation                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ClassificationResult (dataclass)                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ - level: OntologicalLevel (U/F/O)                    â”‚ â”‚
â”‚  â”‚ - confidence: float (0.0-1.0)                        â”‚ â”‚
â”‚  â”‚ - confidence_level: HIGH/MEDIUM/LOW                  â”‚ â”‚
â”‚  â”‚ - rationale: str                                     â”‚ â”‚
â”‚  â”‚ - scores: dict[str, float]                           â”‚ â”‚
â”‚  â”‚ - metadata: dict                                     â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ Methods:                                              â”‚ â”‚
â”‚  â”‚ - is_reliable: bool                                  â”‚ â”‚
â”‚  â”‚ - to_string_level() â†’ str                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<p>---</p>

<h2>2. Data Flow - Complete Workflow</h2>

<h3>2.1 Standard Flow (Via UI)</h3>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 1: GEBRUIKER INPUT (UI)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Gebruiker vult in:                                          â”‚
â”‚  - begrip: "Overeenkomst"                                    â”‚
â”‚  - organisatorische_context: "Gemeente administratie"        â”‚
â”‚  - juridische_context: "Burgerlijk wetboek"                  â”‚
â”‚  - wettelijke_context: "..."                                 â”‚
â”‚  - voorbeelden: ["...", "..."]                               â”‚
â”‚                                                              â”‚
â”‚  Klikt op: "Genereer Definitie"                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 2: ONTOLOGISCHE CLASSIFICATIE (PRE-GENERATION)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  # Haal classifier uit DI                                    â”‚
â”‚  container = st.session_state.service_container              â”‚
â”‚  classifier = container.ontological_classifier()             â”‚
â”‚                                                              â”‚
â”‚  # Classificeer begrip                                       â”‚
â”‚  result = classifier.classify(                               â”‚
â”‚      begrip="Overeenkomst",                                  â”‚
â”‚      organisatorische_context="Gemeente administratie",      â”‚
â”‚      juridische_context="Burgerlijk wetboek"                 â”‚
â”‚  )                                                           â”‚
â”‚                                                              â”‚
â”‚  # Result bevat:                                             â”‚
â”‚  # - level: OntologicalLevel.FUNCTIONEEL                     â”‚
â”‚  # - confidence: 0.89                                        â”‚
â”‚  # - confidence_level: ClassificationConfidence.HIGH         â”‚
â”‚  # - rationale: "Overeenkomst is functioneel omdat..."       â”‚
â”‚  # - scores: {U: 0.08, F: 0.89, O: 0.03}                     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 3: TOON CLASSIFICATIE AAN GEBRUIKER (OPTIONEEL)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  UI toont:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”¶ Niveau: F (Functioneel)                             â”‚ â”‚
â”‚  â”‚ Betrouwbaarheid: HIGH (89%)                            â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Waarom dit niveau?                                     â”‚ â”‚
â”‚  â”‚ "Overeenkomst is een functioneel begrip omdat het      â”‚ â”‚
â”‚  â”‚  specifiek is voor juridische processen maar niet      â”‚ â”‚
â”‚  â”‚  organisatie-specifiek..."                             â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ [â˜] Handmatig niveau selecteren?                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  Optioneel: Gebruiker kan override doen als confidence laag â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 4: BOUW GENERATION REQUEST (MET CLASSIFICATIE)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  request = GenerationRequest(                                â”‚
â”‚      begrip="Overeenkomst",                                  â”‚
â”‚      ontologische_categorie=result.to_string_level(), # "F"  â”‚
â”‚      organisatorische_context="Gemeente administratie",      â”‚
â”‚      juridische_context="Burgerlijk wetboek",                â”‚
â”‚      wettelijke_context="...",                               â”‚
â”‚      voorbeelden=["...", "..."],                             â”‚
â”‚      document_context=None                                   â”‚
â”‚  )                                                           â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 5: GENEREER DEFINITIE (GEBRUIKT CLASSIFICATIE)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  # Haal orchestrator uit DI                                  â”‚
â”‚  orchestrator = container.orchestrator()                     â”‚
â”‚                                                              â”‚
â”‚  # Genereer definitie                                        â”‚
â”‚  response = await orchestrator.create_definition(request)    â”‚
â”‚                                                              â”‚
â”‚  # Intern in orchestrator:                                   â”‚
â”‚  # 1. request.ontologische_categorie = "F"                   â”‚
â”‚  # 2. Selecteer FUNCTIONEEL prompt template                  â”‚
â”‚  # 3. Bouw prompt met template                               â”‚
â”‚  # 4. Roep AI service aan                                    â”‚
â”‚  # 5. Valideer resultaat                                     â”‚
â”‚  # 6. Return GenerationResponse                              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAP 6: TOON RESULTAAT AAN GEBRUIKER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  if response.success:                                        â”‚
â”‚      st.success("âœ… Definitie gegenereerd!")                 â”‚
â”‚      st.write(response.definition_text)                      â”‚
â”‚                                                              â”‚
â”‚      # Toon validatie resultaten                             â”‚
â”‚      if response.validation_passed:                          â”‚
â”‚          st.success("âœ… Alle validatieregels geslaagd!")     â”‚
â”‚                                                              â”‚
â”‚      # Toon classificatie info                               â”‚
â”‚      st.info(f"Gegenereerd met {result.level.value} niveau") â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<h3>2.2 Batch Processing Flow</h3>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BATCH CLASSIFICATIE WORKFLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  # Input: CSV met begrippen                                  â”‚
â”‚  begrippen = ["Overeenkomst", "Perceel", "Rechtspersoon"]   â”‚
â”‚                                                              â”‚
â”‚  # Haal classifier                                           â”‚
â”‚  classifier = container.ontological_classifier()             â”‚
â”‚                                                              â”‚
â”‚  # Classificeer in batch                                     â”‚
â”‚  results = classifier.classify_batch(                        â”‚
â”‚      begrippen=begrippen,                                    â”‚
â”‚      shared_context=("Gemeente admin", "BW")                 â”‚
â”‚  )                                                           â”‚
â”‚                                                              â”‚
â”‚  # Results bevat:                                            â”‚
â”‚  # {                                                         â”‚
â”‚  #   "Overeenkomst": ClassificationResult(F, 0.89, ...),     â”‚
â”‚  #   "Perceel": ClassificationResult(O, 0.92, ...),          â”‚
â”‚  #   "Rechtspersoon": ClassificationResult(U, 0.95, ...)     â”‚
â”‚  # }                                                         â”‚
â”‚                                                              â”‚
â”‚  # Export naar CSV                                           â”‚
â”‚  df = pd.DataFrame([                                         â”‚
â”‚      {                                                       â”‚
â”‚          "begrip": begrip,                                   â”‚
â”‚          "niveau": result.level.value,                       â”‚
â”‚          "confidence": result.confidence                     â”‚
â”‚      }                                                       â”‚
â”‚      for begrip, result in results.items()                   â”‚
â”‚  ])                                                          â”‚
â”‚                                                              â”‚
â”‚  df.to_csv("classificatie_resultaten.csv")                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<h3>2.3 Validation Flow (Bestaande Definities)</h3>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDATIE VAN BESTAANDE DEFINITIES                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  # Haal bestaande definities uit DB                          â”‚
â”‚  repo = container.repository()                               â”‚
â”‚  definitions = repo.get_all()                                â”‚
â”‚                                                              â”‚
â”‚  # Haal classifier                                           â”‚
â”‚  classifier = container.ontological_classifier()             â”‚
â”‚                                                              â”‚
â”‚  # Valideer elke definitie                                   â”‚
â”‚  mismatches = []                                             â”‚
â”‚  for definition in definitions:                              â”‚
â”‚      is_correct, reason = classifier.validate_existing_(     â”‚
â”‚          begrip=definition.begrip,                           â”‚
â”‚          claimed_level=definition.ontologische_categorie,    â”‚
â”‚          definition_text=definition.definitie                â”‚
â”‚      )                                                       â”‚
â”‚                                                              â”‚
â”‚      if not is_correct:                                      â”‚
â”‚          mismatches.append({                                 â”‚
â”‚              "begrip": definition.begrip,                    â”‚
â”‚              "claimed": definition.ontologische_categorie,   â”‚
â”‚              "reason": reason                                â”‚
â”‚          })                                                  â”‚
â”‚                                                              â”‚
â”‚  # Rapporteer mismatches                                     â”‚
â”‚  print(f"Found {len(mismatches)} classification errors")     â”‚
â”‚  for mismatch in mismatches:                                 â”‚
â”‚      print(f"  - {mismatch['begrip']}: {mismatch['reason']}") â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<p>---</p>

<h2>3. API Design</h2>

<h3>3.1 OntologicalClassifier API</h3>

<pre><code>class OntologicalClassifier:
    """Standalone service voor ontologische classificatie"""

    def __init__(self, ai_service: AIServiceV2):
        """
        Args:
            ai_service: AIServiceV2 voor prompt-based scoring
        """

    def classify(
        self,
        begrip: str,
        organisatorische_context: Optional[str] = None,
        juridische_context: Optional[str] = None
    ) -&gt; ClassificationResult:
        """
        Classificeer begrip in U/F/O niveau

        Args:
            begrip: Te classificeren begrip
            organisatorische_context: Optionele org context
            juridische_context: Optionele jur context

        Returns:
            ClassificationResult met niveau, confidence, rationale

        Raises:
            ValueError: Als begrip leeg
            RuntimeError: Als classificatie faalt
        """

    def classify_batch(
        self,
        begrippen: list[str],
        shared_context: Optional[tuple[str, str]] = None
    ) -&gt; dict[str, ClassificationResult]:
        """
        Classificeer meerdere begrippen

        Args:
            begrippen: Lijst van begrippen
            shared_context: Optionele (org_ctx, jur_ctx) tuple

        Returns:
            Dict mapping begrip â†’ ClassificationResult
        """

    def validate_existing_definition(
        self,
        begrip: str,
        claimed_level: str,
        definition_text: str
    ) -&gt; tuple[bool, Optional[str]]:
        """
        Valideer of bestaande definitie correct geclassificeerd is

        Args:
            begrip: Begrip naam
            claimed_level: Beweerd niveau ("U"/"F"/"O")
            definition_text: Definitie tekst

        Returns:
            (is_correct, mismatch_reason) tuple
        """</code></pre>

<h3>3.2 ClassificationResult API</h3>

<pre><code>@dataclass
class ClassificationResult:
    """Resultaat van ontologische classificatie"""

    level: OntologicalLevel           # U/F/O enum
    confidence: float                  # 0.0-1.0
    confidence_level: ClassificationConfidence  # HIGH/MEDIUM/LOW
    rationale: str                     # Menselijk leesbare uitleg
    scores: dict[str, float]          # {U: 0.08, F: 0.89, O: 0.03}
    metadata: Optional[dict] = None   # Extra context

    @property
    def is_reliable(self) -&gt; bool:
        """Is classificatie betrouwbaar (confidence &gt;= 60%)?"""

    def to_string_level(self) -&gt; str:
        """Converteer naar string voor GenerationRequest"""
        # Returns: "U", "F", of "O"</code></pre>

<h3>3.3 ServiceAdapter API (Optional)</h3>

<pre><code>class ServiceAdapter:
    """Optionele facade voor classificatie + generatie"""

    def __init__(
        self,
        classifier: OntologicalClassifier,
        orchestrator: DefinitionOrchestratorV2
    ):
        """Initialiseer met dependencies"""

    async def generate_with_auto_classification(
        self,
        begrip: str,
        **contexts
    ) -&gt; tuple[GenerationResponse, ClassificationResult]:
        """
        Classificeer + genereer in Ã©Ã©n call

        Returns:
            (response, classification) tuple
        """

    async def generate_with_classification(
        self,
        classification: ClassificationResult,
        begrip: str,
        **contexts
    ) -&gt; GenerationResponse:
        """
        Genereer met bestaande classificatie

        Gebruik als je classificatie al hebt gedaan
        """

    def classify_only(
        self,
        begrip: str,
        **contexts
    ) -&gt; ClassificationResult:
        """Alleen classificeren, niet genereren"""</code></pre>

<p>---</p>

<h2>4. Dependency Injection Setup</h2>

<h3>4.1 ServiceContainer Wijzigingen</h3>

<p><strong>Bestand</strong>: <code>src/services/container.py</code></p>

<pre><code>class ServiceContainer:
    """DI container met ontological classifier"""

    def ontological_classifier(self):
        """
        Get or create OntologicalClassifier instance.

        Returns:
            Singleton instance van OntologicalClassifier
        """
        if "ontological_classifier" not in self._instances:
            from services.classification.ontological_classifier import (
                OntologicalClassifier
            )
            from services.ai_service_v2 import AIServiceV2

            # Reuse AI service met generator config
            ai_service = AIServiceV2(
                default_model=self.generator_config.gpt.model,
                use_cache=True
            )

            self._instances["ontological_classifier"] = OntologicalClassifier(
                ai_service
            )

            logger.info("OntologicalClassifier (standalone) initialized")

        return self._instances["ontological_classifier"]

    def service_adapter(self):
        """
        Get or create ServiceAdapter instance (optional).

        Returns:
            Singleton instance van ServiceAdapter
        """
        if "service_adapter" not in self._instances:
            from services.service_adapter import ServiceAdapter

            classifier = self.ontological_classifier()
            orchestrator = self.orchestrator()

            self._instances["service_adapter"] = ServiceAdapter(
                classifier=classifier,
                orchestrator=orchestrator
            )

            logger.info("ServiceAdapter initialized (optional facade)")

        return self._instances["service_adapter"]</code></pre>

<h3>4.2 Usage in UI</h3>

<pre><code># In tabbed_interface.py of definition_generator_tab.py

# Haal container uit session state
container = st.session_state.service_container

# Directe classificatie (aanbevolen)
classifier = container.ontological_classifier()
result = classifier.classify(begrip, org_ctx, jur_ctx)

# OF via adapter (gemak)
adapter = container.service_adapter()
response, classification = await adapter.generate_with_auto_classification(
    begrip=begrip,
    organisatorische_context=org_ctx,
    juridische_context=jur_ctx
)</code></pre>

<p>---</p>

<h2>5. Herbruikbaarheid Voorbeelden</h2>

<h3>5.1 CLI Tool</h3>

<pre><code># Standalone classificatie tool
python -m scripts.classify_term "Overeenkomst" --org-context "Gemeente"

# Batch classificatie
python -m scripts.classify_batch --input begrippen.csv --output results.csv</code></pre>

<h3>5.2 Database Migratie Script</h3>

<pre><code># scripts/migrate_classification_levels.py

"""
Migreer bestaande definities naar nieuwe classificatie systeem
"""

from services.container import ServiceContainer

def migrate_classifications():
    container = ServiceContainer()
    classifier = container.ontological_classifier()
    repo = container.repository()

    definitions = repo.get_all()

    for definition in definitions:
        # Herclassificeer
        result = classifier.classify(
            begrip=definition.begrip,
            organisatorische_context=definition.organisatorische_context
        )

        # Update als niveau veranderd is
        if result.level.value != definition.ontologische_categorie:
            print(f"Update {definition.begrip}: "
                  f"{definition.ontologische_categorie} â†’ {result.level.value}")

            repo.update_classification(
                definition.id,
                new_level=result.level.value
            )</code></pre>

<h3>5.3 Jupyter Notebook Analyse</h3>

<pre><code># notebooks/classification_analysis.ipynb

import pandas as pd
from services.container import ServiceContainer

# Setup
container = ServiceContainer()
classifier = container.ontological_classifier()

# Haal alle definities
repo = container.repository()
definitions = repo.get_all()

# Classificeer batch
begrippen = [d.begrip for d in definitions]
results = classifier.classify_batch(begrippen)

# Analyse
df = pd.DataFrame([
    {
        "begrip": begrip,
        "niveau": result.level.value,
        "confidence": result.confidence,
        "betrouwbaar": result.is_reliable
    }
    for begrip, result in results.items()
])

# Visualiseer
df["niveau"].value_counts().plot(kind="bar")
df["confidence"].hist(bins=20)</code></pre>

<p>---</p>

<h2>6. Testing Strategie</h2>

<h3>6.1 Unit Tests</h3>

<pre><code># tests/services/classification/test_ontological_classifier.py

import pytest
from unittest.mock import Mock

from services.classification import (
    OntologicalClassifier,
    ClassificationResult,
    ClassificationConfidence
)
from src.toetsregels.level_classifier import OntologicalLevel


class TestOntologicalClassifier:
    """Unit tests voor OntologicalClassifier"""

    @pytest.fixture
    def mock_ai_service(self):
        """Mock AIServiceV2"""
        return Mock()

    @pytest.fixture
    def classifier(self, mock_ai_service):
        """Classifier instance met mocked dependencies"""
        return OntologicalClassifier(mock_ai_service)

    def test_classify_returns_classification_result(self, classifier):
        """Test basic classificatie"""
        result = classifier.classify("Overeenkomst")

        assert isinstance(result, ClassificationResult)
        assert result.level in [OntologicalLevel.UNIVERSEEL,
                                OntologicalLevel.FUNCTIONEEL,
                                OntologicalLevel.OPERATIONEEL]
        assert 0.0 &lt;= result.confidence &lt;= 1.0

    def test_classify_with_context(self, classifier):
        """Test classificatie met context"""
        result = classifier.classify(
            begrip="Overeenkomst",
            organisatorische_context="Gemeente",
            juridische_context="BW"
        )

        assert result.metadata["has_org_context"] is True
        assert result.metadata["has_jur_context"] is True

    def test_classify_empty_begrip_raises_error(self, classifier):
        """Test error handling voor leeg begrip"""
        with pytest.raises(ValueError, match="mag niet leeg"):
            classifier.classify("")

    def test_confidence_level_high(self, classifier):
        """Test HIGH confidence level (&gt;= 0.80)"""
        # Mock high confidence result
        # ... test implementation

    def test_batch_classification(self, classifier):
        """Test batch classificatie"""
        begrippen = ["Overeenkomst", "Perceel", "Rechtspersoon"]
        results = classifier.classify_batch(begrippen)

        assert len(results) == 3
        assert all(isinstance(r, ClassificationResult)
                   for r in results.values())

    def test_validate_existing_definition_correct(self, classifier):
        """Test validatie van correcte definitie"""
        # Mock classifier to return "F"
        # ... setup mock

        is_correct, reason = classifier.validate_existing_definition(
            begrip="Overeenkomst",
            claimed_level="F",
            definition_text="..."
        )

        assert is_correct is True
        assert reason is None

    def test_validate_existing_definition_mismatch(self, classifier):
        """Test validatie van incorrecte definitie"""
        # Mock classifier to return "F"
        # ... setup mock

        is_correct, reason = classifier.validate_existing_definition(
            begrip="Overeenkomst",
            claimed_level="U",  # Wrong!
            definition_text="..."
        )

        assert is_correct is False
        assert "mismatch" in reason.lower()</code></pre>

<h3>6.2 Integration Tests</h3>

<pre><code># tests/integration/test_classification_workflow.py

import pytest
from services.container import ServiceContainer


@pytest.mark.integration
class TestClassificationWorkflow:
    """Integration tests voor complete classificatie flow"""

    @pytest.fixture
    def container(self):
        """Real ServiceContainer met dependencies"""
        return ServiceContainer()

    def test_full_classification_flow(self, container):
        """Test complete flow: classify â†’ generate"""
        # Get services
        classifier = container.ontological_classifier()
        orchestrator = container.orchestrator()

        # Stap 1: Classificeer
        classification = classifier.classify(
            begrip="Overeenkomst",
            organisatorische_context="Test context"
        )

        assert classification.level is not None

        # Stap 2: Genereer met classificatie
        from services.orchestrators.definition_orchestrator_v2 import (
            GenerationRequest
        )

        request = GenerationRequest(
            begrip="Overeenkomst",
            ontologische_categorie=classification.to_string_level(),
            organisatorische_context="Test context"
        )

        response = await orchestrator.create_definition(request)

        assert response.success is True
        assert response.definition_text is not None</code></pre>

<p>---</p>

<h2>7. Migration Plan</h2>

<h3>7.1 Implementatie Stappen</h3>

<ol>
<li>**âœ… DONE**: Create `OntologicalClassifier` class</li>
<li>**âœ… DONE**: Add to ServiceContainer</li>
<li>**TODO**: Update UI to use classifier BEFORE generation</li>
<li>**TODO**: Create ServiceAdapter (optional)</li>
<li>**TODO**: Write tests</li>
<li>**TODO**: Update documentation</li>
</ol>

<h3>7.2 UI Integration Changes</h3>

<p><strong>Bestand</strong>: <code>src/ui/components/definition_generator_tab.py</code></p>

<pre><code># VOOR: Direct naar generatie
response = await orchestrator.create_definition(request)

# NA: Eerst classificeren
classifier = container.ontological_classifier()

# Classificeer
classification = classifier.classify(begrip, org_ctx, jur_ctx)

# Toon aan gebruiker (optioneel)
st.info(f"Geclassificeerd als: {classification.level.value}")

# Zet in request
request.ontologische_categorie = classification.to_string_level()

# Genereer
response = await orchestrator.create_definition(request)</code></pre>

<p>---</p>

<h2>8. Beslissingen & Rationale</h2>

<h3>Waarom Standalone vs. Nested?</h3>

<p>| Aspect | Standalone (GEKOZEN) | Nested in Orchestrator |</p>
<p>|--------|----------------------|------------------------|</p>
<p>| <strong>Herbruikbaarheid</strong> | âœ… Beschikbaar via DI voor UI, CLI, batch | âŒ Alleen via orchestrator |</p>
<p>| <strong>Testing</strong> | âœ… Makkelijk te testen in isolatie | âŒ Vereist orchestrator setup |</p>
<p>| <strong>Timing</strong> | âœ… VOOR generatie (correct) | âŒ Tijdens generatie (te laat) |</p>
<p>| <strong>Verantwoordelijkheid</strong> | âœ… Single Responsibility | âŒ Orchestrator doet te veel |</p>
<p>| <strong>Flexibility</strong> | âœ… UI kan classificatie tonen/override | âŒ Hidden binnen orchestrator |</p>

<h3>Waarom ServiceAdapter Optional?</h3>

<ul>
<li>**Pro**: Gemak voor eenvoudige use cases</li>
<li>**Con**: Extra abstractie laag</li>
<li>**Beslissing**: Optional, niet verplicht</li>
<li>**Rationale**: UI heeft vaak meer controle nodig (toon classificatie, override), direct classifier gebruik is flexibeler</li>
</ul>

<h3>Waarom ClassificationResult Dataclass?</h3>

<ul>
<li>**Immutability**: Dataclass is read-only after creation</li>
<li>**Type Safety**: Clear contract voor return value</li>
<li>**Serialiseerbaar**: Makkelijk om te loggen/cachen</li>
<li>**Helper Methods**: `is_reliable`, `to_string_level()` voor convenience</li>
</ul>

<p>---</p>

<h2>9. Open Vragen</h2>

<ol>
<li>**Caching**: Moeten we classificatie results cachen? (Waarschijnlijk niet, ze zijn snel genoeg)</li>
<li>**UI Override**: Hoe prominent moet override optie zijn voor lage confidence?</li>
<li>**Logging**: Moeten we alle classificaties loggen voor analyse?</li>
<li>**Metrics**: Welke metrics willen we tracken? (confidence distribution, level distribution)</li>
</ol>

<p>---</p>

<h2>10. Conclusie</h2>

<p>De <strong>OntologicalClassifier</strong> is nu een <strong>first-class standalone service</strong> die:</p>

<ul>
<li>âœ… **Voor** definitie generatie classificeert (correct timing)</li>
<li>âœ… **Herbruikbaar** is via DI (UI, CLI, batch, validatie)</li>
<li>âœ… **Testbaar** is in isolatie (unit + integration tests)</li>
<li>âœ… **Flexibel** is (directe toegang via container, optionele adapter)</li>
<li>âœ… **Type-safe** is (dataclass results, enums)</li>
</ul>

<p>De architectuur volgt SOLID principles en is klaar voor productie gebruik.</p>

  </div>
</body>
</html>