<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Viewer – Portal</title>
    <link rel="stylesheet" href="portal.css" />
    <style>
      body { display:flex; flex-direction:column; height:100vh; }
      header.viewer { display:flex; gap:12px; align-items:center; padding:8px 12px; border-bottom:1px solid #ddd; }
      header.viewer .title { font-weight:600; color:#223; }
      .spacer { flex:1; }
      .btn { padding:6px 10px; border:1px solid #ccd; border-radius:6px; background:#f8f9fb; text-decoration:none; color:#223; font-size:13px; }
      .btn.primary { background:#eef3ff; border-color:#c8d5ff; }
      .viewer-frame { flex:1; border:0; width:100%; }
      .warn { color:#900; font-weight:600; }
      main.empty { padding:16px; }
    </style>
  </head>
  <body>
    <header class="viewer">
      <a class="btn" href="index.html">← Terug naar Portal</a>
      <span class="title" id="docTitle">Document</span>
      <span class="spacer"></span>
      <a class="btn" id="openSame" href="#">Open direct</a>
      <a class="btn primary" id="openNew" href="#" target="_blank">Open in nieuw tabblad</a>
    </header>
    <main id="content">
      <iframe id="docFrame" class="viewer-frame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>
    </main>
    <script>
      (function(){
        function qs(k){ const u=new URL(location.href); return u.searchParams.get(k)||''; }
        const src = qs('src');
        const title = qs('title')||'';
        const tEl = document.getElementById('docTitle');
        const f = document.getElementById('docFrame');
        const openSame = document.getElementById('openSame');
        const openNew = document.getElementById('openNew');
        function isSafe(p){ if(!p) return false; if(p.startsWith('http://')||p.startsWith('https://')||p.startsWith('/')) return false; return true; }
        if(title) tEl.textContent = title;
        if(isSafe(src)){
          const a = document.createElement('a'); a.href = src;
          const norm = a.getAttribute('href');
          f.src = norm;
          openSame.href = norm;
          openNew.href = norm;
        } else {
          const main = document.getElementById('content');
          main.className = 'empty';
          main.innerHTML = '<p class="warn">Ongeldige bron opgegeven.</p><p>Retour naar de <a href="index.html">Portal</a> of kies een ander document.</p>';
        }
      })();
    </script>
  </body>
  </html>

