<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DefinitieAgent - Professionele Architectuur Documentatie</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Tab styles */
        .tabs {
            display: flex;
            background: white;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .tab-button {
            flex: 1;
            padding: 20px;
            border: none;
            background: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .tab-button:hover {
            background: #f0f0f0;
        }
        .tab-button.active {
            background: #667eea;
            color: white;
        }
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: #764ba2;
        }
        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .tab-content.active {
            display: block;
        }

        /* Architecture diagram styles */
        .architecture-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }
        .architecture-section h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .architecture-section h3 {
            color: #555;
            margin-top: 20px;
        }

        /* Diagram container */
        .diagram-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Component boxes */
        .component-box {
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .component-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .component-box.active {
            background: #e3f2fd;
            border-color: #2196f3;
        }
        .component-box.new {
            background: #e8f5e9;
            border-color: #4caf50;
        }
        .component-box.deprecated {
            background: #ffebee;
            border-color: #f44336;
            opacity: 0.7;
        }

        /* Flow diagram */
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-around;
            flex-wrap: wrap;
            padding: 20px;
        }
        .flow-arrow {
            font-size: 24px;
            color: #667eea;
            margin: 0 20px;
        }

        /* Layer diagram */
        .layer-diagram {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .layer {
            padding: 20px;
            text-align: center;
            color: white;
            font-weight: bold;
        }
        .layer.presentation { background: #3498db; }
        .layer.application { background: #9b59b6; }
        .layer.domain { background: #e74c3c; }
        .layer.infrastructure { background: #34495e; }

        /* Metrics cards */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .metric-value {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            color: #666;
            margin-top: 10px;
        }
        .metric-change {
            color: #4caf50;
            font-size: 14px;
            margin-top: 5px;
        }

        /* Technology stack */
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .tech-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tech-icon {
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* Deployment diagram */
        .deployment-diagram {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .deployment-node {
            background: #f8f9fa;
            border: 2px dashed #999;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        .deployment-node h4 {
            margin-top: 0;
            color: #555;
        }

        /* Data flow diagram */
        .data-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .data-node {
            background: white;
            padding: 15px 25px;
            border-radius: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-weight: bold;
        }
        .data-arrow {
            flex: 1;
            height: 2px;
            background: #667eea;
            position: relative;
            margin: 0 20px;
        }
        .data-arrow::after {
            content: '‚ñ∂';
            position: absolute;
            right: -10px;
            top: -10px;
            color: #667eea;
        }

        /* Security layers */
        .security-layers {
            background: linear-gradient(to bottom, #ffebee, #ffcdd2, #ef9a9a);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .security-layer {
            background: rgba(255,255,255,0.8);
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #f44336;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding: 20px 0;
            margin: 30px 0;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }
        .timeline-item {
            position: relative;
            padding: 20px;
            width: 45%;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .timeline-item:nth-child(odd) {
            left: 0;
        }
        .timeline-item:nth-child(even) {
            left: 55%;
        }
        .timeline-dot {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #667eea;
            border-radius: 50%;
            top: 25px;
        }
        .timeline-item:nth-child(odd) .timeline-dot {
            right: -58px;
        }
        .timeline-item:nth-child(even) .timeline-dot {
            left: -58px;
        }

        /* Matrix diagram */
        .matrix-diagram {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .matrix-cell {
            padding: 15px;
            text-align: center;
            border-radius: 6px;
            font-size: 14px;
        }
        .matrix-header {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        .matrix-cell.high { background: #ffcdd2; }
        .matrix-cell.medium { background: #fff3cd; }
        .matrix-cell.low { background: #c8e6c9; }

        /* Service mesh diagram */
        .service-mesh {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
            position: relative;
        }
        .service-node {
            background: white;
            border: 2px solid #667eea;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }
        .mesh-connection {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 1px;
            background: #ddd;
            transform-origin: left center;
            z-index: 1;
        }

        /* Component relationship diagram */
        .relationship-diagram {
            position: relative;
            min-height: 600px;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            padding: 20px;
        }

        /* Enhanced diagram styles for detailed visualizations */
        .detailed-flow-diagram {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
        }

        .flow-group {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            position: relative;
        }

        .flow-group.vertical {
            flex-direction: column;
        }

        .flow-node {
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px 25px;
            margin: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            position: relative;
            min-width: 150px;
        }

        .flow-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .flow-node.primary {
            background: #667eea;
            color: white;
        }

        .flow-node.secondary {
            background: #f3e5f5;
            border-color: #9c27b0;
        }

        .flow-node.service {
            background: #e3f2fd;
            border-color: #2196f3;
        }

        .flow-node.data {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .flow-node.external {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .flow-connector {
            display: flex;
            align-items: center;
            margin: 0 -10px;
        }

        .flow-line {
            flex: 1;
            height: 2px;
            background: #667eea;
            position: relative;
        }

        .flow-line::after {
            content: '‚ñ∂';
            position: absolute;
            right: -10px;
            top: -10px;
            color: #667eea;
            font-size: 16px;
        }

        .flow-line.vertical {
            width: 2px;
            height: 40px;
            margin: -10px auto;
        }

        .flow-line.vertical::after {
            content: '‚ñº';
            top: auto;
            bottom: -15px;
            right: -7px;
        }

        .flow-label {
            background: white;
            padding: 4px 12px;
            font-size: 12px;
            color: #666;
            border-radius: 12px;
            border: 1px solid #ddd;
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
        }

        /* Service communication pattern styles */
        .service-pattern-diagram {
            display: grid;
            grid-template-columns: 1fr 2px 1fr 2px 1fr;
            gap: 30px;
            align-items: stretch;
            padding: 40px;
            background: linear-gradient(to right, #e3f2fd, #f3e5f5, #e8f5e9);
            border-radius: 12px;
            margin: 20px 0;
        }

        .pattern-layer {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .pattern-layer h4 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .pattern-component {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            margin: 8px 0;
            font-size: 14px;
            text-align: center;
        }

        .pattern-divider {
            background: linear-gradient(to bottom, transparent, #667eea, transparent);
            position: relative;
        }

        /* Event flow diagram */
        .event-flow-diagram {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 40px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .event-timeline {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            position: relative;
            padding: 40px 0;
        }

        .event-node {
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            position: relative;
            z-index: 2;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .event-node.trigger {
            background: #667eea;
            color: white;
        }

        .event-connection {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(to right, #667eea, #764ba2, #667eea);
            z-index: 1;
        }

        .event-label {
            position: absolute;
            top: 100px;
            width: 120px;
            text-align: center;
            font-size: 12px;
            color: #666;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Microservices mesh diagram */
        .microservices-mesh {
            position: relative;
            background: radial-gradient(circle at center, #f8f9fa 0%, white 100%);
            border-radius: 12px;
            padding: 60px;
            margin: 20px 0;
            height: 600px;
            overflow: hidden;
        }

        .mesh-service {
            position: absolute;
            background: white;
            border: 3px solid;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-width: 140px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .mesh-service:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .mesh-service.gateway {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .mesh-service.core {
            border-color: #2196f3;
            background: #e3f2fd;
        }

        .mesh-service.support {
            border-color: #9c27b0;
            background: #f3e5f5;
        }

        .mesh-service.data {
            border-color: #ff9800;
            background: #fff3e0;
        }

        .mesh-line {
            position: absolute;
            background: #ddd;
            height: 2px;
            transform-origin: left center;
            z-index: 0;
        }

        .mesh-line.active {
            background: #667eea;
            height: 3px;
        }

        /* Domain context diagram */
        .domain-context-diagram {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 40px;
            margin: 20px 0;
            position: relative;
        }

        .bounded-context {
            border: 3px dashed;
            border-radius: 20px;
            padding: 40px;
            margin: 20px;
            position: relative;
            background: rgba(255,255,255,0.8);
        }

        .bounded-context.definition {
            border-color: #2196f3;
            background: rgba(227, 242, 253, 0.3);
        }

        .bounded-context.validation {
            border-color: #4caf50;
            background: rgba(232, 245, 233, 0.3);
        }

        .bounded-context.enrichment {
            border-color: #9c27b0;
            background: rgba(243, 229, 245, 0.3);
        }

        .bounded-context.export {
            border-color: #ff9800;
            background: rgba(255, 243, 224, 0.3);
        }

        .context-aggregate {
            background: white;
            border: 2px solid;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .context-relationship {
            position: absolute;
            font-size: 12px;
            background: white;
            padding: 4px 12px;
            border-radius: 12px;
            border: 1px solid #ddd;
            color: #666;
        }

        /* Service mesh with Istio visualization */
        .istio-mesh-diagram {
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border-radius: 12px;
            padding: 40px;
            margin: 20px 0;
            position: relative;
        }

        .istio-pod {
            background: white;
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin: 20px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .istio-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .istio-app {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            flex: 1;
        }

        .istio-proxy {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            min-width: 100px;
        }

        .istio-control-plane {
            background: #667eea;
            color: white;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin: 20px auto;
            max-width: 600px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        .rel-component {
            position: absolute;
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            min-width: 150px;
            cursor: move;
            transition: all 0.3s ease;
            z-index: 10;
        }
        .rel-component:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: scale(1.05);
        }
        .rel-component.ui { background: #e3f2fd; border-color: #2196f3; }
        .rel-component.service { background: #f3e5f5; border-color: #9c27b0; }
        .rel-component.data { background: #e8f5e9; border-color: #4caf50; }
        .rel-component.external { background: #fff3e0; border-color: #ff9800; }
        .rel-line {
            position: absolute;
            background: #667eea;
            height: 2px;
            transform-origin: left center;
            z-index: 1;
        }
        .rel-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid #667eea;
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
            right: -8px;
            top: -3px;
        }
        .rel-label {
            position: absolute;
            background: white;
            padding: 2px 8px;
            font-size: 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            white-space: nowrap;
        }

        /* Sequence diagram */
        .sequence-diagram {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .seq-actor {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 0 50px;
            position: relative;
        }
        .seq-lifeline {
            position: absolute;
            left: 50%;
            top: 100%;
            width: 2px;
            height: 400px;
            background: #ddd;
            transform: translateX(-50%);
        }
        .seq-message {
            position: absolute;
            height: 2px;
            background: #667eea;
            top: 100px;
            min-width: 100px;
        }
        .seq-message::after {
            content: '‚ñ∂';
            position: absolute;
            right: -10px;
            top: -10px;
            color: #667eea;
        }

        /* Network topology diagram */
        .network-diagram {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            padding: 30px;
            background: white;
            border-radius: 8px;
            position: relative;
        }
        .network-node {
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .network-node::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: 30px;
            height: 2px;
            background: #667eea;
        }
        .network-node:nth-child(4n)::before {
            display: none;
        }

        /* Context map */
        .context-map {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            background: #f8f9fa;
            border-radius: 8px;
            position: relative;
        }
        .context-boundary {
            border: 3px dashed #999;
            border-radius: 20px;
            padding: 40px;
            margin: 20px;
            position: relative;
        }
        .context-core {
            background: #667eea;
            color: white;
            padding: 30px;
            border-radius: 50%;
            text-align: center;
            font-weight: bold;
        }
        .context-satellite {
            position: absolute;
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            min-width: 120px;
            text-align: center;
        }
        .mesh-connection {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 1px;
            background: #ddd;
            transform-origin: left center;
            z-index: 1;
        }

        /* File list styles from original */
        .module {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
        }
        .file {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 3px;
            padding: 8px;
            margin: 5px 0;
            font-size: 14px;
        }
        .file-path {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #666;
        }
        .file-description {
            font-size: 12px;
            color: #555;
            margin-top: 3px;
        }
        .status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status-active { background: #d4edda; color: #155724; }
        .status-unused { background: #f8d7da; color: #721c24; }
        .status-partial { background: #fff3cd; color: #856404; }
        .status-new { background: #cce5ff; color: #004085; }
        .status-todo { background: #e2e3e5; color: #383d41; }

        /* Feature Dashboard Styles */
        .feature-dashboard {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .dashboard-header h3 {
            margin: 0;
            color: #333;
            font-size: 28px;
        }

        .dashboard-subtitle {
            color: #666;
            margin-top: 10px;
            font-size: 16px;
        }

        /* Progress Overview */
        .progress-overview {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 40px;
            margin-bottom: 60px;
            align-items: center;
        }

        .progress-circle-container {
            display: flex;
            justify-content: center;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .stat-card.complete {
            border-color: #4caf50;
        }

        .stat-card.complete:hover {
            background: #e8f5e9;
        }

        .stat-card.in-progress {
            border-color: #ff9800;
        }

        .stat-card.in-progress:hover {
            background: #fff3e0;
        }

        .stat-card.not-started {
            border-color: #f44336;
        }

        .stat-card.not-started:hover {
            background: #ffebee;
        }

        .stat-card.total {
            border-color: #667eea;
        }

        .stat-card.total:hover {
            background: #e8eaf6;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .stat-percentage {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
        }

        /* Epic Breakdown */
        .epic-breakdown {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .epic-breakdown h3 {
            margin-top: 0;
            margin-bottom: 30px;
            color: #333;
        }

        .epic-item {
            margin-bottom: 25px;
            opacity: 0;
            animation: fadeInUp 0.5s ease forwards;
        }

        .epic-item:nth-child(2) { animation-delay: 0.1s; }
        .epic-item:nth-child(3) { animation-delay: 0.2s; }
        .epic-item:nth-child(4) { animation-delay: 0.3s; }
        .epic-item:nth-child(5) { animation-delay: 0.4s; }
        .epic-item:nth-child(6) { animation-delay: 0.5s; }
        .epic-item:nth-child(7) { animation-delay: 0.6s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .epic-item.critical .progress-bar-container {
            background: #ffebee;
        }

        .epic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .epic-name {
            font-weight: 600;
            color: #333;
            font-size: 16px;
        }

        .epic-status {
            color: #666;
            font-size: 14px;
        }

        .progress-bar-container {
            background: #e0e0e0;
            border-radius: 20px;
            height: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        /* Critical Features */
        .critical-features {
            margin-bottom: 40px;
        }

        .critical-features h3 {
            margin-bottom: 25px;
            color: #333;
        }

        .critical-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .critical-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            border: 2px solid;
            display: flex;
            gap: 20px;
            align-items: flex-start;
            transition: all 0.3s ease;
        }

        .critical-card.high {
            border-color: #f44336;
            background: #ffebee;
        }

        .critical-card.medium {
            border-color: #ff9800;
            background: #fff3e0;
        }

        .critical-card.low {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .critical-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }

        .critical-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .critical-content h4 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 18px;
        }

        .critical-content p {
            margin: 0;
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Requirements Link */
        .requirements-link {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
        }

        .req-button {
            display: inline-block;
            background: white;
            color: #667eea;
            padding: 15px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .req-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            background: #f8f9fa;
        }

        .req-note {
            margin-top: 15px;
            font-size: 14px;
            opacity: 0.9;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .progress-overview {
                grid-template-columns: 1fr;
            }

            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .critical-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèóÔ∏è DefinitieAgent Architectuur Documentatie</h1>
        <p>Professionele Enterprise Architectuur - AS-IS & TO-BE</p>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('as-is')">
                üìä AS-IS Architectuur
            </button>
            <button class="tab-button" onclick="showTab('to-be')">
                üöÄ TO-BE Architectuur
            </button>
        </div>

        <!-- AS-IS Tab Content -->
        <div id="as-is" class="tab-content active">
            <div class="architecture-section">
                <h2>1. High-Level Architectuur Overzicht</h2>

                <div class="diagram-container">
                    <h3>Layered Architecture (Current State)</h3>
                    <div class="layer-diagram">
                        <div class="layer presentation">
                            Presentation Layer
                            <br><small>Streamlit UI, Web Interface, Session Management</small>
                        </div>
                        <div class="layer application">
                            Application Layer
                            <br><small>Business Logic, Workflow Orchestration, Service Coordination</small>
                        </div>
                        <div class="layer domain">
                            Domain Layer
                            <br><small>Domain Models, Business Rules, Validation Logic</small>
                        </div>
                        <div class="layer infrastructure">
                            Infrastructure Layer
                            <br><small>Database, External APIs, File System, Caching</small>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Component Architecture</h3>
                    <div class="flow-diagram">
                        <div class="component-box active">
                            <strong>Streamlit UI</strong>
                            <br>main.py
                            <br><small>Entry Point</small>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="component-box active">
                            <strong>UI Components</strong>
                            <br>7 Tabs (30% active)
                            <br><small>User Interface</small>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="component-box active">
                            <strong>Services</strong>
                            <br>6 Active Services
                            <br><small>Business Logic</small>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="component-box active">
                            <strong>Repository</strong>
                            <br>SQLite Database
                            <br><small>Data Persistence</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>2. Deployment Architecture</h2>

                <div class="deployment-diagram">
                    <div class="deployment-node">
                        <h4>üñ•Ô∏è Client Browser</h4>
                        <p>Streamlit Web UI</p>
                        <small>HTML/CSS/JS</small>
                    </div>
                    <div class="deployment-node">
                        <h4>üåê Application Server</h4>
                        <p>Python 3.11</p>
                        <p>Streamlit Server</p>
                        <small>Single Instance</small>
                    </div>
                    <div class="deployment-node">
                        <h4>üíæ Database</h4>
                        <p>SQLite (Local)</p>
                        <small>File-based DB</small>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>3. Data Flow Architecture</h2>

                <div class="data-flow">
                    <div class="data-node">User Input</div>
                    <div class="data-arrow"></div>
                    <div class="data-node">Validation</div>
                    <div class="data-arrow"></div>
                    <div class="data-node">AI Processing</div>
                    <div class="data-arrow"></div>
                    <div class="data-node">Storage</div>
                </div>

                <div class="diagram-container">
                    <h3>Service Interaction Pattern</h3>
                    <div class="service-mesh">
                        <div class="service-node">Definition<br>Generator</div>
                        <div class="service-node">Validator<br>Service</div>
                        <div class="service-node">Repository<br>Service</div>
                        <div class="service-node">Orchestrator</div>
                        <div class="service-node">Web Lookup</div>
                        <div class="service-node">AI Toetser</div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>4. Technology Stack</h2>

                <div class="tech-stack">
                    <div class="tech-item">
                        <div class="tech-icon">üêç</div>
                        <div>
                            <strong>Python 3.11</strong>
                            <br><small>Core Language</small>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon">üé®</div>
                        <div>
                            <strong>Streamlit</strong>
                            <br><small>Web Framework</small>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon">ü§ñ</div>
                        <div>
                            <strong>OpenAI API</strong>
                            <br><small>AI Provider</small>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon">üíæ</div>
                        <div>
                            <strong>SQLAlchemy</strong>
                            <br><small>ORM</small>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon">üóÑÔ∏è</div>
                        <div>
                            <strong>SQLite</strong>
                            <br><small>Database</small>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon">üìä</div>
                        <div>
                            <strong>Pandas</strong>
                            <br><small>Data Processing</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>5. System Metrics & Issues</h2>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value">304</div>
                        <div class="metric-label">Python Files</div>
                        <div class="metric-change">150+ unused</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">11%</div>
                        <div class="metric-label">Test Coverage</div>
                        <div class="metric-change">‚ö†Ô∏è Low</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">8-12s</div>
                        <div class="metric-label">Response Time</div>
                        <div class="metric-change">‚ùå Slow</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">30%</div>
                        <div class="metric-label">UI Complete</div>
                        <div class="metric-change">7 tabs inactive</div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Risk Matrix</h3>
                    <div class="matrix-diagram">
                        <div class="matrix-cell matrix-header">Risk</div>
                        <div class="matrix-cell matrix-header">Impact</div>
                        <div class="matrix-cell matrix-header">Likelihood</div>
                        <div class="matrix-cell matrix-header">Priority</div>

                        <div class="matrix-cell">Database Locks</div>
                        <div class="matrix-cell high">High</div>
                        <div class="matrix-cell high">High</div>
                        <div class="matrix-cell high">Critical</div>

                        <div class="matrix-cell">Memory Leaks</div>
                        <div class="matrix-cell medium">Medium</div>
                        <div class="matrix-cell high">High</div>
                        <div class="matrix-cell high">High</div>

                        <div class="matrix-cell">Widget Duplicates</div>
                        <div class="matrix-cell medium">Medium</div>
                        <div class="matrix-cell medium">Medium</div>
                        <div class="matrix-cell medium">Medium</div>

                        <div class="matrix-cell">UTF-8 Issues</div>
                        <div class="matrix-cell low">Low</div>
                        <div class="matrix-cell medium">Medium</div>
                        <div class="matrix-cell low">Low</div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>6. Security Architecture (Current)</h2>

                <div class="security-layers">
                    <div class="security-layer">
                        <strong>Application Security</strong>
                        <br>‚ùå No Authentication
                        <br>‚ùå No Authorization
                        <br>‚ö†Ô∏è Basic Input Validation
                    </div>
                    <div class="security-layer">
                        <strong>API Security</strong>
                        <br>‚úÖ API Key Management
                        <br>‚úÖ Rate Limiting
                        <br>‚ùå No API Gateway
                    </div>
                    <div class="security-layer">
                        <strong>Data Security</strong>
                        <br>‚ùå No Encryption at Rest
                        <br>‚ö†Ô∏è HTTPS Only
                        <br>‚ùå No Data Masking
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>7. Integration Architecture</h2>

                <div class="diagram-container">
                    <h3>External Integrations</h3>
                    <div class="flow-diagram">
                        <div class="component-box active">
                            <strong>DefinitieAgent</strong>
                        </div>
                        <span class="flow-arrow">‚ü∑</span>
                        <div class="component-box active">
                            <strong>OpenAI API</strong>
                            <br><small>GPT-4 Model</small>
                        </div>
                    </div>
                    <div class="flow-diagram">
                        <div class="component-box active">
                            <strong>DefinitieAgent</strong>
                        </div>
                        <span class="flow-arrow">‚ü∑</span>
                        <div class="component-box deprecated">
                            <strong>Web Sources</strong>
                            <br><small>Not Integrated</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>8. Current File Structure</h2>

                <div class="module">
                    <h3>üöÄ Active Components</h3>
                    <div class="file">
                        <div class="file-path">src/main.py <span class="status status-active">‚úì Actief</span></div>
                        <div class="file-description">Hoofdapplicatie met Streamlit interface</div>
                    </div>
                    <div class="file">
                        <div class="file-path">ui/tabbed_interface.py <span class="status status-active">‚úì Actief</span></div>
                        <div class="file-description">Hoofd UI controller - beheert alle tabs</div>
                    </div>
                    <div class="file">
                        <div class="file-path">services/*.py <span class="status status-active">‚úì Actief</span></div>
                        <div class="file-description">6 actieve services voor business logic</div>
                    </div>
                </div>

                <div class="module">
                    <h3>‚ùå Technical Debt</h3>
                    <div class="file">
                        <div class="file-path">toetsregels/regels/*.py <span class="status status-unused">‚úó Ongebruikt</span></div>
                        <div class="file-description">50+ Python regel implementaties - vervangen door JSON</div>
                    </div>
                    <div class="file">
                        <div class="file-path">toetsregels/validators/*.py <span class="status status-unused">‚úó Ongebruikt</span></div>
                        <div class="file-description">50+ duplicate validator bestanden</div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>9. Detailed Relationship Diagrams</h2>

                <div class="diagram-container">
                    <h3>Component Dependencies Flow</h3>
                    <div class="detailed-flow-diagram">
                        <div class="flow-group vertical">
                            <div class="flow-node primary">
                                <strong>main.py</strong>
                                <br><small>Entry Point</small>
                            </div>
                            <div class="flow-line vertical"></div>
                            <div class="flow-node service">
                                <strong>tabbed_interface.py</strong>
                                <br><small>UI Controller</small>
                            </div>
                            <div class="flow-line vertical"></div>
                            <div class="flow-group">
                                <div class="flow-node secondary">
                                    <strong>definition_generator_tab</strong>
                                    <br><small>Active Tab</small>
                                </div>
                                <div class="flow-node secondary">
                                    <strong>expert_review_tab</strong>
                                    <br><small>Partial Tab</small>
                                </div>
                                <div class="flow-node secondary">
                                    <strong>web_lookup_tab</strong>
                                    <br><small>Inactive Tab</small>
                                </div>
                                <div class="flow-node secondary">
                                    <strong>other_tabs (4)</strong>
                                    <br><small>Not Implemented</small>
                                </div>
                            </div>
                            <div class="flow-line vertical"></div>
                            <div class="flow-group">
                                <div class="flow-node service">
                                    <strong>UnifiedDefinitionGenerator</strong>
                                    <br><small>Core Service</small>
                                </div>
                                <div class="flow-node service">
                                    <strong>DefinitionValidator</strong>
                                    <br><small>Validation Service</small>
                                </div>
                                <div class="flow-node service">
                                    <strong>DefinitionOrchestrator</strong>
                                    <br><small>Workflow Service</small>
                                </div>
                            </div>
                            <div class="flow-line vertical"></div>
                            <div class="flow-node data">
                                <strong>DefinitieRepository</strong>
                                <br><small>Data Access Layer</small>
                            </div>
                            <div class="flow-line vertical"></div>
                            <div class="flow-node data">
                                <strong>SQLite Database</strong>
                                <br><small>Storage</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Service Layer Communication Pattern</h3>
                    <div class="service-pattern-diagram">
                        <div class="pattern-layer">
                            <h4>UI Layer</h4>
                            <div class="pattern-component">Streamlit UI</div>
                            <div class="pattern-component">Session State</div>
                            <div class="pattern-component">Tab Controllers</div>
                            <div class="pattern-component">Event Handlers</div>
                        </div>
                        <div class="pattern-divider"></div>
                        <div class="pattern-layer">
                            <h4>Service Layer</h4>
                            <div class="pattern-component">Definition Generator</div>
                            <div class="pattern-component">Validator Service</div>
                            <div class="pattern-component">Orchestrator</div>
                            <div class="pattern-component">AI Toetser</div>
                        </div>
                        <div class="pattern-divider"></div>
                        <div class="pattern-layer">
                            <h4>Infrastructure</h4>
                            <div class="pattern-component">Repository Pattern</div>
                            <div class="pattern-component">SQLite DB</div>
                            <div class="pattern-component">OpenAI API</div>
                            <div class="pattern-component">File System</div>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Data Flow Sequence</h3>
                    <div class="event-flow-diagram">
                        <div class="event-timeline">
                            <div class="event-connection"></div>
                            <div class="event-node trigger">
                                <small>User<br>Input</small>
                                <div class="event-label">1. Enter term</div>
                            </div>
                            <div class="event-node">
                                <small>UI<br>Handler</small>
                                <div class="event-label">2. Validate input</div>
                            </div>
                            <div class="event-node">
                                <small>Service<br>Call</small>
                                <div class="event-label">3. Generate definition</div>
                            </div>
                            <div class="event-node">
                                <small>OpenAI<br>API</small>
                                <div class="event-label">4. AI processing</div>
                            </div>
                            <div class="event-node">
                                <small>Validator</small>
                                <div class="event-label">5. Quality check</div>
                            </div>
                            <div class="event-node">
                                <small>Database</small>
                                <div class="event-label">6. Save result</div>
                            </div>
                            <div class="event-node trigger">
                                <small>Display<br>Result</small>
                                <div class="event-label">7. Show to user</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Context Map - Bounded Contexts</h3>
                    <div class="context-map">
                        <div class="context-boundary">
                            <h4>Definition Management Context</h4>
                            <div class="context-core">Core<br>Domain</div>
                            <div class="context-satellite" style="top: -30px; left: 150px;">UI Context</div>
                            <div class="context-satellite" style="top: 80px; right: -30px;">Validation Context</div>
                            <div class="context-satellite" style="bottom: -30px; left: 100px;">Storage Context</div>
                            <div class="context-satellite" style="top: 50px; left: -150px;">AI Context</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>11. Feature Realisatie & Product Status</h2>

                <div class="feature-dashboard" id="featureDashboard">
                    <div class="dashboard-header">
                        <h3>Overall Product Completion Status</h3>
                        <p class="dashboard-subtitle">Interactive view of feature implementation progress</p>
                        <div class="dashboard-controls">
                            <button class="filter-btn active" data-filter="all">All Features</button>
                            <button class="filter-btn" data-filter="complete">Complete</button>
                            <button class="filter-btn" data-filter="in-progress">In Progress</button>
                            <button class="filter-btn" data-filter="not-started">Not Started</button>
                            <button class="filter-btn" data-filter="critical">Critical</button>
                        </div>
                    </div>

                    <!-- Overall Progress Visualization -->
                    <div class="progress-overview">
                        <div class="progress-circle-container">
                            <svg class="progress-circle" width="200" height="200" viewBox="0 0 200 200">
                                <circle cx="100" cy="100" r="90" fill="none" stroke="#e0e0e0" stroke-width="20"/>
                                <circle id="completeCircle" cx="100" cy="100" r="90" fill="none" stroke="#4caf50" stroke-width="20"
                                        stroke-dasharray="0 565.48" stroke-dashoffset="0"
                                        transform="rotate(-90 100 100)"/>
                                <circle id="progressCircle" cx="100" cy="100" r="90" fill="none" stroke="#ff9800" stroke-width="20"
                                        stroke-dasharray="0 565.48" stroke-dashoffset="0"
                                        transform="rotate(-90 100 100)"/>
                                <text x="100" y="100" text-anchor="middle" dominant-baseline="middle"
                                      font-size="36" font-weight="bold" fill="#333" id="percentageText">0%</text>
                                <text x="100" y="125" text-anchor="middle" font-size="14" fill="#666">Complete</text>
                            </svg>
                        </div>

                        <div class="progress-stats">
                            <div class="stat-card complete clickable" data-filter="complete">
                                <div class="stat-value" id="completeCount">0</div>
                                <div class="stat-label">Complete</div>
                                <div class="stat-percentage" id="completePercent">0%</div>
                            </div>
                            <div class="stat-card in-progress clickable" data-filter="in-progress">
                                <div class="stat-value" id="progressCount">0</div>
                                <div class="stat-label">In Progress</div>
                                <div class="stat-percentage" id="progressPercent">0%</div>
                            </div>
                            <div class="stat-card not-started clickable" data-filter="not-started">
                                <div class="stat-value" id="notStartedCount">0</div>
                                <div class="stat-label">Not Started</div>
                                <div class="stat-percentage" id="notStartedPercent">0%</div>
                            </div>
                            <div class="stat-card total">
                                <div class="stat-value" id="totalCount">0</div>
                                <div class="stat-label">Total Features</div>
                                <div class="stat-percentage">100%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Epic Breakdown -->
                    <div class="epic-breakdown" id="epicBreakdown">
                        <h3>Feature Completion by Epic</h3>
                        <div id="epicContainer">
                            <!-- Epics will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Feature Details View -->
                    <div class="feature-details" id="featureDetails" style="display: none;">
                        <h3>Feature Details: <span id="epicTitle"></span></h3>
                        <button class="back-btn" onclick="hideFeatureDetails()">‚Üê Back to Overview</button>
                        <div id="featureList">
                            <!-- Features will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Critical Missing Features -->
                    <div class="critical-features" id="criticalFeatures">
                        <h3>Critical Missing Features</h3>
                        <div class="critical-grid" id="criticalGrid">
                            <!-- Critical features will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Requirements Link -->
                    <div class="requirements-link">
                        <a href="../REQUIREMENTS_AND_FEATURES_COMPLETE.md" class="req-button">
                            üìã View Complete Requirements Document
                        </a>
                        <p class="req-note">Detailed functional and non-functional requirements specification</p>
                    </div>
                </div>
            </div>

            <style>
                /* Additional styles for interactive elements */
                .dashboard-controls {
                    margin-top: 15px;
                    display: flex;
                    gap: 10px;
                    justify-content: center;
                }

                .filter-btn {
                    padding: 8px 16px;
                    border: 2px solid #ddd;
                    background: white;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-size: 14px;
                }

                .filter-btn:hover {
                    background: #f0f0f0;
                }

                .filter-btn.active {
                    background: #667eea;
                    color: white;
                    border-color: #667eea;
                    transform: scale(1.05);
                    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                }

                .clickable {
                    cursor: pointer;
                    transition: transform 0.2s ease;
                }

                .clickable:hover {
                    transform: translateY(-5px);
                }

                .epic-item {
                    cursor: pointer;
                    transition: all 0.3s ease;
                    padding: 15px;
                    margin: 10px 0;
                    border-radius: 8px;
                    border: 1px solid transparent;
                }

                .epic-item:hover {
                    background: rgba(255,255,255,0.1);
                    transform: translateX(5px);
                    border-color: rgba(255,255,255,0.2);
                    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
                }

                .epic-item.expanded {
                    background: rgba(255,255,255,0.15);
                    border-color: rgba(255,255,255,0.3);
                }

                .epic-item.expanded {
                    background: #e8f5e9;
                }

                .feature-details {
                    background: #f8f9fa;
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .back-btn {
                    background: #667eea;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 5px;
                    cursor: pointer;
                    margin-bottom: 20px;
                }

                .feature-item {
                    background: white;
                    padding: 15px;
                    margin: 10px 0;
                    border-radius: 8px;
                    border-left: 4px solid #ddd;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    transition: all 0.3s ease;
                    cursor: pointer;
                }

                .feature-item:hover {
                    transform: translateX(5px);
                    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
                }

                .feature-item.complete {
                    border-left-color: #4caf50;
                }

                .feature-item.in-progress {
                    border-left-color: #ff9800;
                }

                .feature-item.not-started {
                    border-left-color: #f44336;
                }

                .feature-status {
                    padding: 5px 10px;
                    border-radius: 15px;
                    font-size: 12px;
                    font-weight: bold;
                }

                .status-complete {
                    background: #e8f5e9;
                    color: #2e7d32;
                }

                .status-in-progress {
                    background: #fff3e0;
                    color: #f57c00;
                }

                .status-not-started {
                    background: #ffebee;
                    color: #c62828;
                }

                @keyframes progressAnimation {
                    from {
                        stroke-dasharray: 0 565.48;
                    }
                }

                .progress-bar {
                    animation: progressAnimation 1.5s ease-out;
                }
            </style>
        </div>

        <!-- TO-BE Tab Content -->
        <div id="to-be" class="tab-content">
            <div class="architecture-section">
                <h2>1. Target Architecture Vision</h2>

                <div class="diagram-container">
                    <h3>Microservices Architecture</h3>
                    <div class="service-mesh">
                        <div class="service-node" style="background: #e8f5e9;">
                            API<br>Gateway
                        </div>
                        <div class="service-node" style="background: #e3f2fd;">
                            Auth<br>Service
                        </div>
                        <div class="service-node" style="background: #fff3e0;">
                            Definition<br>Service
                        </div>
                        <div class="service-node" style="background: #fce4ec;">
                            Validation<br>Service
                        </div>
                        <div class="service-node" style="background: #f3e5f5;">
                            Export<br>Service
                        </div>
                        <div class="service-node" style="background: #e0f2f1;">
                            Monitor<br>Service
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Cloud-Native Deployment</h3>
                    <div class="deployment-diagram">
                        <div class="deployment-node" style="background: #e3f2fd;">
                            <h4>‚òÅÔ∏è Load Balancer</h4>
                            <p>Nginx/HAProxy</p>
                            <small>Auto-scaling</small>
                        </div>
                        <div class="deployment-node" style="background: #e8f5e9;">
                            <h4>üê≥ Kubernetes Cluster</h4>
                            <p>3+ Nodes</p>
                            <p>Docker Containers</p>
                            <small>Orchestration</small>
                        </div>
                        <div class="deployment-node" style="background: #fff3e0;">
                            <h4>üóÑÔ∏è PostgreSQL</h4>
                            <p>Master-Slave</p>
                            <p>Redis Cache</p>
                            <small>High Availability</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>2. Event-Driven Architecture</h2>

                <div class="data-flow">
                    <div class="data-node" style="background: #e3f2fd;">User Request</div>
                    <div class="data-arrow"></div>
                    <div class="data-node" style="background: #e8f5e9;">Event Bus</div>
                    <div class="data-arrow"></div>
                    <div class="data-node" style="background: #fff3e0;">Services</div>
                    <div class="data-arrow"></div>
                    <div class="data-node" style="background: #fce4ec;">Response</div>
                </div>

                <div class="diagram-container">
                    <h3>Message Queue Architecture</h3>
                    <p style="text-align: center; color: #666;">
                        RabbitMQ / Kafka for asynchronous processing
                    </p>
                </div>
            </div>

            <div class="architecture-section">
                <h2>3. Enhanced Technology Stack</h2>

                <div class="tech-stack">
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">üöÄ</div>
                        <div>
                            <strong>FastAPI</strong>
                            <br><small>REST API</small>
                        </div>
                    </div>
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">üê≥</div>
                        <div>
                            <strong>Docker</strong>
                            <br><small>Containerization</small>
                        </div>
                    </div>
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">‚ò∏Ô∏è</div>
                        <div>
                            <strong>Kubernetes</strong>
                            <br><small>Orchestration</small>
                        </div>
                    </div>
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">üêò</div>
                        <div>
                            <strong>PostgreSQL</strong>
                            <br><small>Primary DB</small>
                        </div>
                    </div>
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">‚ö°</div>
                        <div>
                            <strong>Redis</strong>
                            <br><small>Caching</small>
                        </div>
                    </div>
                    <div class="tech-item" style="border-color: #4caf50;">
                        <div class="tech-icon">üìä</div>
                        <div>
                            <strong>Grafana</strong>
                            <br><small>Monitoring</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>4. Target Metrics</h2>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value"><5s</div>
                        <div class="metric-label">Response Time</div>
                        <div class="metric-change">‚úÖ 60% faster</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">80%</div>
                        <div class="metric-label">Test Coverage</div>
                        <div class="metric-change">‚úÖ 7x increase</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">100%</div>
                        <div class="metric-label">UI Complete</div>
                        <div class="metric-change">‚úÖ All tabs active</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">99.9%</div>
                        <div class="metric-label">Uptime SLA</div>
                        <div class="metric-change">‚úÖ Enterprise</div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>5. Security Architecture (Target)</h2>

                <div class="security-layers" style="background: linear-gradient(to bottom, #c8e6c9, #a5d6a7, #81c784);">
                    <div class="security-layer">
                        <strong>Identity & Access Management</strong>
                        <br>‚úÖ OAuth 2.0 / SAML
                        <br>‚úÖ Role-Based Access Control (RBAC)
                        <br>‚úÖ Multi-Factor Authentication
                    </div>
                    <div class="security-layer">
                        <strong>API Security</strong>
                        <br>‚úÖ API Gateway with Rate Limiting
                        <br>‚úÖ JWT Token Authentication
                        <br>‚úÖ API Versioning & Deprecation
                    </div>
                    <div class="security-layer">
                        <strong>Data Protection</strong>
                        <br>‚úÖ Encryption at Rest (AES-256)
                        <br>‚úÖ TLS 1.3 in Transit
                        <br>‚úÖ Data Masking & Tokenization
                    </div>
                    <div class="security-layer">
                        <strong>Infrastructure Security</strong>
                        <br>‚úÖ Network Segmentation
                        <br>‚úÖ WAF & DDoS Protection
                        <br>‚úÖ Security Monitoring & SIEM
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>6. Implementation Roadmap</h2>

                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4>Phase 1: Foundation (Week 1-4)</h4>
                        <p>‚úì WAL Mode, Config, CI/CD, Auth</p>
                        <div style="background: #4caf50; height: 4px; width: 30%;"></div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4>Phase 2: Services (Week 5-8)</h4>
                        <p>Service decomposition, Facade pattern</p>
                        <div style="background: #ff9800; height: 4px; width: 10%;"></div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4>Phase 3: Features (Week 9-12)</h4>
                        <p>UI completion, Web lookup, Enrichment</p>
                        <div style="background: #f44336; height: 4px; width: 0%;"></div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4>Phase 4: Scale (Week 13-16)</h4>
                        <p>Redis, PostgreSQL, Monitoring, Deploy</p>
                        <div style="background: #f44336; height: 4px; width: 0%;"></div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>7. Data Architecture Evolution</h2>

                <div class="diagram-container">
                    <h3>From Monolithic to Distributed</h3>
                    <div class="flow-diagram">
                        <div class="component-box deprecated">
                            <strong>SQLite</strong>
                            <br>Single File
                            <br><small>Current</small>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="component-box new">
                            <strong>PostgreSQL</strong>
                            <br>Master-Slave
                            <br><small>Target</small>
                        </div>
                        <span class="flow-arrow">+</span>
                        <div class="component-box new">
                            <strong>Redis</strong>
                            <br>Distributed Cache
                            <br><small>Performance</small>
                        </div>
                        <span class="flow-arrow">+</span>
                        <div class="component-box new">
                            <strong>S3/Blob</strong>
                            <br>Document Store
                            <br><small>Scalability</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>8. Monitoring & Observability</h2>

                <div class="diagram-container">
                    <h3>Full Stack Observability</h3>
                    <div class="tech-stack">
                        <div class="tech-item">
                            <div class="tech-icon">üìä</div>
                            <div>
                                <strong>Prometheus</strong>
                                <br><small>Metrics Collection</small>
                            </div>
                        </div>
                        <div class="tech-item">
                            <div class="tech-icon">üìà</div>
                            <div>
                                <strong>Grafana</strong>
                                <br><small>Visualization</small>
                            </div>
                        </div>
                        <div class="tech-item">
                            <div class="tech-icon">üîç</div>
                            <div>
                                <strong>Jaeger</strong>
                                <br><small>Distributed Tracing</small>
                            </div>
                        </div>
                        <div class="tech-item">
                            <div class="tech-icon">üìù</div>
                            <div>
                                <strong>ELK Stack</strong>
                                <br><small>Log Aggregation</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>9. New Services & Components</h2>

                <div class="module">
                    <h3>üÜï New Services TO-BE</h3>
                    <div class="file">
                        <div class="file-path">services/prompt_optimizer.py <span class="status status-new">üÜï Nieuw</span></div>
                        <div class="file-description">Token reduction to <10k for cost optimization</div>
                    </div>
                    <div class="file">
                        <div class="file-path">services/validation_orchestrator.py <span class="status status-new">üÜï Nieuw</span></div>
                        <div class="file-description">Central validation orchestration service</div>
                    </div>
                    <div class="file">
                        <div class="file-path">services/content_enrichment_service.py <span class="status status-new">üÜï Nieuw</span></div>
                        <div class="file-description">Synonyms, antonyms, and context enrichment</div>
                    </div>
                    <div class="file">
                        <div class="file-path">auth/authentication.py <span class="status status-new">üÜï Nieuw</span></div>
                        <div class="file-description">OAuth 2.0 authentication implementation</div>
                    </div>
                    <div class="file">
                        <div class="file-path">monitoring/metrics_collector.py <span class="status status-new">üÜï Nieuw</span></div>
                        <div class="file-description">Prometheus metrics exporter</div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>10. Detailed Relationship Diagrams</h2>

                <div class="diagram-container">
                    <h3>Microservices Communication Pattern</h3>
                    <div class="microservices-mesh">
                        <!-- Connection lines -->
                        <svg style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#667eea" />
                                </marker>
                            </defs>
                            <!-- Lines will be drawn by JavaScript -->
                        </svg>

                        <!-- API Gateway in center -->
                        <div class="mesh-service gateway" style="left: 50%; top: 50%; transform: translate(-50%, -50%);">
                            <strong>API Gateway</strong>
                            <br><small>Kong/Nginx</small>
                        </div>

                        <!-- Core Services in ring around gateway -->
                        <div class="mesh-service core" style="left: 50%; top: 20%; transform: translateX(-50%);">
                            <strong>Auth Service</strong>
                            <br><small>OAuth 2.0/JWT</small>
                        </div>
                        <div class="mesh-service core" style="left: 75%; top: 35%; transform: translate(-50%, -50%);">
                            <strong>Definition Service</strong>
                            <br><small>Core Logic</small>
                        </div>
                        <div class="mesh-service core" style="left: 75%; top: 65%; transform: translate(-50%, -50%);">
                            <strong>Validation Service</strong>
                            <br><small>Quality Control</small>
                        </div>
                        <div class="mesh-service core" style="left: 50%; top: 80%; transform: translateX(-50%);">
                            <strong>Enrichment Service</strong>
                            <br><small>Content Enhancement</small>
                        </div>
                        <div class="mesh-service core" style="left: 25%; top: 65%; transform: translate(-50%, -50%);">
                            <strong>Export Service</strong>
                            <br><small>Multi-format</small>
                        </div>
                        <div class="mesh-service core" style="left: 25%; top: 35%; transform: translate(-50%, -50%);">
                            <strong>Notification Service</strong>
                            <br><small>Events & Alerts</small>
                        </div>

                        <!-- Support Services outer ring -->
                        <div class="mesh-service support" style="left: 85%; top: 50%; transform: translateY(-50%);">
                            <strong>Monitoring</strong>
                            <br><small>Prometheus</small>
                        </div>
                        <div class="mesh-service support" style="left: 15%; top: 50%; transform: translateY(-50%);">
                            <strong>Logging</strong>
                            <br><small>ELK Stack</small>
                        </div>

                        <!-- Data stores at bottom -->
                        <div class="mesh-service data" style="left: 20%; top: 90%; transform: translate(-50%, -50%);">
                            <strong>PostgreSQL</strong>
                            <br><small>Primary DB</small>
                        </div>
                        <div class="mesh-service data" style="left: 40%; top: 90%; transform: translate(-50%, -50%);">
                            <strong>Redis</strong>
                            <br><small>Cache</small>
                        </div>
                        <div class="mesh-service data" style="left: 60%; top: 90%; transform: translate(-50%, -50%);">
                            <strong>RabbitMQ</strong>
                            <br><small>Message Queue</small>
                        </div>
                        <div class="mesh-service data" style="left: 80%; top: 90%; transform: translate(-50%, -50%);">
                            <strong>S3/Blob</strong>
                            <br><small>Documents</small>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Event-Driven Architecture Flow</h3>
                    <div class="event-flow-diagram">
                        <div class="event-timeline">
                            <div class="event-connection"></div>
                            <div class="event-node trigger">
                                <small>User<br>Action</small>
                                <div class="event-label">1. Create Definition</div>
                            </div>
                            <div class="event-node">
                                <small>API<br>Gateway</small>
                                <div class="event-label">2. Route & Auth</div>
                            </div>
                            <div class="event-node">
                                <small>Definition<br>Service</small>
                                <div class="event-label">3. Process Request</div>
                            </div>
                            <div class="event-node trigger">
                                <small>Event<br>Published</small>
                                <div class="event-label">4. "DefinitionCreated"</div>
                            </div>
                            <div class="event-node">
                                <small>Validation<br>Service</small>
                                <div class="event-label">5. React to Event</div>
                            </div>
                            <div class="event-node">
                                <small>Enrichment<br>Service</small>
                                <div class="event-label">6. React to Event</div>
                            </div>
                            <div class="event-node">
                                <small>Notification<br>Service</small>
                                <div class="event-label">7. Send Updates</div>
                            </div>
                            <div class="event-node trigger">
                                <small>Complete</small>
                                <div class="event-label">8. All Done</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Service Mesh Architecture (Istio)</h3>
                    <div class="istio-mesh-diagram">
                        <div class="istio-control-plane">
                            <h4>Istio Control Plane</h4>
                            <small>Pilot ‚Ä¢ Citadel ‚Ä¢ Galley ‚Ä¢ Mixer</small>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 40px;">
                            <div class="istio-pod">
                                <h5>Definition Service Pod</h5>
                                <div class="istio-container">
                                    <div class="istio-app">
                                        <strong>App</strong>
                                        <br><small>FastAPI</small>
                                    </div>
                                    <div class="istio-proxy">
                                        <strong>Envoy</strong>
                                        <br><small>Sidecar</small>
                                    </div>
                                </div>
                            </div>

                            <div class="istio-pod">
                                <h5>Validation Service Pod</h5>
                                <div class="istio-container">
                                    <div class="istio-app">
                                        <strong>App</strong>
                                        <br><small>FastAPI</small>
                                    </div>
                                    <div class="istio-proxy">
                                        <strong>Envoy</strong>
                                        <br><small>Sidecar</small>
                                    </div>
                                </div>
                            </div>

                            <div class="istio-pod">
                                <h5>Enrichment Service Pod</h5>
                                <div class="istio-container">
                                    <div class="istio-app">
                                        <strong>App</strong>
                                        <br><small>FastAPI</small>
                                    </div>
                                    <div class="istio-proxy">
                                        <strong>Envoy</strong>
                                        <br><small>Sidecar</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 30px; color: #666;">
                            <small>‚Ä¢ Traffic Management ‚Ä¢ Security ‚Ä¢ Observability ‚Ä¢ Policy Enforcement ‚Ä¢</small>
                        </div>
                    </div>
                </div>

                <div class="diagram-container">
                    <h3>Domain-Driven Design - Bounded Contexts</h3>
                    <div class="domain-context-diagram">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 40px;">
                            <div class="bounded-context definition">
                                <h4 style="color: #2196f3;">Definition Context</h4>
                                <div class="context-aggregate" style="border-color: #2196f3;">
                                    <strong>Definition Aggregate</strong>
                                    <br><small>Root Entity</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #2196f3;">
                                    <strong>Term</strong>
                                    <br><small>Value Object</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #2196f3;">
                                    <strong>Metadata</strong>
                                    <br><small>Value Object</small>
                                </div>
                                <div class="context-relationship" style="top: 20px; right: -80px;">
                                    Upstream ‚ûú
                                </div>
                            </div>

                            <div class="bounded-context validation">
                                <h4 style="color: #4caf50;">Validation Context</h4>
                                <div class="context-aggregate" style="border-color: #4caf50;">
                                    <strong>Validation Rules</strong>
                                    <br><small>Entity</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #4caf50;">
                                    <strong>Quality Metrics</strong>
                                    <br><small>Value Object</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #4caf50;">
                                    <strong>Validation Result</strong>
                                    <br><small>Entity</small>
                                </div>
                                <div class="context-relationship" style="bottom: 20px; left: -80px;">
                                    ‚¨Ö Downstream
                                </div>
                            </div>

                            <div class="bounded-context enrichment">
                                <h4 style="color: #9c27b0;">Enrichment Context</h4>
                                <div class="context-aggregate" style="border-color: #9c27b0;">
                                    <strong>Synonyms</strong>
                                    <br><small>Entity</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #9c27b0;">
                                    <strong>Context Info</strong>
                                    <br><small>Value Object</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #9c27b0;">
                                    <strong>External Sources</strong>
                                    <br><small>Service</small>
                                </div>
                                <div class="context-relationship" style="top: -40px; left: 50%;">
                                    Partnership ‚Üî
                                </div>
                            </div>

                            <div class="bounded-context export">
                                <h4 style="color: #ff9800;">Export Context</h4>
                                <div class="context-aggregate" style="border-color: #ff9800;">
                                    <strong>Export Format</strong>
                                    <br><small>Entity</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #ff9800;">
                                    <strong>Template Engine</strong>
                                    <br><small>Service</small>
                                </div>
                                <div class="context-aggregate" style="border-color: #ff9800;">
                                    <strong>Delivery Method</strong>
                                    <br><small>Value Object</small>
                                </div>
                                <div class="context-relationship" style="bottom: -40px; right: 50%;">
                                    Consumer ‚¨Ö
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-section">
                <h2>11. Implementation Roadmap & Feature Planning</h2>

                <div class="roadmap-dashboard" id="roadmapDashboard">
                    <div class="dashboard-header">
                        <h3>Interactive Implementation Timeline</h3>
                        <p class="dashboard-subtitle">Plan your feature delivery with milestones and dependencies</p>
                        <div class="timeline-controls">
                            <button class="timeline-btn active" data-phase="all">All Phases</button>
                            <button class="timeline-btn" data-phase="1">Phase 1 (Foundation)</button>
                            <button class="timeline-btn" data-phase="2">Phase 2 (Services)</button>
                            <button class="timeline-btn" data-phase="3">Phase 3 (Features)</button>
                            <button class="timeline-btn" data-phase="4">Phase 4 (Scale)</button>
                        </div>
                    </div>

                    <!-- Implementation Timeline -->
                    <div class="implementation-timeline" id="implementationTimeline">
                        <div class="timeline-header">
                            <h4>16-Week Development Plan</h4>
                            <div class="timeline-legend">
                                <span class="legend-item complete">‚úÖ Complete</span>
                                <span class="legend-item in-progress">üîÑ In Progress</span>
                                <span class="legend-item planned">üìÖ Planned</span>
                                <span class="legend-item critical">üî¥ Critical Path</span>
                            </div>
                        </div>

                        <div class="timeline-container">
                            <div class="timeline-weeks">
                                <div class="week-header">Weeks 1-4</div>
                                <div class="week-header">Weeks 5-8</div>
                                <div class="week-header">Weeks 9-12</div>
                                <div class="week-header">Weeks 13-16</div>
                            </div>

                            <div class="timeline-phases" id="timelinePhases">
                                <!-- Phases will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>

                    <!-- Feature Dependencies Graph -->
                    <div class="dependencies-graph" id="dependenciesGraph">
                        <h4>Feature Dependencies & Critical Path</h4>
                        <div class="graph-container">
                            <svg id="dependencyGraph" width="100%" height="400" viewBox="0 0 1000 400">
                                <!-- Dependencies will be drawn dynamically -->
                            </svg>
                        </div>
                        <div class="dependency-controls">
                            <button class="dep-btn active" data-view="critical">Critical Path</button>
                            <button class="dep-btn" data-view="all">All Dependencies</button>
                            <button class="dep-btn" data-view="epic">By Epic</button>
                        </div>
                    </div>

                    <!-- Resource Planning -->
                    <div class="resource-planning" id="resourcePlanning">
                        <h4>Resource Allocation & Capacity Planning</h4>
                        <div class="resource-grid">
                            <div class="resource-card">
                                <h5>üë®‚Äçüíª Development Team</h5>
                                <div class="resource-chart">
                                    <div class="resource-bar" data-utilization="85">
                                        <span class="resource-label">Senior Dev</span>
                                        <div class="resource-fill" style="width: 85%">85%</div>
                                    </div>
                                    <div class="resource-bar" data-utilization="70">
                                        <span class="resource-label">Mid-level Dev</span>
                                        <div class="resource-fill" style="width: 70%">70%</div>
                                    </div>
                                    <div class="resource-bar" data-utilization="60">
                                        <span class="resource-label">Junior Dev</span>
                                        <div class="resource-fill" style="width: 60%">60%</div>
                                    </div>
                                </div>
                            </div>

                            <div class="resource-card">
                                <h5>üß™ Testing & QA</h5>
                                <div class="resource-chart">
                                    <div class="resource-bar" data-utilization="90">
                                        <span class="resource-label">QA Engineer</span>
                                        <div class="resource-fill" style="width: 90%">90%</div>
                                    </div>
                                    <div class="resource-bar" data-utilization="75">
                                        <span class="resource-label">Test Automation</span>
                                        <div class="resource-fill" style="width: 75%">75%</div>
                                    </div>
                                </div>
                            </div>

                            <div class="resource-card">
                                <h5>üîß DevOps & Infrastructure</h5>
                                <div class="resource-chart">
                                    <div class="resource-bar" data-utilization="80">
                                        <span class="resource-label">DevOps Engineer</span>
                                        <div class="resource-fill" style="width: 80%">80%</div>
                                    </div>
                                    <div class="resource-bar" data-utilization="65">
                                        <span class="resource-label">Cloud Architect</span>
                                        <div class="resource-fill" style="width: 65%">65%</div>
                                    </div>
                                </div>
                            </div>

                            <div class="resource-card">
                                <h5>üé® UX/UI Design</h5>
                                <div class="resource-chart">
                                    <div class="resource-bar" data-utilization="55">
                                        <span class="resource-label">UX Designer</span>
                                        <div class="resource-fill" style="width: 55%">55%</div>
                                    </div>
                                    <div class="resource-bar" data-utilization="40">
                                        <span class="resource-label">UI Designer</span>
                                        <div class="resource-fill" style="width: 40%">40%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Assessment -->
                    <div class="risk-assessment" id="riskAssessment">
                        <h4>Implementation Risk Assessment</h4>
                        <div class="risk-matrix">
                            <div class="risk-header">
                                <div class="risk-cell">Risk Factor</div>
                                <div class="risk-cell">Probability</div>
                                <div class="risk-cell">Impact</div>
                                <div class="risk-cell">Mitigation</div>
                                <div class="risk-cell">Owner</div>
                            </div>

                            <div class="risk-row high">
                                <div class="risk-cell">Authentication Implementation Delays</div>
                                <div class="risk-cell high">High (70%)</div>
                                <div class="risk-cell high">High</div>
                                <div class="risk-cell">Start early, use OAuth library</div>
                                <div class="risk-cell">Senior Dev</div>
                            </div>

                            <div class="risk-row medium">
                                <div class="risk-cell">API Rate Limits (OpenAI)</div>
                                <div class="risk-cell medium">Medium (40%)</div>
                                <div class="risk-cell high">High</div>
                                <div class="risk-cell">Implement caching & retry logic</div>
                                <div class="risk-cell">Backend Team</div>
                            </div>

                            <div class="risk-row medium">
                                <div class="risk-cell">Database Migration Complexity</div>
                                <div class="risk-cell medium">Medium (30%)</div>
                                <div class="risk-cell medium">Medium</div>
                                <div class="risk-cell">Gradual migration strategy</div>
                                <div class="risk-cell">DevOps</div>
                            </div>

                            <div class="risk-row low">
                                <div class="risk-cell">UI Component Inconsistencies</div>
                                <div class="risk-cell low">Low (20%)</div>
                                <div class="risk-cell low">Low</div>
                                <div class="risk-cell">Design system implementation</div>
                                <div class="risk-cell">UI Team</div>
                            </div>
                        </div>
                    </div>

                    <!-- Success Metrics -->
                    <div class="success-metrics" id="successMetrics">
                        <h4>Success Metrics & KPIs</h4>
                        <div class="metrics-dashboard">
                            <div class="metric-category">
                                <h5>üìä Performance Metrics</h5>
                                <div class="metric-item">
                                    <span class="metric-name">Response Time</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 60%">
                                            <span class="progress-text">Target: <5s</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-name">Concurrent Users</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 80%">
                                            <span class="progress-text">Target: 10+</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="metric-category">
                                <h5>üîß Technical Metrics</h5>
                                <div class="metric-item">
                                    <span class="metric-name">Test Coverage</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 80%">
                                            <span class="progress-text">Target: 80%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-name">API Uptime</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 99%">
                                            <span class="progress-text">Target: 99.9%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="metric-category">
                                <h5>üë• User Experience</h5>
                                <div class="metric-item">
                                    <span class="metric-name">Feature Completeness</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 100%">
                                            <span class="progress-text">Target: 100%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-name">User Satisfaction</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar target" style="width: 85%">
                                            <span class="progress-text">Target: 8.5/10</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <style>
                /* TO-BE Roadmap Dashboard Styles */
                .roadmap-dashboard {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 30px;
                    border-radius: 15px;
                    margin-top: 20px;
                }

                .timeline-controls {
                    margin-top: 15px;
                    display: flex;
                    gap: 10px;
                    justify-content: center;
                }

                .timeline-btn {
                    padding: 8px 16px;
                    border: 2px solid rgba(255,255,255,0.3);
                    background: rgba(255,255,255,0.1);
                    color: white;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-size: 14px;
                }

                .timeline-btn:hover {
                    background: rgba(255,255,255,0.2);
                }

                .timeline-btn.active {
                    background: rgba(255,255,255,0.3);
                    border-color: white;
                }

                .implementation-timeline {
                    background: rgba(255,255,255,0.1);
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .timeline-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 30px;
                }

                .timeline-legend {
                    display: flex;
                    gap: 20px;
                }

                .legend-item {
                    font-size: 12px;
                    padding: 5px 10px;
                    background: rgba(255,255,255,0.1);
                    border-radius: 15px;
                }

                .timeline-weeks {
                    display: grid;
                    grid-template-columns: repeat(4, 1fr);
                    gap: 20px;
                    margin-bottom: 20px;
                }

                .week-header {
                    text-align: center;
                    font-weight: bold;
                    padding: 10px;
                    background: rgba(255,255,255,0.2);
                    border-radius: 5px;
                }

                .timeline-phase {
                    background: rgba(255,255,255,0.15);
                    padding: 20px;
                    border-radius: 8px;
                    margin: 10px 0;
                    border-left: 4px solid #4caf50;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }

                .timeline-phase:hover {
                    background: rgba(255,255,255,0.25);
                    transform: translateX(5px);
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    cursor: pointer;
                }

                .timeline-phase:active {
                    transform: translateX(5px) scale(0.98);
                }

                .timeline-phase.critical {
                    border-left-color: #f44336;
                }

                .timeline-phase.in-progress {
                    border-left-color: #ff9800;
                }

                .dependencies-graph {
                    background: rgba(255,255,255,0.1);
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .dependency-controls {
                    margin-top: 20px;
                    display: flex;
                    gap: 10px;
                    justify-content: center;
                }

                .dep-btn {
                    padding: 8px 16px;
                    border: 2px solid rgba(255,255,255,0.3);
                    background: rgba(255,255,255,0.1);
                    color: white;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }

                .dep-btn.active {
                    background: rgba(255,255,255,0.3);
                }

                .resource-planning {
                    background: rgba(255,255,255,0.1);
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .resource-grid {
                    display: grid;
                    grid-template-columns: repeat(2, 1fr);
                    gap: 20px;
                    margin-top: 20px;
                }

                .resource-card {
                    background: rgba(255,255,255,0.1);
                    padding: 20px;
                    border-radius: 8px;
                }

                .resource-bar {
                    display: flex;
                    align-items: center;
                    margin: 10px 0;
                }

                .resource-label {
                    width: 120px;
                    font-size: 12px;
                }

                .resource-fill {
                    background: linear-gradient(to right, #4caf50, #81c784);
                    height: 20px;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 12px;
                    font-weight: bold;
                    color: white;
                    transition: all 0.3s ease;
                    cursor: pointer;
                }

                .resource-fill:hover {
                    background: linear-gradient(to right, #66bb6a, #a5d6a7);
                    transform: scaleY(1.1);
                    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
                }

                @keyframes fillAnimation {
                    from { width: 0; }
                }

                .risk-assessment {
                    background: rgba(255,255,255,0.1);
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .risk-matrix {
                    display: grid;
                    grid-template-columns: 2fr 1fr 1fr 2fr 1fr;
                    gap: 1px;
                    background: rgba(255,255,255,0.2);
                    margin-top: 20px;
                }

                .risk-header {
                    display: contents;
                }

                .risk-row {
                    display: contents;
                }

                .risk-cell {
                    padding: 15px;
                    background: rgba(255,255,255,0.1);
                    font-size: 12px;
                    transition: all 0.2s ease;
                }

                .risk-cell:hover {
                    background: rgba(255,255,255,0.15);
                    transform: scale(1.02);
                }

                .risk-row.high .risk-cell {
                    background: rgba(244, 67, 54, 0.2);
                }

                .risk-row.medium .risk-cell {
                    background: rgba(255, 152, 0, 0.2);
                }

                .risk-row.low .risk-cell {
                    background: rgba(76, 175, 80, 0.2);
                }

                .success-metrics {
                    background: rgba(255,255,255,0.1);
                    padding: 30px;
                    border-radius: 10px;
                    margin-top: 30px;
                }

                .metrics-dashboard {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 20px;
                    margin-top: 20px;
                }

                .metric-category {
                    background: rgba(255,255,255,0.1);
                    padding: 20px;
                    border-radius: 8px;
                    transition: all 0.3s ease;
                    cursor: pointer;
                }

                .metric-category:hover {
                    background: rgba(255,255,255,0.15);
                    transform: translateY(-3px);
                    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                }

                .metric-item {
                    margin: 15px 0;
                }

                .metric-name {
                    display: block;
                    font-size: 12px;
                    margin-bottom: 5px;
                }

                .metric-progress {
                    background: rgba(255,255,255,0.1);
                    height: 25px;
                    border-radius: 12px;
                    overflow: hidden;
                }

                .progress-bar.target {
                    background: linear-gradient(to right, #4caf50, #8bc34a);
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                }

                .progress-bar.target:hover {
                    background: linear-gradient(to right, #66bb6a, #aed581);
                    box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
                }
            </style>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from all buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');

            // Set active button
            event.target.classList.add('active');
        }
    </script>

    <script>
        // Draw relationship lines for diagrams
        function drawMicroservicesConnections() {
            const container = document.querySelector('.microservices-mesh');
            if (!container) return;

            const svg = container.querySelector('svg');
            if (!svg) return;

            // Clear existing lines but keep defs
            const defs = svg.querySelector('defs');
            svg.innerHTML = '';
            if (defs) svg.appendChild(defs);

            // Get service positions
            const gateway = container.querySelector('.mesh-service.gateway');
            const services = container.querySelectorAll('.mesh-service.core');
            const dataServices = container.querySelectorAll('.mesh-service.data');

            if (gateway) {
                const gatewayRect = gateway.getBoundingClientRect();
                const containerRect = container.getBoundingClientRect();
                const gatewayCenterX = gatewayRect.left + gatewayRect.width / 2 - containerRect.left;
                const gatewayCenterY = gatewayRect.top + gatewayRect.height / 2 - containerRect.top;

                // Draw lines from gateway to all core services
                services.forEach(service => {
                    const serviceRect = service.getBoundingClientRect();
                    const serviceCenterX = serviceRect.left + serviceRect.width / 2 - containerRect.left;
                    const serviceCenterY = serviceRect.top + serviceRect.height / 2 - containerRect.top;

                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', gatewayCenterX);
                    line.setAttribute('y1', gatewayCenterY);
                    line.setAttribute('x2', serviceCenterX);
                    line.setAttribute('y2', serviceCenterY);
                    line.setAttribute('stroke', '#667eea');
                    line.setAttribute('stroke-width', '2');
                    line.setAttribute('opacity', '0.3');
                    svg.appendChild(line);
                });

                // Draw lines from services to data stores
                dataServices.forEach((dataService, index) => {
                    if (index < services.length) {
                        const service = services[index];
                        const serviceRect = service.getBoundingClientRect();
                        const dataRect = dataService.getBoundingClientRect();

                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', serviceRect.left + serviceRect.width / 2 - containerRect.left);
                        line.setAttribute('y1', serviceRect.top + serviceRect.height / 2 - containerRect.top);
                        line.setAttribute('x2', dataRect.left + dataRect.width / 2 - containerRect.left);
                        line.setAttribute('y2', dataRect.top + dataRect.height / 2 - containerRect.top);
                        line.setAttribute('stroke', '#999');
                        line.setAttribute('stroke-width', '1');
                        line.setAttribute('stroke-dasharray', '5,5');
                        line.setAttribute('opacity', '0.5');
                        svg.appendChild(line);
                    }
                });
            }
        }

        // Initialize on load and tab switch
        window.addEventListener('load', () => {
            setTimeout(drawMicroservicesConnections, 100);

            // Redraw when tab is switched
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    setTimeout(drawMicroservicesConnections, 200);
                });
            });
        });

        // Redraw on window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(drawMicroservicesConnections, 250);
        });
    </script>

    <script>
        // Feature Dashboard JavaScript
        const featureData = {
            epics: [
                {
                    id: 'epic-001',
                    name: 'Basis Definitie Generatie',
                    description: 'Core functionality voor het genereren van definities',
                    features: [
                        { id: 'DEF-001', name: 'AI-gestuurde definitie generator', status: 'complete' },
                        { id: 'DEF-002', name: 'Context-bewuste generatie', status: 'complete' },
                        { id: 'DEF-003', name: 'Definitie templates', status: 'complete' },
                        { id: 'DEF-004', name: 'Bulk generatie mogelijkheden', status: 'not-started' },
                        { id: 'DEF-005', name: 'Multi-taal ondersteuning', status: 'complete' }
                    ]
                },
                {
                    id: 'epic-002',
                    name: 'Kwaliteitstoetsing',
                    description: 'Validatie en kwaliteitscontrole van gegenereerde definities',
                    features: [
                        { id: 'VAL-001', name: 'Automatische validatie regels', status: 'complete' },
                        { id: 'VAL-002', name: 'Expert review workflow', status: 'in-progress' },
                        { id: 'VAL-003', name: 'Kwaliteitsscore berekening', status: 'complete' },
                        { id: 'VAL-004', name: 'Feedback incorporatie systeem', status: 'complete' }
                    ]
                },
                {
                    id: 'epic-003',
                    name: 'User Interface',
                    description: 'Gebruikersinterface en navigatie',
                    features: [
                        { id: 'UI-001', name: 'Definition Generator Tab', status: 'complete' },
                        { id: 'UI-002', name: 'Expert Review Tab', status: 'in-progress' },
                        { id: 'UI-003', name: 'History Tab', status: 'complete' },
                        { id: 'UI-004', name: 'Export Tab', status: 'in-progress' },
                        { id: 'UI-005', name: 'Web Lookup Tab', status: 'not-started' },
                        { id: 'UI-006', name: 'Quality Control Tab', status: 'not-started' },
                        { id: 'UI-007', name: 'External Sources Tab', status: 'not-started' },
                        { id: 'UI-008', name: 'Monitoring Tab', status: 'not-started' },
                        { id: 'UI-009', name: 'Orchestration Tab', status: 'not-started' },
                        { id: 'UI-010', name: 'Context Selector Tab', status: 'not-started' },
                        { id: 'UI-011', name: 'Responsive design', status: 'not-started' },
                        { id: 'UI-012', name: 'Dark mode support', status: 'not-started' },
                        { id: 'UI-013', name: 'Keyboard shortcuts', status: 'not-started' },
                        { id: 'UI-014', name: 'Accessibility features', status: 'not-started' },
                        { id: 'UI-015', name: 'Multi-language UI', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-004',
                    name: 'Security & Authentication',
                    description: 'Beveiliging en gebruikersauthenticatie',
                    features: [
                        { id: 'SEC-001', name: 'User authentication system', status: 'not-started', critical: true },
                        { id: 'SEC-002', name: 'Role-based access control', status: 'not-started', critical: true },
                        { id: 'SEC-003', name: 'API key management', status: 'not-started', critical: true },
                        { id: 'SEC-004', name: 'Data encryption at rest', status: 'not-started', critical: true },
                        { id: 'SEC-005', name: 'Audit logging', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-005',
                    name: 'Performance',
                    description: 'Performance optimalisatie en monitoring',
                    features: [
                        { id: 'PERF-001', name: 'Response time optimization', status: 'not-started', critical: true },
                        { id: 'PERF-002', name: 'Database query optimization', status: 'in-progress' },
                        { id: 'PERF-003', name: 'Caching implementation', status: 'not-started' },
                        { id: 'PERF-004', name: 'Load balancing', status: 'not-started' },
                        { id: 'PERF-005', name: 'Performance monitoring', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-006',
                    name: 'Export/Import',
                    description: 'Data export en import functionaliteit',
                    features: [
                        { id: 'EXP-001', name: 'JSON export', status: 'complete' },
                        { id: 'EXP-002', name: 'Excel export', status: 'in-progress' },
                        { id: 'EXP-003', name: 'PDF export', status: 'not-started' },
                        { id: 'EXP-004', name: 'Word export', status: 'not-started' },
                        { id: 'EXP-005', name: 'CSV export', status: 'not-started' },
                        { id: 'EXP-006', name: 'Bulk import', status: 'not-started', critical: true },
                        { id: 'EXP-007', name: 'API integration', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-007',
                    name: 'Web Lookup & Integration',
                    description: 'Externe data bronnen integratie',
                    features: [
                        { id: 'WEB-001', name: 'Web search integration', status: 'not-started', critical: true },
                        { id: 'WEB-002', name: 'Wikipedia integration', status: 'not-started' },
                        { id: 'WEB-003', name: 'Dictionary API integration', status: 'not-started' },
                        { id: 'WEB-004', name: 'External source validation', status: 'not-started' },
                        { id: 'WEB-005', name: 'Source attribution', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-008',
                    name: 'Monitoring & Analytics',
                    description: 'System monitoring en analytics',
                    features: [
                        { id: 'MON-001', name: 'Usage analytics', status: 'in-progress' },
                        { id: 'MON-002', name: 'Error tracking', status: 'complete' },
                        { id: 'MON-003', name: 'Performance metrics', status: 'not-started' },
                        { id: 'MON-004', name: 'User behavior tracking', status: 'not-started' },
                        { id: 'MON-005', name: 'System health dashboard', status: 'not-started' }
                    ]
                },
                {
                    id: 'epic-009',
                    name: 'Content Management',
                    description: 'Beheer van definities en content',
                    features: [
                        { id: 'CMS-001', name: 'Version control for definitions', status: 'complete' },
                        { id: 'CMS-002', name: 'Definition categorization', status: 'complete' },
                        { id: 'CMS-003', name: 'Tag management', status: 'in-progress' },
                        { id: 'CMS-004', name: 'Search functionality', status: 'complete' },
                        { id: 'CMS-005', name: 'Archive management', status: 'not-started' },
                        { id: 'CMS-006', name: 'Duplicate detection', status: 'not-started' }
                    ]
                }
            ]
        };

        // Initialize dashboard
        function initializeDashboard() {
            // Check if we should load from API or use static data
            if (window.location.protocol === 'file:' || !window.FEATURE_API_URL) {
                // Use static data
                calculateStatistics();
                renderEpics();
                renderCriticalFeatures();
                setupEventListeners();
                animateProgress();
            } else {
                // Load from API
                loadFeatureDataFromAPI();
            }
        }

        // Load feature data from API
        async function loadFeatureDataFromAPI() {
            try {
                const response = await fetch(window.FEATURE_API_URL || '/api/feature-status');
                if (!response.ok) throw new Error('Failed to fetch feature data');

                const data = await response.json();

                // Update featureData with API response
                if (data.epics) {
                    featureData.epics = data.epics;
                }

                // Show last updated time
                if (data.lastUpdated) {
                    showLastUpdated(data.lastUpdated);
                }

                // Continue with normal initialization
                calculateStatistics();
                renderEpics();
                renderCriticalFeatures();
                setupEventListeners();
                animateProgress();

            } catch (error) {
                console.error('Error loading feature data:', error);
                // Fallback to static data
                calculateStatistics();
                renderEpics();
                renderCriticalFeatures();
                setupEventListeners();
                animateProgress();
            }
        }

        // Show last updated timestamp
        function showLastUpdated(timestamp) {
            const date = new Date(timestamp);
            const formatted = date.toLocaleString('nl-NL', {
                day: 'numeric',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            const updateDiv = document.createElement('div');
            updateDiv.style.cssText = 'text-align: center; font-size: 12px; opacity: 0.7; margin-top: 10px;';
            updateDiv.innerHTML = `Laatste update: ${formatted}`;

            const dashboardHeader = document.querySelector('.dashboard-header');
            if (dashboardHeader) {
                dashboardHeader.appendChild(updateDiv);
            }
        }

        // Calculate feature statistics
        function calculateStatistics() {
            let complete = 0;
            let inProgress = 0;
            let notStarted = 0;
            let total = 0;

            featureData.epics.forEach(epic => {
                epic.features.forEach(feature => {
                    total++;
                    switch(feature.status) {
                        case 'complete': complete++; break;
                        case 'in-progress': inProgress++; break;
                        case 'not-started': notStarted++; break;
                    }
                });
            });

            // Update counts
            document.getElementById('completeCount').textContent = complete;
            document.getElementById('progressCount').textContent = inProgress;
            document.getElementById('notStartedCount').textContent = notStarted;
            document.getElementById('totalCount').textContent = total;

            // Update percentages
            const completePercent = Math.round((complete / total) * 100);
            const progressPercent = Math.round((inProgress / total) * 100);
            const notStartedPercent = Math.round((notStarted / total) * 100);

            document.getElementById('completePercent').textContent = completePercent + '%';
            document.getElementById('progressPercent').textContent = progressPercent + '%';
            document.getElementById('notStartedPercent').textContent = notStartedPercent + '%';
            document.getElementById('percentageText').textContent = completePercent + '%';

            // Store for animation
            window.dashboardStats = { complete, inProgress, notStarted, total, completePercent, progressPercent };
        }

        // Animate progress circle
        function animateProgress() {
            const circumference = 2 * Math.PI * 90;
            const completeLength = (window.dashboardStats.completePercent / 100) * circumference;
            const progressLength = (window.dashboardStats.progressPercent / 100) * circumference;

            const completeCircle = document.getElementById('completeCircle');
            const progressCircle = document.getElementById('progressCircle');

            // Animate complete section
            completeCircle.style.transition = 'stroke-dasharray 1.5s ease-out';
            completeCircle.setAttribute('stroke-dasharray', `${completeLength} ${circumference}`);

            // Animate in-progress section
            setTimeout(() => {
                progressCircle.style.transition = 'stroke-dasharray 1.5s ease-out';
                progressCircle.setAttribute('stroke-dasharray', `${progressLength} ${circumference}`);
                progressCircle.setAttribute('stroke-dashoffset', `-${completeLength}`);
            }, 500);
        }

        // Render epic breakdown
        function renderEpics() {
            const container = document.getElementById('epicContainer');
            container.innerHTML = '';

            featureData.epics.forEach(epic => {
                const epicStats = calculateEpicStats(epic);
                const epicElement = createEpicElement(epic, epicStats);
                container.appendChild(epicElement);
            });
        }

        // Calculate stats for an epic
        function calculateEpicStats(epic) {
            let complete = 0;
            epic.features.forEach(feature => {
                if (feature.status === 'complete') complete++;
            });
            const percentage = Math.round((complete / epic.features.length) * 100);
            return { complete, total: epic.features.length, percentage };
        }

        // Create epic element
        function createEpicElement(epic, stats) {
            const div = document.createElement('div');
            div.className = 'epic-item';
            if (stats.percentage === 0) div.classList.add('critical');

            div.innerHTML = `
                <div class="epic-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <div>
                        <span class="epic-name" style="font-weight: bold; color: white;">${epic.name}</span>
                        <br><small style="opacity: 0.7;">${epic.description || ''}</small>
                    </div>
                    <span class="epic-status" style="background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 12px; font-size: 12px;">${stats.complete}/${stats.total} features</span>
                </div>
                <div class="progress-bar-container" style="background: rgba(255,255,255,0.1); height: 20px; border-radius: 10px; overflow: hidden; position: relative;">
                    <div class="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(to right, #4caf50, #81c784); transition: width 1.5s ease-out; display: flex; align-items: center; justify-content: center;">
                        <span class="progress-text" style="font-size: 12px; font-weight: bold; color: white; position: absolute; left: 50%; transform: translateX(-50%);">${stats.percentage}%</span>
                    </div>
                </div>
                <div class="click-hint" style="text-align: center; margin-top: 8px; font-size: 11px; opacity: 0.6;">Klik voor feature details ‚ñ∂</div>
            `;

            div.addEventListener('click', () => {
                div.classList.add('expanded');
                showEpicDetails(epic);
            });

            // Animate progress bar after element is added to DOM
            setTimeout(() => {
                const progressBar = div.querySelector('.progress-bar');
                if (progressBar) {
                    progressBar.style.width = `${stats.percentage}%`;
                }
            }, 100);

            return div;
        }

        // Show epic details
        function showEpicDetails(epic) {
            // Animate out current sections
            const breakdownSection = document.getElementById('epicBreakdown');
            const criticalSection = document.getElementById('criticalFeatures');
            const detailsSection = document.getElementById('featureDetails');

            breakdownSection.style.transition = 'all 0.3s ease-out';
            criticalSection.style.transition = 'all 0.3s ease-out';
            breakdownSection.style.opacity = '0';
            criticalSection.style.opacity = '0';
            breakdownSection.style.transform = 'translateY(-20px)';
            criticalSection.style.transform = 'translateY(-20px)';

            setTimeout(() => {
                breakdownSection.style.display = 'none';
                criticalSection.style.display = 'none';
                detailsSection.style.display = 'block';

                document.getElementById('epicTitle').textContent = epic.name;

                const featureList = document.getElementById('featureList');
                featureList.innerHTML = '';

                epic.features.forEach((feature, index) => {
                    const featureDiv = document.createElement('div');
                    featureDiv.className = `feature-item ${feature.status}`;

                    const statusClass = `status-${feature.status}`;
                    const statusText = feature.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());

                    featureDiv.innerHTML = `
                        <div>
                            <strong>${feature.id}</strong>: ${feature.name}
                            ${feature.critical ? '<span style="color: #f44336; margin-left: 8px;">üî¥ Critical</span>' : ''}
                        </div>
                        <span class="feature-status ${statusClass}">${statusText}</span>
                    `;

                    // Initial animation state
                    featureDiv.style.opacity = '0';
                    featureDiv.style.transform = 'translateX(-20px)';

                    featureList.appendChild(featureDiv);

                    // Animate in
                    setTimeout(() => {
                        featureDiv.style.transition = 'all 0.4s ease-out';
                        featureDiv.style.opacity = '1';
                        featureDiv.style.transform = 'translateX(0)';
                    }, index * 100);
                });

                // Animate in details section
                detailsSection.style.opacity = '0';
                detailsSection.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    detailsSection.style.transition = 'all 0.5s ease-out';
                    detailsSection.style.opacity = '1';
                    detailsSection.style.transform = 'translateY(0)';
                }, 50);
            }, 300);
        }

        // Hide feature details
        function hideFeatureDetails() {
            // Remove expanded class from all epic items
            document.querySelectorAll('.epic-item').forEach(item => {
                item.classList.remove('expanded');
            });

            // Animate transition
            const detailsSection = document.getElementById('featureDetails');
            const breakdownSection = document.getElementById('epicBreakdown');
            const criticalSection = document.getElementById('criticalFeatures');

            detailsSection.style.opacity = '0';
            detailsSection.style.transform = 'translateY(20px)';

            setTimeout(() => {
                detailsSection.style.display = 'none';
                breakdownSection.style.display = 'block';
                criticalSection.style.display = 'block';

                breakdownSection.style.opacity = '0';
                criticalSection.style.opacity = '0';

                setTimeout(() => {
                    breakdownSection.style.transition = 'opacity 0.5s ease-out';
                    criticalSection.style.transition = 'opacity 0.5s ease-out';
                    breakdownSection.style.opacity = '1';
                    criticalSection.style.opacity = '1';
                }, 10);
            }, 300);
        }

        // Render critical features
        function renderCriticalFeatures() {
            const grid = document.getElementById('criticalGrid');
            grid.innerHTML = '';

            const criticalFeatures = [
                {
                    priority: 'high',
                    icon: 'üî¥',
                    title: 'Authentication System',
                    description: 'No user authentication or authorization implemented',
                    epic: 'Security & Authentication'
                },
                {
                    priority: 'high',
                    icon: 'üî¥',
                    title: 'Web Lookup Integration',
                    description: 'External data source integration not functional',
                    epic: 'Web Lookup & Integration'
                },
                {
                    priority: 'high',
                    icon: 'üî¥',
                    title: 'Bulk Operations',
                    description: 'No bulk import/export capabilities',
                    epic: 'Export/Import'
                },
                {
                    priority: 'medium',
                    icon: 'üü°',
                    title: 'Performance Optimization',
                    description: 'Response times exceed acceptable limits (8-12s)',
                    epic: 'Performance'
                },
                {
                    priority: 'medium',
                    icon: 'üü°',
                    title: 'Export Formats',
                    description: 'Limited export options (only JSON/Excel)',
                    epic: 'Export/Import'
                },
                {
                    priority: 'low',
                    icon: 'üü¢',
                    title: 'UI Completion',
                    description: '7 tabs remain unimplemented',
                    epic: 'User Interface'
                }
            ];

            criticalFeatures.forEach(feature => {
                const card = document.createElement('div');
                card.className = `critical-card ${feature.priority}`;
                card.innerHTML = `
                    <div class="critical-icon">${feature.icon}</div>
                    <div class="critical-content">
                        <h4>${feature.title}</h4>
                        <p>${feature.description}</p>
                        <small style="color: #666;">Epic: ${feature.epic}</small>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterFeatures(e.target.dataset.filter);
                });
            });

            // Stat cards
            document.querySelectorAll('.stat-card.clickable').forEach(card => {
                card.addEventListener('click', (e) => {
                    const filter = card.dataset.filter;
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector(`.filter-btn[data-filter="${filter}"]`).classList.add('active');
                    filterFeatures(filter);
                });
            });
        }

        // Filter features
        function filterFeatures(filter) {
            const breakdownSection = document.getElementById('epicBreakdown');
            const criticalSection = document.getElementById('criticalFeatures');
            const detailsSection = document.getElementById('featureDetails');

            if (filter === 'all') {
                // Show normal epic view
                detailsSection.style.display = 'none';
                breakdownSection.style.display = 'block';
                criticalSection.style.display = 'block';
                renderEpics();
            } else if (filter === 'critical') {
                // Show only critical features
                renderCriticalFeaturesList();
            } else {
                // Show filtered features list
                renderFilteredFeaturesList(filter);
            }
        }

        // Render filtered features list
        function renderFilteredFeaturesList(statusFilter) {
            const breakdownSection = document.getElementById('epicBreakdown');
            const criticalSection = document.getElementById('criticalFeatures');
            const detailsSection = document.getElementById('featureDetails');

            // Hide epic breakdown and critical features
            breakdownSection.style.display = 'none';
            criticalSection.style.display = 'none';
            detailsSection.style.display = 'block';

            // Update title
            const statusText = statusFilter.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
            document.getElementById('epicTitle').textContent = `${statusText} Features`;

            // Create back button if it doesn't exist
            const backBtn = detailsSection.querySelector('.back-btn');
            if (backBtn) {
                backBtn.onclick = () => {
                    document.querySelector('.filter-btn[data-filter="all"]').click();
                };
            }

            const featureList = document.getElementById('featureList');
            featureList.innerHTML = '';

            // Collect all features with the specified status
            let filteredFeatures = [];
            featureData.epics.forEach(epic => {
                epic.features.forEach(feature => {
                    if (feature.status === statusFilter) {
                        filteredFeatures.push({
                            ...feature,
                            epicName: epic.name,
                            epicId: epic.id
                        });
                    }
                });
            });

            // Display count
            const countDiv = document.createElement('div');
            countDiv.style.cssText = 'text-align: center; margin-bottom: 20px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;';
            countDiv.innerHTML = `<strong>${filteredFeatures.length} features</strong> met status: <strong>${statusText}</strong>`;
            featureList.appendChild(countDiv);

            // Group by epic
            const featuresByEpic = {};
            filteredFeatures.forEach(feature => {
                if (!featuresByEpic[feature.epicName]) {
                    featuresByEpic[feature.epicName] = [];
                }
                featuresByEpic[feature.epicName].push(feature);
            });

            // Display features grouped by epic
            Object.entries(featuresByEpic).forEach(([epicName, features]) => {
                const epicGroup = document.createElement('div');
                epicGroup.style.cssText = 'margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;';

                const epicHeader = document.createElement('h4');
                epicHeader.style.cssText = 'margin: 0 0 15px 0; color: #667eea;';
                epicHeader.textContent = epicName;
                epicGroup.appendChild(epicHeader);

                features.forEach((feature, index) => {
                    const featureDiv = document.createElement('div');
                    featureDiv.className = `feature-item ${feature.status}`;

                    const statusClass = `status-${feature.status}`;
                    const statusText = feature.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());

                    featureDiv.innerHTML = `
                        <div>
                            <strong>${feature.id}</strong>: ${feature.name}
                            ${feature.critical ? '<span style="color: #f44336; margin-left: 8px;">üî¥ Critical</span>' : ''}
                        </div>
                        <span class="feature-status ${statusClass}">${statusText}</span>
                    `;

                    // Initial animation state
                    featureDiv.style.opacity = '0';
                    featureDiv.style.transform = 'translateX(-20px)';

                    epicGroup.appendChild(featureDiv);

                    // Animate in
                    setTimeout(() => {
                        featureDiv.style.transition = 'all 0.4s ease-out';
                        featureDiv.style.opacity = '1';
                        featureDiv.style.transform = 'translateX(0)';
                    }, index * 50);
                });

                featureList.appendChild(epicGroup);
            });
        }

        // Render critical features list
        function renderCriticalFeaturesList() {
            const breakdownSection = document.getElementById('epicBreakdown');
            const criticalSection = document.getElementById('criticalFeatures');
            const detailsSection = document.getElementById('featureDetails');

            // Hide epic breakdown
            breakdownSection.style.display = 'none';
            criticalSection.style.display = 'block';
            detailsSection.style.display = 'block';

            // Update title
            document.getElementById('epicTitle').textContent = 'Critical Features';

            // Create back button if it doesn't exist
            const backBtn = detailsSection.querySelector('.back-btn');
            if (backBtn) {
                backBtn.onclick = () => {
                    document.querySelector('.filter-btn[data-filter="all"]').click();
                };
            }

            const featureList = document.getElementById('featureList');
            featureList.innerHTML = '';

            // Collect all critical features
            let criticalFeatures = [];
            featureData.epics.forEach(epic => {
                epic.features.forEach(feature => {
                    if (feature.critical) {
                        criticalFeatures.push({
                            ...feature,
                            epicName: epic.name,
                            epicId: epic.id
                        });
                    }
                });
            });

            // Display count
            const countDiv = document.createElement('div');
            countDiv.style.cssText = 'text-align: center; margin-bottom: 20px; padding: 10px; background: rgba(255,0,0,0.1); border-radius: 8px;';
            countDiv.innerHTML = `<strong>${criticalFeatures.length} critical features</strong> gevonden`;
            featureList.appendChild(countDiv);

            // Display all critical features
            criticalFeatures.forEach((feature, index) => {
                const featureDiv = document.createElement('div');
                featureDiv.className = `feature-item ${feature.status}`;
                featureDiv.style.cssText = 'border-left: 4px solid #f44336;';

                const statusClass = `status-${feature.status}`;
                const statusText = feature.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());

                featureDiv.innerHTML = `
                    <div>
                        <strong>${feature.id}</strong>: ${feature.name}
                        <br><small style="opacity: 0.7;">Epic: ${feature.epicName}</small>
                        <span style="color: #f44336; margin-left: 8px;">üî¥ Critical</span>
                    </div>
                    <span class="feature-status ${statusClass}">${statusText}</span>
                `;

                // Initial animation state
                featureDiv.style.opacity = '0';
                featureDiv.style.transform = 'translateX(-20px)';

                featureList.appendChild(featureDiv);

                // Animate in
                setTimeout(() => {
                    featureDiv.style.transition = 'all 0.4s ease-out';
                    featureDiv.style.opacity = '1';
                    featureDiv.style.transform = 'translateX(0)';
                }, index * 50);
            });
        }

        // Initialize when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeDashboard);
        } else {
            initializeDashboard();
        }

        // Reinitialize when switching to AS-IS tab
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                if (button.textContent.includes('AS-IS')) {
                    setTimeout(initializeDashboard, 100);
                } else if (button.textContent.includes('TO-BE')) {
                    setTimeout(initializeRoadmapDashboard, 100);
                }
            });
        });

        // TO-BE Roadmap Dashboard JavaScript
        const roadmapData = {
            phases: [
                {
                    id: 'phase-1',
                    name: 'Phase 1: Foundation',
                    weeks: '1-4',
                    status: 'in-progress',
                    progress: 30,
                    critical: true,
                    tasks: [
                        { name: 'Setup WAL Mode & Database', status: 'complete', owner: 'DevOps' },
                        { name: 'CI/CD Pipeline', status: 'complete', owner: 'DevOps' },
                        { name: 'Authentication System', status: 'in-progress', owner: 'Backend' },
                        { name: 'Basic API Structure', status: 'complete', owner: 'Backend' }
                    ]
                },
                {
                    id: 'phase-2',
                    name: 'Phase 2: Services',
                    weeks: '5-8',
                    status: 'planned',
                    progress: 10,
                    critical: false,
                    tasks: [
                        { name: 'Service Decomposition', status: 'not-started', owner: 'Backend' },
                        { name: 'Facade Pattern Implementation', status: 'not-started', owner: 'Backend' },
                        { name: 'Event-Driven Architecture', status: 'not-started', owner: 'Backend' },
                        { name: 'Message Queue Setup', status: 'not-started', owner: 'DevOps' }
                    ]
                },
                {
                    id: 'phase-3',
                    name: 'Phase 3: Features',
                    weeks: '9-12',
                    status: 'planned',
                    progress: 0,
                    critical: false,
                    tasks: [
                        { name: 'UI Tab Completion', status: 'not-started', owner: 'Frontend' },
                        { name: 'Web Lookup Integration', status: 'not-started', owner: 'Backend' },
                        { name: 'Content Enrichment', status: 'not-started', owner: 'Backend' },
                        { name: 'Export Functionality', status: 'not-started', owner: 'Backend' }
                    ]
                },
                {
                    id: 'phase-4',
                    name: 'Phase 4: Scale',
                    weeks: '13-16',
                    status: 'planned',
                    progress: 0,
                    critical: false,
                    tasks: [
                        { name: 'Redis Implementation', status: 'not-started', owner: 'DevOps' },
                        { name: 'PostgreSQL Migration', status: 'not-started', owner: 'DevOps' },
                        { name: 'Monitoring & Observability', status: 'not-started', owner: 'DevOps' },
                        { name: 'Production Deployment', status: 'not-started', owner: 'DevOps' }
                    ]
                }
            ],
            dependencies: [
                { from: 'Authentication System', to: 'Service Decomposition', type: 'blocks' },
                { from: 'Service Decomposition', to: 'UI Tab Completion', type: 'enables' },
                { from: 'Event-Driven Architecture', to: 'Web Lookup Integration', type: 'enables' },
                { from: 'Message Queue Setup', to: 'Content Enrichment', type: 'enables' },
                { from: 'PostgreSQL Migration', to: 'Production Deployment', type: 'blocks' }
            ]
        };

        // Initialize TO-BE roadmap dashboard
        function initializeRoadmapDashboard() {
            renderTimeline();
            renderDependencyGraph();
            setupRoadmapEventListeners();
            animateResourceBars();
            animateSuccessMetrics();
        }

        // Render implementation timeline
        function renderTimeline() {
            const container = document.getElementById('timelinePhases');
            if (!container) return;

            container.innerHTML = '';

            roadmapData.phases.forEach((phase, index) => {
                const phaseElement = createPhaseElement(phase);

                // Initial animation state
                phaseElement.style.opacity = '0';
                phaseElement.style.transform = 'translateY(20px)';

                container.appendChild(phaseElement);

                // Animate in
                setTimeout(() => {
                    phaseElement.style.transition = 'all 0.6s ease-out';
                    phaseElement.style.opacity = '1';
                    phaseElement.style.transform = 'translateY(0)';
                }, index * 150);
            });
        }

        // Create phase element
        function createPhaseElement(phase) {
            const div = document.createElement('div');
            div.className = `timeline-phase ${phase.status}`;
            if (phase.critical) div.classList.add('critical');

            div.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h5>${phase.name} <span style="font-size: 12px; opacity: 0.7;">${phase.critical ? 'üî¥ Critical' : ''}</span></h5>
                        <small>Weeks ${phase.weeks} ‚Ä¢ ${phase.progress}% Complete</small>
                    </div>
                    <div style="text-align: right; display: flex; align-items: center; gap: 10px;">
                        <div style="width: 100px; background: rgba(255,255,255,0.1); height: 8px; border-radius: 4px; overflow: hidden;">
                            <div class="phase-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(to right, #4caf50, #81c784); transition: width 1.5s ease-out;"></div>
                        </div>
                        <span class="expand-arrow" style="font-size: 14px; transition: transform 0.3s ease;">‚ñº</span>
                    </div>
                </div>
                <div class="phase-tasks" style="margin-top: 15px; display: none; opacity: 0; transition: all 0.3s ease; max-height: 0; overflow: hidden;">
                    ${phase.tasks.map(task => `
                        <div class="task-item" style="display: flex; justify-content: space-between; margin: 8px 0; font-size: 12px; opacity: 0.8; padding: 8px; background: rgba(255,255,255,0.05); border-radius: 4px; transition: all 0.2s ease;">
                            <span>${getStatusIcon(task.status)} ${task.name}</span>
                            <span style="color: rgba(255,255,255,0.7);">${task.owner}</span>
                        </div>
                    `).join('')}
                </div>
            `;

            // Enhanced click functionality with animation
            div.addEventListener('click', (e) => {
                e.preventDefault();
                const tasksDiv = div.querySelector('.phase-tasks');
                const arrow = div.querySelector('.expand-arrow');
                const progressBar = div.querySelector('.phase-progress-bar');

                if (tasksDiv.style.display === 'none' || !tasksDiv.style.display) {
                    // Expand
                    tasksDiv.style.display = 'block';
                    tasksDiv.style.maxHeight = '200px';
                    setTimeout(() => {
                        tasksDiv.style.opacity = '1';
                    }, 10);
                    arrow.style.transform = 'rotate(180deg)';

                    // Animate progress bar
                    setTimeout(() => {
                        progressBar.style.width = `${phase.progress}%`;
                    }, 200);
                } else {
                    // Collapse
                    tasksDiv.style.opacity = '0';
                    tasksDiv.style.maxHeight = '0';
                    setTimeout(() => {
                        tasksDiv.style.display = 'none';
                    }, 300);
                    arrow.style.transform = 'rotate(0deg)';
                }
            });

            // Add hover effect for task items
            setTimeout(() => {
                const taskItems = div.querySelectorAll('.task-item');
                taskItems.forEach(item => {
                    item.addEventListener('mouseenter', () => {
                        item.style.background = 'rgba(255,255,255,0.1)';
                        item.style.transform = 'translateX(5px)';
                    });
                    item.addEventListener('mouseleave', () => {
                        item.style.background = 'rgba(255,255,255,0.05)';
                        item.style.transform = 'translateX(0)';
                    });
                });
            }, 100);

            return div;
        }

        // Get status icon
        function getStatusIcon(status) {
            switch(status) {
                case 'complete': return '‚úÖ';
                case 'in-progress': return 'üîÑ';
                case 'not-started': return 'üìÖ';
                default: return '‚ùì';
            }
        }

        // Render dependency graph
        function renderDependencyGraph() {
            const svg = document.getElementById('dependencyGraph');
            if (!svg) return;

            svg.innerHTML = `
                <defs>
                    <marker id="arrowhead-dep" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#ff9800" />
                    </marker>
                </defs>
            `;

            // Draw critical path visualization
            const tasks = [
                { name: 'Auth System', x: 100, y: 100, status: 'in-progress' },
                { name: 'Service Decomp', x: 300, y: 100, status: 'planned' },
                { name: 'UI Completion', x: 500, y: 100, status: 'planned' },
                { name: 'Production', x: 700, y: 100, status: 'planned' }
            ];

            // Draw task nodes
            tasks.forEach(task => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', task.x);
                circle.setAttribute('cy', task.y);
                circle.setAttribute('r', 30);
                circle.setAttribute('fill', task.status === 'in-progress' ? '#ff9800' : task.status === 'complete' ? '#4caf50' : '#999');
                circle.setAttribute('opacity', '0.8');
                svg.appendChild(circle);

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', task.x);
                text.setAttribute('y', task.y - 45);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', '12');
                text.textContent = task.name;
                svg.appendChild(text);
            });

            // Draw dependency arrows
            for (let i = 0; i < tasks.length - 1; i++) {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', tasks[i].x + 30);
                line.setAttribute('y1', tasks[i].y);
                line.setAttribute('x2', tasks[i + 1].x - 30);
                line.setAttribute('y2', tasks[i + 1].y);
                line.setAttribute('stroke', '#ff9800');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('marker-end', 'url(#arrowhead-dep)');
                svg.appendChild(line);
            }
        }

        // Setup roadmap event listeners
        function setupRoadmapEventListeners() {
            // Timeline phase filters
            document.querySelectorAll('.timeline-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.timeline-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterTimelinePhases(e.target.dataset.phase);
                });
            });

            // Dependency view controls
            document.querySelectorAll('.dep-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.dep-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    updateDependencyView(e.target.dataset.view);
                });
            });
        }

        // Filter timeline phases
        function filterTimelinePhases(phaseFilter) {
            const container = document.getElementById('timelinePhases');
            if (!container) return;

            container.innerHTML = ''; // Clear existing phases

            let filteredPhases;
            if (phaseFilter === 'all') {
                filteredPhases = roadmapData.phases;
            } else {
                const phaseNum = parseInt(phaseFilter);
                filteredPhases = roadmapData.phases.filter(phase => {
                    return phase.id === `phase-${phaseNum}`;
                });
            }

            // Re-render filtered phases
            filteredPhases.forEach(phase => {
                const phaseElement = createPhaseElement(phase);
                container.appendChild(phaseElement);
            });

            // Animate the new phases
            setTimeout(() => {
                const newPhases = container.querySelectorAll('.timeline-phase');
                newPhases.forEach((phase, index) => {
                    phase.style.opacity = '0';
                    phase.style.transform = 'translateX(-20px)';
                    setTimeout(() => {
                        phase.style.transition = 'all 0.5s ease-out';
                        phase.style.opacity = '1';
                        phase.style.transform = 'translateX(0)';
                    }, index * 100);
                });
            }, 10);
        }

        // Update dependency view
        function updateDependencyView(view) {
            const svg = document.getElementById('dependencyGraph');
            if (!svg) return;

            svg.innerHTML = `
                <defs>
                    <marker id="arrowhead-dep" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#ff9800" />
                    </marker>
                    <marker id="arrowhead-critical" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#f44336" />
                    </marker>
                    <marker id="arrowhead-epic" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50" />
                    </marker>
                </defs>
            `;

            let tasks, connections;

            switch(view) {
                case 'critical':
                    tasks = [
                        { name: 'Auth System', x: 150, y: 150, status: 'in-progress', critical: true },
                        { name: 'Service Decomp', x: 400, y: 150, status: 'planned', critical: true },
                        { name: 'UI Completion', x: 650, y: 150, status: 'planned', critical: true },
                        { name: 'Production', x: 850, y: 150, status: 'planned', critical: true }
                    ];
                    connections = [
                        { from: 0, to: 1, type: 'critical' },
                        { from: 1, to: 2, type: 'critical' },
                        { from: 2, to: 3, type: 'critical' }
                    ];
                    break;

                case 'all':
                    tasks = [
                        { name: 'Auth System', x: 100, y: 100, status: 'in-progress' },
                        { name: 'API Structure', x: 250, y: 100, status: 'complete' },
                        { name: 'Service Decomp', x: 400, y: 100, status: 'planned' },
                        { name: 'Message Queue', x: 100, y: 200, status: 'planned' },
                        { name: 'UI Completion', x: 250, y: 200, status: 'planned' },
                        { name: 'Web Lookup', x: 400, y: 200, status: 'planned' },
                        { name: 'Redis Cache', x: 100, y: 300, status: 'planned' },
                        { name: 'PostgreSQL', x: 250, y: 300, status: 'planned' },
                        { name: 'Production', x: 400, y: 300, status: 'planned' }
                    ];
                    connections = [
                        { from: 0, to: 2, type: 'normal' },
                        { from: 1, to: 2, type: 'normal' },
                        { from: 2, to: 4, type: 'normal' },
                        { from: 3, to: 5, type: 'normal' },
                        { from: 6, to: 8, type: 'normal' },
                        { from: 7, to: 8, type: 'normal' }
                    ];
                    break;

                case 'epic':
                    tasks = [
                        { name: 'Security Epic', x: 200, y: 100, status: 'in-progress', epic: 'security' },
                        { name: 'UI Epic', x: 500, y: 100, status: 'planned', epic: 'ui' },
                        { name: 'Performance Epic', x: 800, y: 100, status: 'planned', epic: 'performance' },
                        { name: 'Integration Epic', x: 200, y: 250, status: 'planned', epic: 'integration' },
                        { name: 'Infrastructure Epic', x: 500, y: 250, status: 'planned', epic: 'infrastructure' }
                    ];
                    connections = [
                        { from: 0, to: 1, type: 'epic' },
                        { from: 1, to: 2, type: 'epic' },
                        { from: 0, to: 3, type: 'epic' },
                        { from: 3, to: 4, type: 'epic' }
                    ];
                    break;
            }

            // Draw task nodes with animations
            tasks.forEach((task, index) => {
                setTimeout(() => {
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', task.x);
                    circle.setAttribute('cy', task.y);
                    circle.setAttribute('r', task.epic ? 40 : 30);

                    let fillColor;
                    if (task.critical) fillColor = '#f44336';
                    else if (task.status === 'in-progress') fillColor = '#ff9800';
                    else if (task.status === 'complete') fillColor = '#4caf50';
                    else if (task.epic) {
                        const epicColors = {
                            'security': '#e91e63',
                            'ui': '#3f51b5',
                            'performance': '#ff5722',
                            'integration': '#795548',
                            'infrastructure': '#607d8b'
                        };
                        fillColor = epicColors[task.epic] || '#999';
                    } else fillColor = '#999';

                    circle.setAttribute('fill', fillColor);
                    circle.setAttribute('opacity', '0');
                    circle.setAttribute('stroke', 'white');
                    circle.setAttribute('stroke-width', '2');
                    circle.style.transition = 'all 0.5s ease-out';
                    svg.appendChild(circle);

                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', task.x);
                    text.setAttribute('y', task.y - (task.epic ? 50 : 40));
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', 'white');
                    text.setAttribute('font-size', task.epic ? '10' : '12');
                    text.setAttribute('opacity', '0');
                    text.textContent = task.name;
                    text.style.transition = 'opacity 0.5s ease-out';
                    svg.appendChild(text);

                    // Animate in
                    setTimeout(() => {
                        circle.setAttribute('opacity', '0.8');
                        text.setAttribute('opacity', '1');
                    }, 100);
                }, index * 150);
            });

            // Draw connections with animations
            setTimeout(() => {
                connections.forEach((conn, index) => {
                    setTimeout(() => {
                        const fromTask = tasks[conn.from];
                        const toTask = tasks[conn.to];

                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', fromTask.x + (fromTask.epic ? 40 : 30));
                        line.setAttribute('y1', fromTask.y);
                        line.setAttribute('x2', toTask.x - (toTask.epic ? 40 : 30));
                        line.setAttribute('y2', toTask.y);

                        const strokeColor = conn.type === 'critical' ? '#f44336' :
                                          conn.type === 'epic' ? '#4caf50' : '#ff9800';
                        line.setAttribute('stroke', strokeColor);
                        line.setAttribute('stroke-width', conn.type === 'critical' ? '3' : '2');
                        line.setAttribute('marker-end', `url(#arrowhead-${conn.type === 'normal' ? 'dep' : conn.type})`);
                        line.setAttribute('opacity', '0');
                        line.style.transition = 'opacity 0.5s ease-out';

                        if (conn.type === 'critical') {
                            line.setAttribute('stroke-dasharray', '5,5');
                        }

                        svg.appendChild(line);

                        setTimeout(() => {
                            line.setAttribute('opacity', '0.7');
                        }, 100);
                    }, index * 200);
                });
            }, tasks.length * 150 + 300);
        }

        // Animate resource bars
        function animateResourceBars() {
            const resourceBars = document.querySelectorAll('.resource-fill');
            resourceBars.forEach((bar, index) => {
                // Reset width first
                const originalWidth = bar.style.width;
                bar.style.width = '0%';

                setTimeout(() => {
                    bar.style.transition = 'width 1.5s ease-out';
                    bar.style.width = originalWidth;
                }, index * 200);
            });
        }

        // Animate success metrics
        function animateSuccessMetrics() {
            const metricBars = document.querySelectorAll('.progress-bar.target');
            metricBars.forEach((bar, index) => {
                // Reset width first
                const originalWidth = bar.style.width;
                bar.style.width = '0%';

                setTimeout(() => {
                    bar.style.transition = 'width 2s ease-out';
                    bar.style.width = originalWidth;
                }, index * 300);
            });
        }

        // Initialize TO-BE dashboard when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                // Check if TO-BE tab is active
                const toBETab = document.getElementById('to-be');
                if (toBETab && toBETab.classList.contains('active')) {
                    initializeRoadmapDashboard();
                }
            });
        }
    </script>
</body>
</html>
