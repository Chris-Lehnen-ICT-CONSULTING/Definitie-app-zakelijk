# US-067: ServiceFactory Stateless Maken

## User Story
**Als** architect
**Wil ik** dat ServiceFactory geen UI state leest in de service laag
**Zodat** services volledig stateless zijn volgens EPIC-010 principes

## Context
`src/services/service_factory.py` bevat problematische patterns:
- Leest `st.session_state` in service laag (architectuur schending)
- `USE_NEW_SERVICES` toggle voor V1/V2 switching (niet meer nodig)
- `LegacyGenerationResult` wrapper voor backwards compatibility

Dit schendt het stateless principe van EPIC-010 en voegt onnodige complexiteit toe.

## Acceptatiecriteria
- [ ] Geen `st.session_state` imports/gebruik in services/
- [ ] `USE_NEW_SERVICES` toggle verwijderd (altijd V2)
- [ ] `LegacyGenerationResult` geminimaliseerd of verwijderd
- [ ] Alle configuratie via constructor injection
- [ ] Services blijven testbaar zonder Streamlit runtime

## Technische Details

### Problematische Code
```python
# service_factory.py - HUIDIGE SITUATIE
import streamlit as st  # ❌ UI dependency in service

def get_definition_service():
    if USE_NEW_SERVICES or st.session_state.get('use_v2'):  # ❌ State check
        return ServiceAdapter()
    else:
        return LegacyService()  # ❌ V1 fallback
```

### Target Situatie
```python
# service_factory.py - GEWENST
def get_definition_service(config: ServiceConfig = None):
    """Always returns V2 service adapter."""
    if config is None:
        config = ServiceConfig()  # Default config
    return ServiceAdapter(config)  # Altijd V2
```

### Refactoring Stappen
1. Verwijder alle `streamlit` imports uit services/
2. Verwijder `USE_NEW_SERVICES` constante en checks
3. Simplificeer `get_definition_service()` naar V2-only
4. Minimaliseer `LegacyGenerationResult` wrapper
5. Verplaats configuratie naar constructor parameters

## Dependencies
- Geen directe dependencies
- Coördineren met US-070 (category state manager)

## Business Logica te Behouden
- ServiceAdapter contract naar UI moet intact blijven
- to_ui_response() mapping moet blijven werken

## Risico's
- UI code verwacht mogelijk legacy result format
- Tests kunnen afhankelijk zijn van toggle gedrag

## Verificatie
1. Unit tests draaien zonder Streamlit
2. Services zijn volledig stateless
3. Configuratie alleen via DI
4. UI functionaliteit ongewijzigd

## Story Points: 3

## Priority: HIGH

## Sprint: TBD
