---
id: US-015
epic: EPIC-030
titel: "US-015: Wikipedia API Integratie - NL encyclopedische content voor definitieverrijking met intro/juridische secties"
type: feature
status: Nog te bepalen
prioriteit: HOOG
story_points: 5
sprint: backlog
owner: developer-implementer
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-11
vereisten:
  - REQ-021
---

# US-015: Wikipedia API Integratie

## Gebruikersverhaal
**Als** legal researcher  
**wil ik** Wikipedia content integreren  
**zodat** definities encyclopedische context bevatten

## Acceptatiecriteria
- [ ] NL taalvoorkeur bij queries; fallback EN
- [ ] Extractie van introductie en (indien aanwezig) juridische secties
- [ ] Relevantie‑filtering (min_score configurable)
- [ ] Provenance vastleggen (titel, URL, timestamp)
- [ ] Timeouts (≤ 5s) en caching (TTL configurable)

## Refinement (2025-10-14)

### Doelen
- Lever een lichte Wikipedia-lookup die één korte contextparagraaf teruggeeft voor de prompt.
- Houd alle logica binnen bestaande web-lookup services; geen extra dependency buiten `wikipedia`/`requests`.
- Toon broninformatie in metadata zodat gebruiker controle houdt over gebruikte context.

### Buiten scope
- Geen bulk import/export van Wikipedia data.
- Geen persistente opslag; resultaten blijven transient in sessie.
- Geen complexe samenvattings-LLM; enkel eenvoudige tekstextractie en sanitization.

### Definition of Ready
- [ ] API-policy gecontroleerd (rate limit 200 requests/dag, user-agent tekst voorbereid).
- [ ] Lijst van 10 voorbeeldbegrippen waarvoor content gewenst is.
- [ ] Besluit: caching gebeurt in-memory (Streamlit session) met 15 min TTL.
- [ ] Skeleton voor provenance rendering in UI beschikbaar.

### Werkpakketten
- [ ] Adapter bouwen (`src/services/web_lookup/wikipedia_adapter.py`) met functies `search(term)` en `get_summary(page_id)`.
- [ ] Extractor schrijven die introductie paragraaf + juridische secties identificeert (regex op koppen `== Recht ==` etc.).
- [ ] Relevantie-filter (`min_score`) configurabel maken via `config/web_lookup.yaml`.
- [ ] Provenance-object uitbreiden met `source_type="wikipedia"`, `page_title`, `url`, `retrieved_at`.
- [ ] Caching via kleine LRU in session state; fallback op live call bij cache miss.
- [ ] Unit tests (mock requests) + integratietest met stubbed responses.
- [ ] Veiligheidscheck: sanitiseer HTML (gebruik `bleach.clean` of eigen whitelist).

### Niet‑functionele acceptatiecriteria (Veilige Scraping)
- Robots.txt/TOS respecteren; timeout ≤ 5s; rate limiting + backoff  
- Markup sanitization; geen PII; AVG/BIR‑conform  
- Eenduidige User‑Agent; volledige provenance; beknopte audit logging

## Definition of Done
- [ ] Unit tests dekken happy path, timeout, geen resultaten.
- [ ] Integratietest bevestigt dat context in prompt metadata verschijnt.
- [ ] UI toont broninfo klikbaar; geen broken links.
- [ ] Log bevat request-id + response status zonder PII.
- [ ] Documentatie update (`docs/implementation/wiki-lookup.md`) met gebruiksinstructie.

## Afhankelijkheden
- REQ‑039, REQ‑021; NFR‑handhaving via US‑087/US‑088
