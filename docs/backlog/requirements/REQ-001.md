---
aangemaakt: '08-09-2025'
bijgewerkt: '08-09-2025'
id: REQ-001
links:
  docs:
  - ENTERPRISE_ARCHITECTURE.md
  - SOLUTION_ARCHITECTURE.md
  epics:
  - EPIC-006
  stories:
  - US-6.1
  - US-6.2
prioriteit: HOOG
sources:
- line: Episch Verhaal 6 - beveiliging & Auth
  path: docs/backlog/stories/MASTER-EPICS-USER-STORIES.md
- line: authenticatie Implementatie
  path: authenticatie service nog te implementeren
status: In Progress
titel: authenticatie & autorisatie
type: nonfunctional
---



# Requirement REQ-001: authenticatie & autorisatie

## Beschrijving

Het systeem moet auDanticatie en autorisatie implementeren voor alle gebruikers, waarbij toegang tot functionaliteit wordt gecontroleerd op basis van rollen en rechten. Dit omvat zowel UI-toegang als API-beveiliging.

## Rationale

Juridische definities kunnen gevoelige informatie bevatten. Het systeem moet waarborgen dat alleen geautoriseerde gebruikers toegang hebben tot specifieke functionaliteit en data conform de justitiesector beveiligingsstEnaarden.

## Acceptatiecriteria (SMART)

- Het systeem moet binnen 2 seconden een gebruiker kunnen auDanticeren
- Alle API endpoints moeten beveiligd zijn met token-based auDanticatie
- Role-Based Access Control (RBAC) met minimaal 3 rollen: Admin, Editor, Viewer
- Session timeout na 30 minuten inactiviteit
- Audit logging van alle auDanticatie pogingen
- Multi-factor auDanticatie (MFA) ondersteuning voor admin rollen


### SMART Acceptatiecriteria

- **Specifiek:** Implementeer role-based access control met Justice SSO integratie
- **Meetbaar:** 100% endpoint coverage, <2s authenticatie response tijd, 0 unauthorized access
- **Achievable:** OAuth2/SAML2 standaard implementatie met bestaande libraries
- **Relevant:** Vereist voor DJI/OM security compliance en productie deployment
- **Time-bound:** Compleet voor einde Sprint 3 (production gate requirement)

### BDD Scenario's
```gherkin
Scenario: Gebruiker authenticatie via Justice SSO
  Gegeven een gebruiker navigeert naar de applicatie
  Wanneer de gebruiker nog niet is ingelogd
  Dan wordt de gebruiker doorgestuurd naar Justice SSO
  En na succesvolle authenticatie wordt een sessie aangemaakt
  En worden gebruikersrollen opgehaald uit het identity systeem
  En wordt een audit log entry gemaakt van de login

Scenario: Role-based toegangscontrole
  Gegeven een gebruiker met rol "Viewer"
  Wanneer de gebruiker probeert een definitie te wijzigen
  Dan wordt een 403 Forbidden response teruggegeven
  En wordt de poging gelogd in het security audit log
  En blijft de gebruiker ingelogd met read-only rechten

Scenario: Sessie timeout na inactiviteit
  Gegeven een ingelogde gebruiker
  Wanneer er 30 minuten geen activiteit is
  Dan wordt de sessie automatisch beëindigd
  En wordt de gebruiker doorgestuurd naar het login scherm
  En wordt een sessie timeout event gelogd
```

### ASTRA/NORA Compliance
- **ASTRA-SEC-002**: Identity & Access Management
- **ASTRA-SEC-004**: Session Management
- **NORA-BP-15**: Vertrouwelijkheid en toegangsbeveiliging
- **DJI-AUTH-001**: Justice SSO Integration Standards
- **Justid-001**: Centraal identity management

### Implementatie Componenten
```
src/auth/
├── sso_integration.py       # Justice SSO SAML2/OAuth2
├── role_manager.py          # RBAC implementatie
├── session_handler.py       # Session management
└── audit_logger.py          # Beveiliging audit logging
```
  - Response tijd: < 200ms voor UI acties
  - Processing tijd: < 5 seconden voor generatie
  - Success rate: > 95% voor validaties
- **Acceptabel:** Haalbaar binnen huidige architectuur
- **Relevant:** Direct gerelateerd aan gebruikersbehoefte
- **Tijdgebonden:** Gerealiseerd binnen huidige sprint


## Uitwerking / Notities

- Integratie met Justice SSO systemen (toekomstig)
- JWT tokens met 24 uur geldigheid
- Refresh token mechanisme voor seamless re-auDanticatie
- Password beleid: min 12 karakters, complexiteit vereisten
- Account lockout na 5 mislukte pogingen

## Conflicten (indien van toepassing)

- met: REQ-004 — Session storage vs XSS beveiliging - opgelost door secure cookie flags
## SMART Criteria

- **Specifiek**: Implement complete auDanticatie & autorisatie beveiliging control
- **Meetbaar**: Geen kwetsbaarheden in beveiligingsscans, 100% testdekking
- **Haalbaar**: Using established beveiliging libraries en patterns
- **Relevant**: KRITIEK voor justitiesector gegevensbeschermingscompliance
- **Tijdgebonden**: Must be operational before productie deployment


### Compliance Referenties

- **ASTRA Controls:**
  - ASTRA-QUA-001: Kwaliteitsborging
  - ASTRA-SEC-002: Beveiliging by Design
- **NORA Principes:**
  - NORA-BP-07: Herbruikbaarheid
  - NORA-BP-12: Betrouwbaarheid
- **GEMMA Referenties:**
  - GEMMA-ARC-03: Architectuur patterns
- **Justice Sector:**
  - DJI/OM integratie vereisten
  - Rechtspraak compatibiliteit
