---
id: REQ-003
titel: Input validatie beveiliging
type: nonfunctional
status: GEREED
prioriteit: HOOG
aangemaakt: 08-09-2025
bijgewerkt: 08-09-2025
owner: architecture
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-29
epics: 
stories: 
links: 
sources: 
docs: 
- line: 45 validatieregels
path: src/toetsregels/regels/
---



# Requirement REQ-003: Input validatie beveiliging

## Beschrijving

Alle gebruikersinvoer moet strikt gevalideerd worden voordat deze wordt verwerkt. Dit omvat definitieteksten, zoektermen, en configuratie parameters. Validatie moet plaatsvinden op zowel client- als server-side.

## Rationale

Ongevalideerde input is de belangrijkste oorzaak van beveiliging vulnerabilities zoals injection attacks, XSS, en buffer overflags. Strikte validatie voorkomt deze aanvallen.

## Acceptatiecriteria (SMART)

- Alle 45 toetsregels moeten actief zijn voor definitie validatie
- Input lengte beperking: max 10.000 karakters per definitie
- Whitelist benadering voor toegestane karakters (NederlEnse letters, cijfers, leestekens)
- Sanitization van HTML/JavaScript in alle text velden
- SQL parameterized queries voor alle database interacties
- Validatie response binnen 1 seconde


### SMART Acceptatiecriteria

- **Specifiek:** Valideer alle gebruikersinput tegen 45 toetsregels met sanitization
- **Meetbaar:**
  - 100% van input gevalideerd (0 unvalidated paths)
  - < 100ms validatie response tijd
  - 45/45 toetsregels actief en werkend
  - Max 10.000 karakters per definitie (hard limit)
  - 0 XSS/SQL injection vulnerabilities (OWASP scan)
  - > 99% legitieme input geaccepteerd
- **Acceptabel:** ModularValidationService met bestaande regel engine
- **Relevant:** Voorkomt security breaches en data corruptie
- **Tijdgebonden:** Volledig operationeel voor go-live (Sprint 2)


## BDD Test Scenario's

```gherkin
Scenario: Validatie van normale definitie input
  Gegeven een gebruiker voert definitie in: "Een vonnis is een uitspraak van de rechter"
  Wanneer de definitie wordt gevalideerd
  Dan slagen alle 45 toetsregels
  En wordt de definitie geaccepteerd binnen 100ms
  En wordt een validatie score > 0.95 gegeven

Scenario: Blokkeren van XSS aanval
  Gegeven een gebruiker voert in: "<script>alert('XSS')</script>vonnis"
  Wanneer de input wordt gevalideerd
  Dan wordt de script tag gesanitized
  En wordt de schone tekst "vonnis" verwerkt
  En wordt een security waarschuwing gelogd
  En krijgt de gebruiker een foutmelding

Scenario: SQL injection preventie
  Gegeven een definitie met SQL: "'; DROP TABLE definities; --"
  Wanneer deze naar de database wordt geschreven
  Dan wordt parameterized query gebruikt
  En wordt de string als data behandeld, niet als SQL
  En blijft de database intact
  En wordt de poging gelogd met IP adres

Scenario: Karakter limiet handhaving
  Gegeven een definitie van 15.000 karakters
  Wanneer de gebruiker probeert op te slaan
  Dan wordt de input afgekeurd bij 10.001 karakters
  En krijgt de gebruiker melding: "Definitie te lang (max 10.000)"
  En wordt de eerste 10.000 karakters behouden als draft

Scenario: Toetsregel validatie performance
  Gegeven 100 gelijktijdige validatie requests
  Wanneer alle 45 regels worden toegepast
  Dan is de gemiddelde response tijd < 100ms
  En is de 95e percentiel < 200ms
  En worden alle regels parallel uitgevoerd
```

## Uitwerking / Notities

- ModularValidationService implementeert alle validatie logica
- Toetsregels gedefinieerd in JSON + Python modules
- Client-side validatie in Streamlit UI als eerste verdedigingslinie
- Server-side validatie als authoritative check
- Logging van alle geweigerde input voor security monitoring
- OWASP Top 10 compliance checks
- Rate limiting: max 100 validaties per minuut per gebruiker

## Conflicten (indien van toepassing)

Geen conflicten geÃ¯dentificeerd
## SMART Criteria

- **Specifiek**: Implement complete input validatie beveiliging beveiliging control
- **Meetbaar**: Geen kwetsbaarheden in beveiligingsscans, 100% testdekking
- **Haalbaar**: Using established beveiliging libraries en patterns
- **Relevant**: KRITIEK voor justitiesector gegevensbeschermingscompliance
- **Tijdgebonden**: Must be operational before productie deployment


### Compliance Referenties

- **ASTRA Controls:**
  - ASTRA-QUA-001: Kwaliteitsborging
  - ASTRA-SEC-002: Beveiliging by Design
- **NORA Principes:**
  - NORA-BP-07: Herbruikbaarheid
  - NORA-BP-12: Betrouwbaarheid
- **GEMMA Referenties:**
  - GEMMA-ARC-03: Architectuur patterns
- **Justice Sector:**
  - DJI/OM integratie vereisten
  - Rechtspraak compatibiliteit
