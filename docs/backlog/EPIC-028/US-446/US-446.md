# US-446: Integration Testing Post-Removal

**Epic:** EPIC-028 - Feature Cleanup & UI Simplification
**Priority:** HIGH
**Effort:** 2 story points
**Status:** üîµ TODO

---

## üìñ User Story

**Als** developer
**Wil ik** comprehensive tests draaien na feature removal
**Zodat** ik zeker weet dat alle functionaliteit nog steeds werkt

---

## üéØ Acceptance Criteria

- [ ] Alle unit tests groen
- [ ] Alle integration tests groen
- [ ] Manual smoke tests uitgevoerd
- [ ] UI volledig functioneel
- [ ] Geen broken imports
- [ ] Geen console errors
- [ ] Feature set verified

---

## üîß Testing Tasks

### 1. Unit Tests
```bash
# Run all unit tests
pytest tests/unit/ -v --tb=short

# Check coverage
pytest tests/unit/ --cov=src --cov-report=term-missing
```

**Expected:**
- All tests pass
- No import errors
- Coverage stable or improved

### 2. Integration Tests
```bash
# Run all integration tests
pytest tests/integration/ -v --tb=short

# Focus on core flows
pytest tests/integration/test_definition_validation_flow.py -v
pytest tests/integration/test_context_flow*.py -v
```

**Expected:**
- All tests pass
- Definition generation works
- Validation works
- Context selection works

### 3. Smoke Tests
```bash
# Critical path tests
pytest tests/smoke/ -v

# Or create new smoke test suite
pytest tests/smoke/test_critical_paths.py -v
```

### 4. Manual UI Testing

**Test Checklist:**

#### Tab Navigation
- [ ] Generator tab loads
- [ ] Edit tab loads
- [ ] Expert Review tab loads
- [ ] Import/Export/Beheer tab loads
- [ ] Only 4 tabs visible (no Orchestration, Monitoring, Web Lookup)

#### Generator Tab
- [ ] Can enter begrip
- [ ] Can select organisatorische context
- [ ] Can select juridische context
- [ ] Can select wettelijke basis
- [ ] Can upload documents
- [ ] Document upload works
- [ ] Can generate definitie
- [ ] Generation includes web sources
- [ ] Validation results appear
- [ ] Voorbeelden appear
- [ ] Can change ontological category
- [ ] Regeneration works (via normal flow)

#### Edit Tab
- [ ] Can load definitie
- [ ] Can edit definitie
- [ ] Auto-save works
- [ ] Version history works
- [ ] Validation on edit works

#### Expert Review Tab
- [ ] Can view definities
- [ ] Can approve/reject
- [ ] Workflow transitions work

#### Import/Export Tab
- [ ] Can export to CSV
- [ ] Can export to JSON
- [ ] Can export to XML
- [ ] Can import from CSV
- [ ] Database stats visible

### 5. Console Error Check

**Run app and check:**
```bash
streamlit run src/main.py
```

**Monitor for:**
- [ ] No import errors in startup
- [ ] No errors when loading tabs
- [ ] No errors when generating definitie
- [ ] No errors in browser console (F12)

### 6. Code Quality Checks

**Linting:**
```bash
ruff check src/ config/
```

**Type checking (if enabled):**
```bash
mypy src/ --ignore-missing-imports
```

**Unused imports:**
```bash
# Check for orphaned imports
ruff check --select F401 src/
```

### 7. Database Integrity

**Verify:**
```bash
sqlite3 data/definities.db "PRAGMA integrity_check;"
sqlite3 data/definities.db "SELECT COUNT(*) FROM definities;"
```

**Expected:**
- Integrity check: ok
- Definition count: unchanged

### 8. Performance Baseline

**Measure:**
- App startup time
- Definition generation time
- Tab switch time

**Compare to baseline (should be faster or same)**

---

## üìã Post-Test Verification Checklist

### Code Health
- [ ] No broken imports detected
- [ ] No unused imports detected
- [ ] Linting passes
- [ ] All tests green

### Functionality
- [ ] All 4 core tabs work
- [ ] Definition generation works end-to-end
- [ ] Validation works
- [ ] Document upload works
- [ ] Hybrid context works
- [ ] Export works
- [ ] Import works

### User Experience
- [ ] UI is cleaner (only 4 tabs)
- [ ] No confusing removed features visible
- [ ] All workflows intuitive
- [ ] No regression in functionality

### Documentation
- [ ] EPIC-028 marked as DONE
- [ ] All US-441 through US-446 marked DONE
- [ ] Changelog updated
- [ ] README updated (if needed)

---

## üìä Success Metrics

**Before Cleanup:**
- 8 tabs
- ~2,030 LOC bloat
- Complex workflows

**After Cleanup:**
- 4 tabs ‚úÖ
- ~2,030 LOC removed ‚úÖ
- Simpler workflows ‚úÖ

**Quality Gates:**
- All tests pass ‚úÖ
- No functional regression ‚úÖ
- Performance stable/improved ‚úÖ

---

## üîó Dependencies

- **After:** US-441, US-442, US-443, US-444, US-445 (all removals complete)

---

## üìù Test Results Documentation

Create file: `docs/testing/EPIC-028-test-results.md`

```markdown
# EPIC-028 Test Results

**Date:** [DATE]
**Tester:** [NAME]

## Unit Tests
- Total: X tests
- Passed: X
- Failed: 0
- Coverage: X%

## Integration Tests
- Total: X tests
- Passed: X
- Failed: 0

## Smoke Tests
- Generator flow: ‚úÖ
- Edit flow: ‚úÖ
- Review flow: ‚úÖ
- Import/Export: ‚úÖ

## Manual UI Tests
[Complete checklist results]

## Performance
- Startup: X seconds (baseline: Y seconds)
- Generation: X seconds (baseline: Y seconds)
- Tab switch: X ms (baseline: Y ms)

## Issues Found
[None or list issues]

## Conclusion
‚úÖ All tests passed. Ready for production.
```

---

## üìù Notes

- This is the final story in EPIC-028
- Comprehensive testing ensures no regression
- Document all test results for audit trail
- If tests fail, fix before closing epic
