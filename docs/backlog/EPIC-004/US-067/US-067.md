---
id: US-067
epic: EPIC-004
titel: "US-067: titel: Implement Expert Review Draft and Revalidation Features"
type: feature
status: proposed
prioriteit: LOW
story_points: 3
sprint: backlog
aangemaakt: 2025-09-11
bijgewerkt: 2025-09-11
owner: ux-designer
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-11
vereisten:
  - REQ-086
toegewezen_aan: frontend-team
---

# US-067: Implement Expert Review Draft and Revalidation Features

**Epic:** EPIC-004 - User Interface

## Gebruikersverhaal

**Als een** juridisch expert die definities reviewt
**wil ik** mijn review kunnen opslaan als draft en definities kunnen hervalideren
**zodat** ik flexibel kan werken en altijd de laatste validatie resultaten zie

## Probleembeschrijving

TODO's in `ui/components/expert_review_tab.py`:
- Regel 577: Draft saving functionaliteit
- Regel 583: Re-validation functionaliteit

Deze features zijn placeholders maar nog niet geÃ¯mplementeerd.

## Acceptatiecriteria

### Draft Saving
- [ ] Review wordt automatisch opgeslagen tijdens typen
- [ ] Expliciete save draft knop beschikbaar
- [ ] Draft status zichtbaar in UI
- [ ] Drafts kunnen geladen worden
- [ ] Drafts hebben timestamp
- [ ] Per definitie kunnen meerdere drafts bestaan

### Re-validation
- [ ] Knop om definitie opnieuw te valideren
- [ ] Gebruikt laatste versie van validatieregels
- [ ] Toont diff tussen oude en nieuwe validatie
- [ ] Behoud history van validaties
- [ ] Progress indicator tijdens validatie

### Data Management
- [ ] Drafts opgeslagen in database
- [ ] Cleanup van oude drafts (>30 dagen)
- [ ] Export mogelijkheid voor drafts

## Implementatie Details

### Draft Storage
```python
class ReviewDraftService:
    def auto_save_draft(self, review_id: str, content: dict) -> bool
    def load_draft(self, review_id: str) -> Optional[ReviewDraft]
    def list_drafts(self, definition_id: int) -> List[ReviewDraft]
    def cleanup_old_drafts(self, days: int = 30) -> int
```

### Re-validation
```python
class RevalidationService:
    async def revalidate_definition(
        self,
        definition_id: int,
        compare_with_previous: bool = True
    ) -> RevalidationResult
```

## Definition of Done

- [ ] Draft saving werkend (auto + manual)
- [ ] Re-validation functionaliteit compleet
- [ ] Database schema voor drafts
- [ ] Unit tests voor services
- [ ] UI feedback voor gebruiker
- [ ] Performance test (auto-save mag UI niet blokkeren)
- [ ] Documentatie bijgewerkt

## Risico's

| Risico | Impact | Mitigatie |
|--------|--------|-----------|
| Data loss bij auto-save fail | High | Fallback naar localStorage |
| Performance bij veel drafts | Low | Pagination + cleanup |
| Validation regel changes | Medium | Version tracking |

## Notes

- Auto-save met debounce van 2 seconden
- localStorage als fallback voor network issues
- Consider draft merging voor collaborative review
