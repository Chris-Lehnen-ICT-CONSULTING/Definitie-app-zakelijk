---
id: US-236
epic: EPIC-004
titel: "US-236: titel: Gedeelde Validatieâ€‘weergave (V2) voor Generatie, Bewerk en Expert Review"
status: proposed
prioriteit: HOOG
story_points: 5
aangemaakt: 2025-09-22
bijgewerkt: 2025-09-22
owner: product
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-22
---

# US-236: Gedeelde Validatieâ€‘weergave (V2) voor Generatie, Bewerk en Expert Review

## Gebruikersverhaal
Als gebruiker wil ik in alle relevante tabbladen (Definitieâ€‘generatie, Bewerk, Expert Review) dezelfde, rijke validatieâ€‘weergave zien, zodat ik regels en uitleg overal eenduidig kan beoordelen en geen informatieverlies optreedt.

## Acceptatiecriteria
- [ ] EÃ©n gedeelde renderer toont V2â€‘validatie identiek aan het Generatieâ€‘tabblad, incl.:
  - Gateâ€‘status (Gates: OK/NIET OK + passed/failed gates)
  - Toggle â€œğŸ“Š Toon/verberg gedetailleerde toetsresultatenâ€
  - Gedetailleerde regels met kleur/icoon (âœ…/âš ï¸/âŒ), sorting en inline uitlegâ€‘expander per regel (â€œWat toetstâ€ + voorbeelden)
- [ ] Generatieâ€‘tab gebruikt de gedeelde renderer zonder zichtbaar verschil in output of functionaliteit.
- [ ] Bewerkâ€‘ en Expertâ€‘tab gebruiken dezelfde renderer, fullâ€‘width onder de acties (Edit: onder â€œKwaliteitstoetsingâ€, Expert: onder reviewâ€‘knoppen), zonder informatieverlies.
- [ ] Sessionâ€‘state keys zijn gescheiden per context (gen, edit_{id}, review_{id}) voor toggle/caching.
- [ ] Geen regressie in gateâ€‘status weergave of performantie.

## Implementatieplan (samenvatting)
- Extractie (zonder gedrag te wijzigen) van de bewezen Generatieâ€‘weergave naar `ui/components/validation_view.py`:
  - Helpers: `_rule_sort_key`, `_extract_rule_id_from_line`, `_build_rule_hint_markdown`.
  - Publieke functie: `render_validation_detailed_list(validation_result: dict, key_prefix: str, show_toggle: bool = True, gate: dict | None = None)`.
- Generator aansluiten met `key_prefix='gen'` en `show_toggle=True`, gate doorgeven.
- Edit aansluiten met `key_prefix='edit_{id}'`, `show_toggle=True`, gate=None.
- Expert aansluiten met `key_prefix='review_{id}'`, `show_toggle=True`, gate=None; reâ€‘validatie slaat V2â€‘resultaat in session en render fullâ€‘width.
- Verificatie: visuele 1:1 vergelijking Generatie vÃ³Ã³r/na; Edit/Expert weergave gelijk aan Generatie.

## Testscenarioâ€™s
1) Generatie â€” toggle on/off
   - Als ik de toggle activeer, zie ik exact dezelfde lijst als vÃ³Ã³r de refactor (zelfde regels, volgorde, iconen, uitleg).
2) Bewerk â€” lege context (CONâ€‘01) en uitleg
   - Bij validatie toont de weergave â€œWat toetstâ€ en â€œWaarom niet geslaagdâ€ per regel; link naar handleiding zichtbaar.
3) Expert â€” Reâ€‘validate fullâ€‘width
   - Na reâ€‘validatie verschijnt dezelfde lijst fullâ€‘width onder de knoppen; geen kolomâ€‘insnoering.
4) Gateâ€‘status (Generatie)
   - Gateâ€‘weergave blijft ongewijzigd (OK/Niet OK + gate details).

## Uitvoer/Deliverables
- Gedeeld component `ui/components/validation_view.py`
- Generator/ Edit/ Expert aangepast om de gedeelde renderer te gebruiken
- Korte handleidingupdate (UI consistentie)

## Risicoâ€™s & mitigaties
- Visuele regressie â†’ Gefaseerde aansluiting, 1:1 verificatie in Generatie vÃ³Ã³r/na.
- Stateâ€‘collisie â†’ `key_prefix` per context (gen/edit_{id}/review_{id}).
- Performantie â†’ Sessionâ€‘caching van gedetailleerde regels behouden.

## Definition of Done
- EÃ©n renderer, drie tabbladen consistent, geen informatieverlies, gateâ€‘status behouden, toggle werkt identiek, tests/visuele checks akkoord.

