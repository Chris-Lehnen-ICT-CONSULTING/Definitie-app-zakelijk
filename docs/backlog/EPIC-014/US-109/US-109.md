---
id: US-109
epic: EPIC-014
titel: Implementeer Definitie Acceptatie Criteria Engine
status: open
prioriteit: P2
story_points: 5
aangemaakt: 2025-09-30
bijgewerkt: 2025-09-30
owner: tbd
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-30
---

# US-109: Implementeer Definitie Acceptatie Criteria Engine

## User Story
**Als** systeem  
**Wil ik** een robuuste acceptatie engine met 3-staps validatie  
**Zodat** alleen kwalitatief goede definities worden goedgekeurd  

## Status
**Status**: TODO  
**Priority**: CRITICAL  
**Story Points**: 5  
**Epic**: [EPIC-014: Business Logic Refactoring](../EPIC-014.md)  

## Business Context
Deze engine bepaalt of een gegenereerde definitie acceptabel is voor productie gebruik. Het gebruikt een bewezen 3-staps validatie proces dat juridische compliance waarborgt.

## Acceptance Criteria
- [ ] Implementeer 3-staps acceptatie flow
- [ ] Stap 1: Critical violations check (moet 0 zijn)
- [ ] Stap 2: Overall score check (minimum 80%)
- [ ] Stap 3: Category compliance check (minimum 75%)
- [ ] Early exit bij failure (efficiency)
- [ ] Configureerbare thresholds (maar met PO approval voor wijziging)
- [ ] Detailed rejection reason in response

## Technical Details

### 3-Steps Acceptance Algorithm
```python
class AcceptanceCriteriaEngine:
    def __init__(self):
        self.thresholds = {
            "critical_violations": 0,      # GEEN kritieke fouten
            "overall_score": 0.8,          # 80% minimum
            "category_compliance": 0.75    # 75% voor categorie
        }
    
    def evaluate(self, validation_result) -> (bool, str):
        # Step 1: Critical violations (juridisch verplicht)
        critical_count = len([v for v in validation_result.violations 
                            if v.severity == CRITICAL])
        if critical_count > self.thresholds["critical_violations"]:
            return False, f"Rejected: {critical_count} critical violations found"
        
        # Step 2: Overall score
        if validation_result.overall_score < self.thresholds["overall_score"]:
            return False, f"Rejected: Score {validation_result.overall_score:.2%} < 80%"
        
        # Step 3: Category compliance
        if validation_result.category_compliance < self.thresholds["category_compliance"]:
            return False, f"Rejected: Category compliance {validation_result.category_compliance:.2%} < 75%"
        
        return True, "Accepted: All criteria met"
```

### Business Rules
- **Critical violations = 0**: Juridische vereiste, GEEN exceptions
- **Overall 80%**: Balans tussen kwaliteit en haalbaarheid
- **Category 75%**: Iets flexibeler voor cross-categorie begrippen

## Test Cases
1. Test met 1 critical violation → moet rejecten
2. Test met score 79% → moet rejecten
3. Test met category compliance 74% → moet rejecten
4. Test met alle criteria OK → moet accepteren
5. Test early exit (critical fail = geen verdere checks)
6. Test detailed rejection messages

## Configuration
```yaml
# WAARSCHUWING: Deze waarden zijn geoptimaliseerd over 3+ jaar
# NIET wijzigen zonder PO approval en A/B testing
acceptance_criteria:
  critical_violations_allowed: 0
  minimum_overall_score: 0.80
  minimum_category_compliance: 0.75
```

## Dependencies
- ValidationResult met scores en violations
- ViolationSeverity enum

## Risks
- Te strenge criteria → weinig definities accepted
- Te losse criteria → kwaliteit degradatie
- **Mitigation**: Shadow mode A/B testing bij threshold wijzigingen

## Notes
- Deze thresholds zijn gebaseerd op 3+ jaar productie data
- Category compliance is bewust lager dan overall (cross-categorie flexibiliteit)