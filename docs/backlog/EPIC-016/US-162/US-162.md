---
id: US-162
titel: Gate‑policy beheer (Approval Gate Policy)
epic: EPIC-016
status: Backlog
prioriteit: HOOG
story_points: 8
aangemaakt: 2025-09-13
bijgewerkt: 2025-09-13
owner: architecture
type: feature
applies_to: definitie-app@current
canonical: true
last_verified: 2025-09-13
vereisten:
- REQ-093
---

# US-162: Gate‑policy beheer (Approval Gate Policy)

## Doel
Beheer van validatie‑gatebeleid bij Vaststellen: mode (hard/soft), drempels, forbidden severities, vereiste velden en override‑regels.

## Variabelen (minimaal)
- mode: hard|soft
- min_overall_score: default 0.75
- forbid_critical: true|false (default true)
- forbid_high: true|false (default false)
- override_min_overall_score: default 0.65
- require_fields: lijst (default ['organisatorische_context','juridische_context'])
- notes_required: true|false (default true)

## Acceptatiecriteria
- [ ] UI‑sectie toont bovenstaande variabelen met beschrijving en huidige waarde
- [ ] Wijzigingen opslaan in DB (config‑tabel) met audit (wie/wat/wanneer/voorheen→nieuw)
- [ ] Hot‑reload of veilige herlaad (zonder app‑restart)
- [ ] Service (DefinitionWorkflowService) leest actuele policy (DI)
- [ ] Export/Import van policy als JSON/YAML

## Definition of Done
- [ ] CRUD UI voor gate‑policy
- [ ] Opslag in DB + auditlog per wijziging
- [ ] Integratie service‑laag (read‑through caching ok)
 - [ ] Documentatie (README/architectuur)

## Data‑model & Storage
- Tabel `config_settings` (id, key, value_json, version, updated_at, updated_by)
- Key voor gate policy: `approval_gate_policy`
- Versiebeheer via aparte `config_versions` of soft‑versie in dezelfde tabel.

## API/Service
- GatePolicyService met methods: get_policy(), update_policy(payload, user), export_policy(), import_policy(dry_run:bool)
- Caching met TTL; invalidatie bij update.

## UI‑Details
- Kaart met huidige waarden, knoppen “Bewerken”, “Opslaan”, “Annuleren”.
- Validatie: ranges (0..1 voor drempels), booleans, set‑leden.
- Confirmatie‑dialoog bij opslaan met samenvatting van wijzigingen.

## Audit
- Opslag van diff (voorheen→nieuw), user, timestamp.
- Weergave laatste N wijzigingen in Beheer‑tab.

## Beveiliging
- Voor nu: feature‑flag/rolcheck; later integreren met auth (US‑167).

## Risks/Mitigations
- Onjuiste configuratie kan poort te streng maken → preview + waarschuwingen; export/backup.
