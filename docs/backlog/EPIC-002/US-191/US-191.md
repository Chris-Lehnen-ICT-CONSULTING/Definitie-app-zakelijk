---
id: US-191
status: TE_DOEN
prioriteit: HOOG
owner: validation
canonical: true
sprint: next
story_points: 3
last_verified: 16-09-2025
---

# US-191 — ESS‑02 herontwerp: Presence & Consistency tegen toegekende ontologische categorie

Doel
- ESS‑02 valideert niet langer via heuristische tekstscans welke ontologische categorie van toepassing is, maar controleert of:
  1) er al een ontologische categorie is toegekend (presence), en
  2) de definitietekst niet in strijd is met die toegekende categorie (consistency, optioneel).

Achtergrond
- In de huidige flow wordt de ontologische categorie vóór promptbouw bepaald (OntologischeAnalyzer/regels). ESS‑02 hoeft die dus niet meer af te leiden uit de tekst, maar moet controleren dat de categorie is vastgelegd en dat de tekst niet conflicteert.

Scope
- V2‑validator (ValidationOrchestratorV2/ModularValidationService) krijgt een ESS‑02 regel die Definition.ontologische_categorie gebruikt voor presence/consistency.
- UI gebruikt uitsluitend V2‑validatie (geen aanroep legacy ai_toetser/modular_toetser in runtime).

Probleem
- ESS‑02 (legacy pad) doet regex‑detectie op tekst en leidt zelf de categorie af; dat botst met de nieuwe flow en kan tot ruis of ambiguïteit leiden.

Oplossing (functioneel)
- Presence: als `Definition.ontologische_categorie` ontbreekt → ESS‑02 error met duidelijke melding (categorie verplicht expliciet vastgelegd te zijn).
- Consistency (optioneel): als sterke tekst‑markers voor een andere categorie voorkomen → ESS‑02 mismatch (warning of error, beleid bepalen), met concrete hint.
- Geen extra AI‑calls; alleen veldcontrole en (optioneel) eenvoudige markercheck.

Technische uitwerking (voorstel)
1) V2 ESS‑02 regel toevoegen aan ModularValidationService of via een compacte rule‑adapter die op `Definition.ontologische_categorie` valideert.
2) (Optioneel) hergebruik de bestaande regex‑markers uit ESS‑02 als conflict‑detector (niet meer als primaire categoriebepaling).
3) Legacy ESS‑02 niet meer in de UI‑flow aanroepen; uitsluitend V2 gebruiken.

Acceptatiecriteria
- AC1: Definitie met `ontologische_categorie` → ESS‑02 slaagt (tenzij een duidelijke mismatch wordt gedetecteerd).
- AC2: Definitie zonder `ontologische_categorie` → ESS‑02 error met heldere melding.
- AC3: (Optioneel) Mismatch in tekst → ESS‑02 rapporteert conflict met categorie.
- AC4: Geen legacy ESS‑02 calls in de UI‑flow; alleen V2‑validatie actief.

Testplan
- Unit: presence (set/unset), consistency (simuleer conflict), neutral case (geen tekst‑markers).
- Integratie (UI): validatiepaneel toont V2‑ESS‑02 resultaten zonder legacy ruis.
