---
id: US-073
epic: EPIC-007
titel: Rollback mechanisme voor hernoemscript (analyse/hernoem-naar-nederlands.py)
type: tooling
status: proposed
prioriteit: MEDIUM
story_points: 3
sprint: backlog
aangemaakt: 2025-09-11
bijgewerkt: 2025-09-11
owner: developer
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-11
vereisten:
  - REQ-006
toegewezen_aan: tooling-team
---

# US-073: Rollback mechanisme voor hernoemscript

## Gebruikersverhaal
Als ontwikkelaar wil ik dat het hernoemscript alle contentwijzigingen automatisch kan terugdraaien bij testfalen zodat de repository niet in een inconsistente toestand achterblijft.

## Context en Herkomst
- TODO in code: `scripts/analyse/hernoem-naar-nederlands.py:310` – “Rollback alle content wijzigingen”.

## Acceptatiecriteria
- [ ] Script maakt vooraf een transactielog van alle gewijzigde bestanden (pad + originele inhoud hash).
- [ ] Bij falende tests/validatie worden alle gewijzigde bestanden hersteld naar de oorspronkelijke inhoud.
- [ ] Ook bestandsnaam-hernoemingen worden teruggedraaid (rename rollback).
- [ ] Droogloop modus (`--dry-run`) zonder wijzigingen, met diff-overzicht.
- [ ] Exit codes: 0 (succes), 1 (rollback uitgevoerd), 2 (onherstelbare fout).

## Technische Uitwerking
- Introduceer `ChangeSet` klasse met `apply()` en `rollback()`.
- Bewaar originele inhoud in tempdir met content hashes.
- Verifieer rollback met hashes en toon samenvatting.

## Tests
- Unit: wijzigingen toepassen en rollback, inclusief rename + content.
- Integratie: gesimuleerde testfailure triggert volledige rollback en schoon exit.

## Definition of Done
- [ ] Rollback geïmplementeerd en gedocumenteerd (`--help`).
- [ ] Tests groen.
- [ ] CI job gebruikt `--dry-run` voor preview.
