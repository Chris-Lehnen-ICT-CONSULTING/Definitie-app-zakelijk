---
id: US-038
epic: EPIC-007
titel: Prompt token‑budgetmeting + testgates (p95 ≤ 1.5k tokens)
status: Nog te bepalen
prioriteit: HOOG
story_points: 3
sprint: sprint-37
owner: performance-engineer
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-12
links:
  - docs/backlog/DEEP_DIVE_IMPROVEMENT_PLAN.md#prompting
---

# US-038: Prompt token‑budgetmeting + testgates (p95 ≤ 1.5k tokens)

## Gebruikersverhaal
Als performance engineer wil ik automatische meting en testgates op promptgrootte zodat kosten en latency onder controle blijven.

## Acceptatiecriteria (SMART)
- Specifiek: tiktoken‑meting per prompt; pytest die p95 ≤ 1.5k tokens afdwingt op representative fixtures.
- Meetbaar: CI faalt bij overschrijding; rapportage van distributie in testoutput.
- Tijdgebonden: sprint‑37.

## Testplan
- tests/prompts/test_prompt_token_budgets.py met meerdere scenario’s (met/zonder web‑lookup).

## Definition of Done
- Gate actief in CI; README performance sectie bijgewerkt met budgetten.

