---
id: US-325
epic: EPIC-003
titel: "US-325: titel: Basic Web Lookup Test Coverage"
status: open
prioriteit: P2
story_points: 5
aangemaakt: 2025-09-30
bijgewerkt: 2025-09-30
owner: tbd
applies_to: definitie-app@current
canonical: false
last_verified: 2025-09-30
---

# US-325: Basic Web Lookup Test Coverage

## User Story
**Als** ontwikkelaar van de DefinitieAgent applicatie
**Wil ik** adequate test coverage voor web lookup functionaliteit
**Zodat** regressies voorkomen worden en kwaliteit geborgd is

## Context
Huidige test problemen:
- ModernWebLookupService: 0% coverage
- Wikipedia Service: 59% coverage (target: 80%)
- UI Components: 0% coverage
- Totaal: 65% (target: 80%)
- Missing test categories: performance, load tests

## Acceptatiecriteria
- [ ] ModernWebLookupService heeft >80% coverage
- [ ] Alle providers hebben >80% coverage
- [ ] Integration tests voor complete flow
- [ ] Basic performance tests (<2s requirement)
- [ ] Mock fixtures voor alle externe calls
- [ ] Error scenarios getest

## Technische Details

### Test Structure (Single-User Focus)
```python
# tests/unit/web_lookup/test_modern_service.py
class TestModernWebLookupService:
    """Unit tests voor web lookup service"""

    @pytest.fixture
    def mock_providers(self):
        """Mock providers voor testing"""
        return [
            MockWikipediaProvider(),
            MockSRUProvider()
        ]

    async def test_parallel_lookup(self, mock_providers):
        """Test dat providers parallel draaien"""
        service = ModernWebLookupService(providers=mock_providers)
        results = await service.lookup("test term")
        assert len(results) > 0
        assert all(r.provider_key for r in results)

    async def test_timeout_enforcement(self):
        """Test timeout budget"""
        # Test dat slow providers niet alles blokkeren

    async def test_error_handling(self):
        """Test provider failures"""
        # Een provider faalt, anderen gaan door
```

### Performance Test
```python
@pytest.mark.performance
async def test_response_time():
    """Verify <2s response tijd"""
    service = ModernWebLookupService()
    start = time.time()
    await service.lookup("rechtspraak")
    duration = time.time() - start
    assert duration < 2.0, f"Too slow: {duration}s"
```

## Geschatte Effort
**2 dagen**

## Dependencies
- US-323 (test interface fix eerst)
- US-321, US-324, US-218 (implementaties om te testen)

## Testing Strategy
1. Unit tests per provider
2. Integration tests voor complete flow
3. Performance benchmarks
4. Error scenario's
5. Mock all external calls

## Notes
- Focus op praktische coverage voor single-user
- Geen load testing nodig
- Simpliciteit boven volledigheid

## Definition of Done
- [ ] >80% test coverage bereikt
- [ ] Alle tests draaien groen
- [ ] Performance tests validate <2s
- [ ] Integration tests compleet
- [ ] Mock fixtures beschikbaar
- [ ] CI/CD pipeline draait tests

## Linked Items
- Epic: [[EPIC-003]] - Content Verrijking / Web Lookup
- Depends on: US-323
- Tests: US-321, US-322, US-324, US-218