---
id: US-221
epic: EPIC-003
titel: "US-221: titel: Verwijder enable_validation Feature Flag"
type: technical-debt
status: open
prioriteit: HOOG
story_points: 3
sprint: backlog
aangemaakt: 19-09-2025
bijgewerkt: 19-09-2025
owner: development-team
applies_to: definitie-app@current
canonical: false
last_verified: 19-09-2025
vereisten:
  - REQ-005
  - REQ-006
  - REQ-007
Afhankelijkheden: []
toegewezen_aan: development-team
---

# US-221: Verwijder enable_validation Feature Flag

## Gebruikersverhaal

**Als een** ontwikkelaar
**wil ik** dat validatie altijd wordt uitgevoerd zonder feature flag
**zodat** we gegarandeerd kwalitatief goede definities produceren

## Context

De `enable_validation` flag is **KRITIEK** - zonder validatie worden ALLE definities geaccepteerd:
```python
if self.config.enable_validation:
    validation_result = validator.validate(definition)
else:
    validation_result = {"is_acceptable": True}  # ALTIJD GOED!
```

Dit is gevaarlijk en moet direct aangepakt worden.

## Acceptatiecriteria

### Criterion 1: Validatie Altijd Actief
**gegeven** een definitie is gegenereerd
**wanneer** de orchestrator de definitie verwerkt
**dan** wordt validatie ALTIJD uitgevoerd

### Criterion 2: Geen Quality Bypass
**gegeven** validatie is verplicht
**wanneer** een definitie niet voldoet aan kwaliteitseisen
**dan** wordt deze NOOIT automatisch goedgekeurd

### Criterion 3: Configureerbare Strictheid
**gegeven** validatie draait altijd
**wanneer** gebruiker wil configureren
**dan** kan alleen de strictheid/severity aangepast worden, niet aan/uit

## Technische Implementatie

### Te Wijzigen Bestanden

1. **src/services/definition_orchestrator.py**
   - Regel 82: Verwijder `enable_validation: bool = True`
   - Regel 179, 258: Verwijder `if self.config.enable_validation:` checks
   - Validatie wordt ALTIJD uitgevoerd

2. **src/services/orchestrators/definition_orchestrator_v2.py**
   - Regel 240-291: Validatie gebeurt al zonder flag check (GOED!)
   - Geen wijziging nodig hier

3. **Config Files**
   - Verwijder alle `enable_validation` velden
   - Vervang door `validation_strictness: str = "normal"` (low/normal/strict)

### Nieuwe Implementatie

```python
# VOOR (gevaarlijk):
if self.config.enable_validation:
    validation_result = validator.validate(definition)
else:
    validation_result = {"is_acceptable": True}  # BYPASS!

# NA (veilig):
# Validatie gebeurt ALTIJD
validation_result = await self.validation_service.validate_definition(
    definition=definition,
    strictness=self.config.validation_strictness  # Configure HOE, niet OF
)

# Severity levels bepalen wat acceptable is:
# - "low": alleen kritieke fouten blokkeren
# - "normal": standaard kwaliteitseisen
# - "strict": alle warnings zijn blockers
```

## Test Coverage Vereisten

### Critical Tests
- Test dat validatie NOOIT overgeslagen wordt
- Test verschillende strictness levels
- Test dat slechte definities ALTIJD gefaald worden

### Regression Tests
- Zorg dat bestaande tests niet afhankelijk zijn van flag
- Update mocks die `enable_validation=False` gebruiken

## Definitie van Gereed

- [ ] `enable_validation` flag volledig verwijderd
- [ ] Validatie draait ALTIJD in orchestrator
- [ ] Strictness configuratie ge√Ømplementeerd
- [ ] Geen bypass mogelijk voor slechte kwaliteit
- [ ] Tests aangepast en 100% coverage op validatie flow
- [ ] Security review: geen quality bypass mogelijk

## Impact Analyse

### Positief
- **Kwaliteitsgarantie**: Geen slechte definities meer mogelijk
- **Security**: Geen bypass voor validatie
- **Simpliciteit**: Minder conditional logic

### Risico's
- **Breaking Change**: Code die flag op False zette werkt niet meer
- **Performance**: Validatie draait altijd (was al zo in praktijk)

## Dependencies

- Validation service moet stabiel zijn
- ModularValidationService moet correct werken

## Priority Rationale

**HOOG PRIORITEIT** omdat:
1. Security/quality risico bij huidige implementatie
2. Relatief simpele fix
3. Grote impact op output kwaliteit

---

*Deze story is kritiek voor kwaliteitsborging*